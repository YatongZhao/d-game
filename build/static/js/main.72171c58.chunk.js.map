{"version":3,"sources":["core/Point.ts","core/Coordinate.ts","core/tool/index.ts","core/Enemy/Enemy.ts","core/Bullet/Bullet.ts","core/Hero/Hero.ts","core/Hero/GrapeshotHero.ts","core/Bullet/SpecialLightningBullet.ts","core/Hero/LightningHero.ts","core/Bullet/SniperBullet.ts","core/Hero/SniperHero.ts","core/index.ts","App.tsx","reportWebVitals.ts","index.tsx","App.module.css"],"names":["Point","x","y","coordinate","this","origin","p","p1","toNumber","p2","Coordinate","drawRoundRect","w","h","r","ctx","beginPath","moveTo","arcTo","closePath","stroke","drawLightning","color","lightColor","pn1x","pn1y","dx","dy","l","lengthTo","cos","sin","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineWidth","i","o","plus","randomR","Math","random","lineTo","Enemy","value","game","size","point","n","score","removeEnemy","textAlign","fillText","Bullet","DefaultBullet","direction","hero","speed","isEnd","enemys","some","enemy","hited","addKillNumber","removeBullet","height","width","gnt1","createLinearGradient","addColorStop","Hero","level","type","step","killNumber","startSpecialMove","position","fillStyle","fill","_x","_y","GrapeshotHero","specialLength","nullHero","cycle","bullets","push","PI","floor","targetY","SpecialLightningBullet","forEach","_color","_lightColor","LightningHero","targets","length","chain","end","targetMaxLength","enemyLen","randomI","addTarget","next","parent","_chain","SniperBullet","damage","startPoint","targetPoint","len","SniperHero","target","specialTargets","specialDamage","specialDamageMax","maxEnemy","filter","set","Set","add","console","log","renderTarget","radius","arc","isMobile","test","window","navigator","userAgent","Game","offStageHeros","onStageHeros","innerHeight","innerWidth","sizeRate","targetLineLeft","targetLineRight","offStageHeroY","onStageHeroY","heroPosList","setEnd","$","isMouseDown","mouseSelectItem","mouseSelectItemType","mouseSelectItemIndex","mouseSelectItemPosition","mouseSelectItemOffset","go","handleMouseMove","bind","handleTouchMove","ceil","bullet","_bullet","_enemy","addOffStageHero","addEnemy","canvas","getContext","clearRect","strokeRect","pos","render","putImageData","getImageData","rect","font","requestAnimationFrame","undefined","index","addToOffStage","list","_hero","addOnStageHero","e","isFindOffStage","findHero","clientX","clientY","isFindOnStage","addEventListener","stopPropagation","preventDefault","touches","passive","heros","heroIndex","findIndex","isTrue","isPointIn","removeEventListener","handleEventEnd","changedTouches","leftUp","rightDown","targetI","temp","handleMove","grapeshot","name","price","lightning","sniper","createProduct","createProductList","App","canvasRef","useRef","useState","isShopOpen","setIsShopOpen","productList","setProductList","showShopError","setShowShopError","useEffect","current","handler","handleMouseUp","touchEndHandler","handleTouchEnd","ref","className","s","onClick","onTouchStart","handleTouchStart","onMouseDown","handleCanvasMouseDown","info","shopBtn","shopBox","shopList","map","shopItem","buySuccess","buyHero","shopItemPrice","shopError","gameEndBox","join","restart","restartBtn","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.72171c58.chunk.js","sourcesContent":["import { Coordinate } from \"./Coordinate\";\n\nexport class Point {\n    x = 0;\n    y = 0;\n    coordinate: Coordinate;\n\n    constructor(x: number, y: number, coordinate: Coordinate) {\n        this.x = x;\n        this.y = y;\n        this.coordinate = coordinate;\n    }\n\n    toNumber(): [number, number] {\n        return [this.x + this.coordinate.origin[0], this.y + this.coordinate.origin[1]];\n    }\n\n    plus(x: number, y: number) {\n        return new Point(this.x + x, this.y + y, this.coordinate);\n    }\n\n    lengthTo(p: Point): number {\n        let p1 = this.toNumber();\n        let p2 = p.toNumber();\n\n        return ((p1[0] - p2[0])**2 + (p1[1] - p2[1])**2)**0.5;\n    }\n}\n","import { Point } from \"./Point\";\n\nexport class Coordinate {\n    origin: [number, number] = [0, 0];\n\n    constructor(x: number, y: number) {\n        this.origin = [x, y];\n    }\n\n    resetOrigin(origin: Point) {\n        this.origin = origin.toNumber();\n    }\n\n    point(x: number, y: number): Point {\n        return new Point(x, y, this);\n    }\n\n    toPoint(x: number, y: number): Point {\n        return new Point(x - this.origin[0], y - this.origin[1], this);\n    }\n}","import { Point } from \"../Point\";\n\nexport const drawRoundRect = (x: number, y: number, w: number, h: number, r: number, ctx: CanvasRenderingContext2D): void => {\n    if (w < 2 * r) r = w / 2;\n    if (h < 2 * r) r = h / 2;\n    ctx.beginPath();\n    ctx.moveTo(x+r, y);\n    ctx.arcTo(x+w, y, x+w, y+h, r);\n    ctx.arcTo(x+w, y+h, x, y+h, r);\n    ctx.arcTo(x, y+h, x, y, r);\n    ctx.arcTo(x, y, x+w, y, r);\n    ctx.closePath();\n    ctx.stroke();\n}\n\nexport const drawLightning = (p1: Point, p2: Point, ctx: CanvasRenderingContext2D, color?: string, lightColor?: string) => {\n    const [pn1x, pn1y] = p1.toNumber();\n    const [pn2x, pn2y] = p2.toNumber();\n\n    const dx = pn2x - pn1x;\n    const dy = pn2y - pn1y;\n    const l = p1.lengthTo(p2);\n\n    const cos = dx / l;\n    const sin = dy / l;\n\n    ctx.strokeStyle = color || \"white\";\n\n    ctx.shadowColor = lightColor || 'blue';\n    ctx.shadowBlur = 14;\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n\n\n    ctx.beginPath();\n    ctx.lineWidth = 1;\n    ctx.moveTo(...p1.toNumber());\n    for (let i = 1; i < 5; i++) {\n        let o = p1.plus(dx / 5 * i, dy / 5 * i);\n\n        let randomR = (Math.random() - 0.5) * 60;\n        o = o.plus(randomR * sin, randomR * cos);\n\n        ctx.lineTo(...o.toNumber());\n    }\n    ctx.lineTo(...p2.toNumber());\n    ctx.stroke();\n    ctx.closePath();\n\n    ctx.beginPath();\n    ctx.lineWidth = 2;\n    ctx.moveTo(...p1.toNumber());\n    for (let i = 1; i < 5; i++) {\n        let o = p1.plus(dx / 5 * i, dy / 5 * i);\n\n        let randomR = (Math.random() - 0.5) * 60;\n        o = o.plus(randomR * sin, randomR * cos);\n\n        ctx.lineTo(...o.toNumber());\n    }\n    ctx.lineTo(...p2.toNumber());\n    ctx.stroke();\n    ctx.closePath();\n\n    ctx.shadowBlur = 0;\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = \"black\";\n}","import { Game } from \"..\";\nimport { Point } from \"../Point\";\nimport { drawRoundRect } from \"../tool\";\n\nexport class Enemy {\n    value = 0;\n    size = 20;\n    point: Point;\n    game: Game;\n\n    constructor(value: number, x: number, game: Game) {\n        this.value = value;\n        this.game = game;\n        this.point = new Point(x, -this.size, game.coordinate);\n    }\n\n    go() {\n        this.point.y += 0.5;\n    }\n\n    hited(n?: number): boolean {\n        if (n) {\n            this.game.score += this.value < n ? this.value : n;\n            this.value -= n;\n        } else {\n            this.value--;\n            this.game.score++;\n        }\n\n        if (this.value <= 0) {\n            this.game.removeEnemy(this);\n            return true;\n        }\n        return false;\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        let [x, y] = this.point.toNumber();\n        drawRoundRect(x, y, this.size, this.size, 5, ctx);\n        ctx.textAlign = 'center';\n        ctx.fillText(`${this.value}`, x + this.size / 2, y + 13);\n    }\n}\n","import { Game } from \"..\";\nimport { Hero } from \"../Hero/Hero\";\nimport { Point } from \"../Point\";\n\nexport class Bullet {\n    go() {\n\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n\n    }\n}\n\nexport class DefaultBullet extends Bullet {\n    point: Point;\n    game: Game;\n    size = 2;\n    direction = 0;\n    speed = 30;\n    color = 'black';\n\n    isEnd = false;\n\n    hero: Hero;\n\n    constructor(point: Point, direction: number, game: Game, hero: Hero, {\n        speed, color\n    }: {\n        speed?: number;\n        color?: string;\n    }) {\n        super();\n        this.point = point;\n        this.direction = direction;\n        this.game = game;\n        this.hero = hero;\n        speed && (this.speed = speed);\n        color && (this.color = color);\n    }\n\n    go() {\n        for (let i = 0; i < this.speed * 5; i++) {\n            this.point.y -= Math.cos(this.direction);\n            this.point.x += Math.sin(this.direction);\n\n            let isTrue = this.game.enemys.some(enemy => {\n                if (this.point.x >= enemy.point.x - 2\n                    && this.point.y >= enemy.point.y - 2\n                    && this.point.x <= enemy.point.x + enemy.size + 2\n                    && this.point.y <= enemy.point.y + enemy.size + 2) {\n                        let isKilled = enemy.hited();\n                        if (isKilled) {\n                            this.hero.addKillNumber();\n                        }\n                        this.game.removeBullet(this);\n                        this.isEnd = true;\n                        return true;\n                }\n                return false;\n            });\n\n            if (isTrue) {\n                return;\n            }\n        }\n        if (this.point.y < 0\n            || this.point.y > this.game.height\n            || this.point.x < 0\n            || this.point.x > this.game.width) {\n            this.game.removeBullet(this);\n        }\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        let [x, y] = this.point.toNumber();\n\n        // if (this.isEnd) {\n        //     this.game.removeBullet(this);\n        //     let direction = this.direction + ((Math.random() - 0.5) * 0.4 + 1) * Math.PI;\n        //     ctx.beginPath();\n        //     for (let i = 0; i < 4; i++) {\n        //         let random1 = Math.random();\n        //         let random2 = Math.random();\n        //         direction = this.direction + ((Math.random() - 0.5) * 0.4 + 1) * Math.PI;\n        //         ctx.moveTo(x + Math.sin(direction) * this.speed * random1, y - Math.cos(direction) * this.speed * random1);\n        //         ctx.lineTo(x + Math.sin(direction) * this.speed * random2, y - Math.cos(direction) * this.speed * random2);\n        //         let gnt1 = ctx.createLinearGradient(x, y, x + Math.sin(direction) * this.speed, y - Math.cos(direction) * this.speed);\n        //         gnt1.addColorStop(0,this.color);\n        //         gnt1.addColorStop(1,'white');\n        //         ctx.strokeStyle = gnt1;\n        //     }\n        //     ctx.stroke();\n        //     ctx.closePath();\n        //     return;\n        // }\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(x - Math.sin(this.direction) * this.speed, y + Math.cos(this.direction) * this.speed);\n        let gnt1 = ctx.createLinearGradient(x, y, x - Math.sin(this.direction) * this.speed, y + Math.cos(this.direction) * this.speed);\n        gnt1.addColorStop(0,this.color);\n        gnt1.addColorStop(1,'white');\n        ctx.strokeStyle = gnt1;\n        ctx.stroke();\n        ctx.closePath();\n        ctx.strokeStyle = 'black';\n    }\n}\n","import { Game } from \"..\";\nimport { Point } from \"../Point\";\nimport { drawRoundRect } from \"../tool\";\n\nexport class Hero {\n    point: Point;\n    level: 1|2|3 = 1;\n    get size() {\n        switch (this.level) {\n            case 1:\n                return 30;\n            case 2:\n                return 30;\n            default:\n            case 3:\n                return 30;\n        }\n    }\n    color = 'blue';\n    type = 'hero';\n\n    step = 0;\n\n    killNumber = 0;\n\n    game: Game;\n\n    constructor(game: Game) {\n        this.game = game;\n        this.point = new Point(0, 0, game.coordinate);\n    }\n\n    addKillNumber() {\n        this.killNumber++;\n        if (this.killNumber >= 100) {\n            this.killNumber = 0;\n            this.startSpecialMove();\n        }\n    }\n\n    startSpecialMove() {\n\n    }\n\n    go() {\n        this.step++;\n    }\n\n    render(ctx: CanvasRenderingContext2D, position?: [number, number]) {\n        let [x, y] = position || this.point.toNumber();\n        ctx.strokeStyle = this.color;\n        drawRoundRect(x, y, this.size, this.size, 5, ctx);\n        ctx.strokeStyle = 'black';\n        ctx.fillStyle = 'white';\n        ctx.fill();\n        ctx.fillStyle = this.color;\n        ctx.textAlign = 'center';\n        ctx.fillText(`${this.level}`, x + this.size / 2, y + 18);\n        ctx.fillStyle = 'green';\n        ctx.strokeStyle = 'green';\n        drawRoundRect(x + 1, y + this.size + 3, this.killNumber / 100 * (this.size - 2), 2, 1, ctx);\n        ctx.fill();\n        ctx.strokeStyle = 'black';\n        ctx.fillStyle = 'white';\n        ctx.fillStyle = 'black';\n    }\n\n    isPointIn(x: number, y: number) {\n        let [_x, _y] = this.point.toNumber();\n        return x >= _x - 10 && x <= _x + this.size + 10\n            && y >= _y - 10 && y <= _y + this.size + 10;\n    }\n\n    addToOffStage(position: 0|1|2|3|4|5|6|7|8) {\n    }\n}","import { DefaultBullet } from \"../Bullet/Bullet\";\nimport { Point } from \"../Point\";\nimport { Hero } from \"./Hero\";\n\nexport class GrapeshotHero extends Hero {\n    type = 'grapeshot-hero';\n    get cycle() {\n        switch (this.level) {\n            case 1:\n                return 5;\n            case 2:\n                return 3;\n            default:\n            case 3:\n                return 1;\n        }\n    }\n    color = 'black';\n    specialLength = 0;\n\n    nullHero = new Hero(this.game);\n\n    go() {\n        if (this.step % this.cycle === 0) {\n            for (let i = 0; i < 5; i++) {\n                this.game.bullets.push(\n                    new DefaultBullet(\n                        this.point.plus(this.size/2, 0),\n                        Math.PI*0.4*(Math.random() - 0.5),\n                        this.game,\n                        this,\n                        {\n                            speed: 30 + Math.floor(Math.random() * 30),\n                        }\n                    )\n                );\n            }\n        }\n        if (this.specialLength !== 0) {\n            if (this.specialLength % 3 === 0) {\n                for (let i = 0; i < 15; i++) {\n                    this.game.bullets.push(\n                        new DefaultBullet(\n                            new Point(30 * i + 10, this.game.targetY, this.game.coordinate),\n                            0,\n                            this.game,\n                            this.nullHero,\n                            {\n                                speed: 30 + Math.floor(Math.random() * 30),\n                                color: 'red',\n                            }\n                        )\n                    );\n                }\n            }\n            this.specialLength--;\n        }\n        this.step++;\n    }\n\n    startSpecialMove() {\n        this.specialLength = 200;\n    }\n}\n\n","import { Game } from \"..\";\nimport { LightningHero } from \"../Hero/LightningHero\";\nimport { Point } from \"../Point\";\nimport { drawLightning } from \"../tool\";\nimport { Bullet } from \"./Bullet\";\n\nexport class SpecialLightningBullet extends Bullet {\n    game: Game;\n    hero: LightningHero;\n    y = 0;\n    get speed() {\n        switch (this.hero.level) {\n            case 1:\n                return 5;\n            case 2:\n                return 3;\n            case 3:\n            default:\n                return 1;\n        }\n    }\n\n    constructor(game: Game, hero: LightningHero) {\n        super();\n        this.game = game;\n        this.hero = hero;\n        this.y = this.game.targetY;\n    }\n    go() {\n        this.y -= this.speed;\n        this.game.enemys.forEach(enemy => {\n            if (enemy.point.y <= this.y && enemy.point.y + enemy.size >= this.y) {\n                enemy.hited();\n            }\n        });\n\n        if (this.y <= 0) {\n            this.game.removeBullet(this);\n        }\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        drawLightning(\n            new Point(0, this.y, this.game.coordinate),\n            new Point(this.game.width, this.y, this.game.coordinate),\n            ctx,\n            this.hero._color,\n            this.hero._lightColor);\n    }\n}","import { SpecialLightningBullet } from '../Bullet/SpecialLightningBullet';\nimport { Enemy } from '../Enemy/Enemy';\nimport { drawLightning } from '../tool';\nimport { Hero } from './Hero';\n\ninterface Chain<T> {\n    value: T;\n    next: Chain<T> | null;\n}\n\nexport class LightningHero extends Hero {\n    type = 'lightning-hero';\n\n    targets: {\n        length: number;\n        chain: Chain<Enemy> | null;\n        end: Chain<Enemy> | null;\n    } = {\n        length: 0,\n        chain: null,\n        end: null\n    };\n    get cycle() {\n        switch (this.level) {\n            case 1:\n                return 3;\n            case 2:\n                return 2;\n            default:\n            case 3:\n                return 1;\n        }\n    }\n    get _color() {\n        switch (this.level) {\n            case 1:\n                return 'white';\n            case 2:\n                return 'white';\n            default:\n            case 3:\n                return 'black';\n        }\n    }\n    get _lightColor() {\n        switch (this.level) {\n            case 1:\n                return 'blue';\n            case 2:\n                return 'red';\n            default:\n            case 3:\n                return 'red';\n        }\n    }\n    get targetMaxLength() {\n        switch (this.level) {\n            case 1:\n                return 2;\n            case 2:\n                return 3;\n            default:\n            case 3:\n                return 5;\n        }\n    }\n\n    go() {\n        if (this.targets.length < this.targetMaxLength && this.game.enemys.length >= this.targetMaxLength) {\n            let i = this.targetMaxLength - this.targets.length;\n            while (i !== 0) {\n                let enemyLen = this.game.enemys.length;\n                let randomI = Math.floor(enemyLen*Math.random());\n\n                let chain = this.targets.chain;\n\n                if (!chain) {\n                    this.addTarget({\n                        value: this.game.enemys[randomI],\n                        next: null\n                    });\n                    i--;\n                    continue;\n                }\n\n                const isTrue = this.addTarget({\n                    value: this.game.enemys[randomI],\n                    next: null\n                });\n                if (isTrue) {\n                    i--;\n                }\n            }\n            this.targets.length = this.targetMaxLength;\n        }\n\n        if (this.step % this.cycle === 0) {\n            let chain = this.targets.chain;\n            while (chain) {\n                let isKilled = chain.value.hited();\n                if (isKilled) {\n                    this.addKillNumber();\n                }\n                chain = chain.next;\n            }\n            chain = this.targets.chain;\n            if (!chain) return;\n            if (chain.value.value <= 0) {\n                this.targets.length = 0;\n                this.targets.chain = null;\n                this.targets.end = null;\n            } else {\n                let parent = chain;\n                chain = chain.next;\n                let length = 1;\n\n                while (chain) {\n                    if (chain.value.value <= 0) {\n                        parent.next = null;\n                        this.targets.length = length;\n                        this.targets.end = parent;\n                        break;\n                    } else {\n                        parent = chain;\n                        chain = chain.next;\n                        length++;\n                    }\n                }\n            }\n        }\n\n        this.step++;\n    }\n\n    render(ctx: CanvasRenderingContext2D, position?: [number, number]) {\n        super.render(ctx, position);\n\n        if (!this.targets.chain) return;\n        let chain: Chain<Enemy> | null = this.targets.chain;\n        let p1 = this.point.plus(this.size / 2, 0);\n\n        while (chain) {\n            let p2 = chain.value.point.plus(chain.value.size / 2, chain.value.size / 2);\n            drawLightning(p1, p2, ctx, this._color, this._lightColor);\n\n            p1 = chain.value.point.plus(chain.value.size / 2, chain.value.size / 2);\n            chain = chain.next;\n        }\n    }\n\n    startSpecialMove() {\n        this.game.bullets.push(new SpecialLightningBullet(this.game, this));\n    }\n\n    addTarget(chain: Chain<Enemy>): boolean {\n        if (this.targets.end === null) {\n            this.targets.chain = chain;\n            this.targets.end = chain;\n            this.targets.length++;\n        } else {\n            let _chain = this.targets.chain;\n\n            while (_chain) {\n\n                if (chain === _chain) {\n                    return false;\n                }\n                _chain = _chain.next;\n            }\n            this.targets.end.next = chain;\n            this.targets.end = this.targets.end.next;\n            this.targets.length++;\n        }\n\n        return true;\n    }\n\n    addToOffStage(position: 0|1|2|3|4|5|6|7|8) {\n        super.addToOffStage(position);\n        this.targets = {\n            length: 0,\n            chain: null,\n            end: null\n        }\n    }\n}","import { Game } from \"..\";\nimport { Hero } from \"../Hero/Hero\";\nimport { Point } from \"../Point\";\nimport { Bullet } from \"./Bullet\";\n\nexport class SniperBullet extends Bullet {\n    point: Point;\n    startPoint: Point;\n    targetPoint: Point;\n    game: Game;\n    hero: Hero;\n    damage = 0;\n\n    sin = 0;\n    cos = 0;\n\n    speed = 30;\n    color = 'black';\n\n    constructor(game: Game, hero: Hero, p1: Point, p2: Point, {\n        speed, color, damage\n    }: {\n        speed?: number;\n        color?: string;\n        damage: number;\n    }) {\n        super();\n\n        this.game = game;\n        this.hero = hero;\n        this.startPoint = p1;\n        this.point = p1.plus(0, 0);\n        this.targetPoint = p2;\n        speed && (this.speed = speed);\n        color && (this.color = color);\n        this.damage = damage;\n        let dy = this.targetPoint.y - this.startPoint.y;\n        let dx = this.targetPoint.x - this.startPoint.x;\n        let len = (dy**2 + dx**2)**0.5;\n        this.sin = dx / len;\n        this.cos = -dy / len;\n    }\n\n    go() {\n        for (let i = 0; i < this.speed * 5; i++) {\n            this.point.y += -this.cos;\n            this.point.x += this.sin;\n\n            this.game.enemys.forEach(enemy => {\n                if (this.point.x >= enemy.point.x - 2\n                    && this.point.y >= enemy.point.y - 2\n                    && this.point.x <= enemy.point.x + enemy.size + 2\n                    && this.point.y <= enemy.point.y + enemy.size + 2) {\n                        let isKilled = enemy.hited(this.damage);\n                        if (isKilled) {\n                            this.hero.addKillNumber();\n                        }\n                        return true;\n                }\n                return false;\n            });\n        }\n        if (this.point.y < 0\n            || this.point.y > this.game.height\n            || this.point.x < 0\n            || this.point.x > this.game.width) {\n            this.game.removeBullet(this);\n        }\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        let [x, y] = this.point.toNumber();\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(x - this.sin * 150, y + this.cos * 150);\n        let gnt1 = ctx.createLinearGradient(x, y, x - this.sin * 150, y + this.cos * 150);\n        gnt1.addColorStop(0,this.color);\n        gnt1.addColorStop(1,'white');\n        ctx.strokeStyle = gnt1;\n        ctx.lineWidth = 2;\n        ctx.stroke();\n        ctx.closePath();\n        ctx.strokeStyle = 'black';\n        ctx.lineWidth = 1;\n    }\n}","import { SniperBullet } from \"../Bullet/SniperBullet\";\nimport { Enemy } from \"../Enemy/Enemy\";\nimport { Hero } from \"./Hero\";\n\nexport class SniperHero extends Hero {\n    type = 'sniper-hero';\n    target: Enemy|null = null;\n    damage = 0;\n    color = 'green';\n    nullHero = new Hero(this.game);\n\n    specialTargets: Enemy[] = [];\n    specialDamage = -1;\n    specialDamageMax = 30;\n\n    get cycle() {\n        switch (this.level) {\n            case 1:\n                return 5;\n            case 2:\n                return 3;\n            default:\n            case 3:\n                return 2;\n        }\n    }\n\n    go() {\n        if (!this.target) {\n            let maxEnemy: Enemy = this.game.enemys[0];\n            this.game.enemys.forEach(enemy => {\n                if (enemy.value > maxEnemy.value) {\n                    maxEnemy = enemy;\n                }\n            });\n\n            this.target = maxEnemy;\n        }\n        if (this.step % this.cycle !== 0) return super.go();\n\n        if (this.damage < this.target.value) {\n            this.damage += 1;\n        } else {\n            this.game.bullets.push(new SniperBullet(\n                this.game,\n                this,\n                this.point.plus(this.size / 2, 0),\n                this.target.point.plus(this.target.size / 2, this.target.size / 2),\n                {\n                    damage: this.damage,\n                }\n            ));\n            this.damage = 0;\n            this.target = null;\n        }\n\n        if (this.specialDamage > 0) {\n            this.specialDamage++;\n            this.specialTargets = this.specialTargets.filter(target => {\n                return target.value > 0;\n            });\n\n            if (this.specialDamage >= this.specialDamageMax) {\n                this.specialTargets.forEach(target => {\n                    this.game.bullets.push(new SniperBullet(\n                        this.game,\n                        this.nullHero,\n                        this.point.plus(this.size / 2, 0),\n                        target.point.plus(target.size / 2, target.size / 2),\n                        {\n                            damage: this.specialDamage,\n                        }\n                    ));\n                });\n                this.specialDamage = -1;\n                this.specialTargets = [];\n            }\n        }\n\n        super.go();\n    }\n\n    startSpecialMove() {\n        let set = new Set();\n        while (set.size < 12) {\n            set.add(Math.floor(Math.random() * this.game.enemys.length));\n        }\n\n        set.forEach(i => {\n            this.specialTargets.push(this.game.enemys[i as 0]);\n        });\n\n        console.log('special', this.specialTargets);\n        this.specialDamage = 1;\n    }\n\n    render(ctx: CanvasRenderingContext2D, position?: [number, number]) {\n        super.render(ctx, position);\n        if (this.target) {\n            this.renderTarget(ctx, this.target, 5 + (this.target.value - this.damage > 0 ? this.target.value - this.damage : 0));\n        }\n        this.specialTargets.forEach(target => {\n            this.renderTarget(ctx, target, 5 + this.specialDamageMax - this.specialDamage);\n        });\n    }\n\n    renderTarget(ctx: CanvasRenderingContext2D, target: Enemy, radius: number) {\n        ctx.strokeStyle = 'red';\n        ctx.lineWidth = 3;\n        ctx.beginPath();\n        ctx.arc(\n            ...target.point.plus(target.size / 2, target.size / 2).toNumber(),\n            radius, 0, 2*Math.PI);\n        ctx.moveTo(...target.point.plus(target.size / 2, target.size / 2 + radius + 5).toNumber());\n        ctx.lineTo(...target.point.plus(target.size / 2, target.size / 2 + radius - 5).toNumber());\n        ctx.moveTo(...target.point.plus(target.size / 2, target.size / 2 - radius + 5).toNumber());\n        ctx.lineTo(...target.point.plus(target.size / 2, target.size / 2 - radius - 5).toNumber());\n        ctx.moveTo(...target.point.plus(target.size / 2 + radius + 5, target.size / 2).toNumber());\n        ctx.lineTo(...target.point.plus(target.size / 2 + radius - 5, target.size / 2).toNumber());\n        ctx.moveTo(...target.point.plus(target.size / 2 - radius + 5, target.size / 2).toNumber());\n        ctx.lineTo(...target.point.plus(target.size / 2 - radius - 5, target.size / 2).toNumber());\n        ctx.stroke();\n        ctx.closePath();\n        ctx.strokeStyle = 'black';\n        ctx.lineWidth = 1;\n    }\n}","import { Bullet } from \"./Bullet/Bullet\";\nimport { Coordinate } from \"./Coordinate\";\nimport { Enemy } from \"./Enemy/Enemy\";\nimport { GrapeshotHero } from \"./Hero/GrapeshotHero\";\nimport { Hero } from \"./Hero/Hero\";\nimport { LightningHero } from \"./Hero/LightningHero\";\nimport { SniperHero } from \"./Hero/SniperHero\";\nimport { Point } from \"./Point\";\nimport { drawRoundRect } from \"./tool\";\n\nconst isMobile = /Android|webOS|iPhone|iPod|BlackBerry/i.test(window.navigator.userAgent);\n\nexport class Game {\n    coordinate = new Coordinate(0, 0);\n\n    enemys: Enemy[] = [];\n\n    offStageHeros: [\n        Hero|null, Hero|null, Hero|null,\n        Hero|null, Hero|null, Hero|null,\n        Hero|null, Hero|null, Hero|null\n    ] = [null, null, null, null, null, null, null, null, null];\n    onStageHeros: [\n        Hero|null, Hero|null, Hero|null,\n        Hero|null, Hero|null, Hero|null,\n        Hero|null, Hero|null, Hero|null\n    ] = [null, null, null, null, null, null, null, null, null];\n\n    bullets: Bullet[] = [];\n\n    width = 460;\n    height = window.innerHeight * 460 / window.innerWidth;\n    sizeRate = 460 / window.innerWidth;\n\n    targetY = this.height - 150;\n    targetLineLeft = this.coordinate.point(0, this.targetY);\n    targetLineRight = this.coordinate.point(this.width, this.targetY);\n\n    offStageHeroY = this.height - 70;\n    onStageHeroY = this.height - 120;\n    // 数组顺序不要动\n    heroPosList = [\n        new Point(55, this.offStageHeroY, this.coordinate),\n        new Point(95, this.offStageHeroY, this.coordinate),\n        new Point(135, this.offStageHeroY, this.coordinate),\n        new Point(175, this.offStageHeroY, this.coordinate),\n        new Point(215, this.offStageHeroY, this.coordinate),\n        new Point(255, this.offStageHeroY, this.coordinate),\n        new Point(295, this.offStageHeroY, this.coordinate),\n        new Point(335, this.offStageHeroY, this.coordinate),\n        new Point(375, this.offStageHeroY, this.coordinate),\n\n        new Point(55, this.onStageHeroY, this.coordinate),\n        new Point(95, this.onStageHeroY, this.coordinate),\n        new Point(135, this.onStageHeroY, this.coordinate),\n        new Point(175, this.onStageHeroY, this.coordinate),\n        new Point(215, this.onStageHeroY, this.coordinate),\n        new Point(255, this.onStageHeroY, this.coordinate),\n        new Point(295, this.onStageHeroY, this.coordinate),\n        new Point(335, this.onStageHeroY, this.coordinate),\n        new Point(375, this.onStageHeroY, this.coordinate)\n    ];\n\n    cycle = 60;\n    step = 0;\n    setEnd: React.Dispatch<React.SetStateAction<boolean>> | null = null;\n\n    $ = 300;\n    score = 0;\n\n\n    isMouseDown = false;\n    mouseSelectItem: Hero | null = null;\n    mouseSelectItemType: 'off' | 'on' = 'off';\n    mouseSelectItemIndex: 0|1|2|3|4|5|6|7|8 = 0;\n    mouseSelectItemPosition: [number, number] = [0, 0];\n    mouseSelectItemOffset: [number, number] = [0, 0];\n\n    constructor() {\n        this.go();\n\n        this.handleMouseMove = this.handleMouseMove.bind(this);\n        this.handleTouchMove = this.handleTouchMove.bind(this);\n    }\n\n    restart() {\n        this.enemys = [];\n        this.offStageHeros = [null, null, null, null, null, null, null, null, null];\n        this.onStageHeros = [null, null, null, null, null, null, null, null, null];\n        this.bullets = [];\n        this.step = 0;\n        this.$ = 300;\n        this.score = 0;\n        this.go();\n    }\n\n    addEnemy() {\n        for (let i = 0; i < 15; i++) {\n            this.enemys.push(new Enemy(Math.ceil(this.step/150*Math.random() + 1), 30 * i + 10, this));\n        }\n    }\n\n    removeBullet(bullet: Bullet) {\n        this.bullets = this.bullets.filter(_bullet => {\n            return _bullet !== bullet;\n        });\n    }\n\n    removeEnemy(enemy: Enemy) {\n        this.enemys = this.enemys.filter(_enemy => {\n            return _enemy !== enemy;\n        });\n        this.$++;\n    }\n\n    buyHero(type: 'lightning' | 'grapeshot' | 'sniper'): boolean {\n        switch (type) {\n            case 'lightning':\n                if (this.$ < 300) return false;\n                this.$ -= 300;\n                this.addOffStageHero(new LightningHero(this));\n                break;\n            case 'sniper':\n                if (this.$ < 500) return false;\n                this.$ -= 500;\n                this.addOffStageHero(new SniperHero(this));\n                break;\n            case 'grapeshot':\n            default:\n                if (this.$ < 300) return false;\n                this.$ -= 300;\n                this.addOffStageHero(new GrapeshotHero(this));\n                break;\n        }\n        return true;\n    }\n\n    go() {\n        if (this.step % this.cycle === 0) {\n            this.addEnemy();\n        }\n\n        this.enemys.forEach(enemy => {\n            enemy.go();\n        });\n\n        // console.log('game go', this.onStageHeros);\n        this.onStageHeros.forEach(hero => {\n            hero?.go();\n        });\n\n        // this.offStageHeros.forEach(hero => {\n        //     hero?.go();\n        // });\n\n        this.bullets.forEach(bullet => {\n            bullet.go();\n        });\n\n        this.step++;\n    }\n\n    render(canvas: HTMLCanvasElement | null) {\n        if (!canvas) return;\n        const ctx = canvas.getContext('2d');\n\n        if (!ctx) return;\n        this.go();\n\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.strokeRect(...this.coordinate.origin, this.width, this.height);\n\n        ctx.beginPath();\n        ctx.strokeStyle = 'grey';\n        this.heroPosList.forEach(pos => {\n            drawRoundRect(...pos.plus(8, 8).toNumber(), 14, 14, 5, ctx);\n        });\n        ctx.strokeStyle = 'black';\n        ctx.closePath();\n\n        ctx.beginPath();\n        this.offStageHeros.forEach(hero => {\n            hero?.render(ctx);\n        });\n\n        this.onStageHeros.forEach(hero => {\n            hero?.render(ctx);\n        });\n        ctx.closePath();\n\n        let isEnd = false;\n        this.enemys.forEach(enemy => {\n            enemy.render(ctx);\n            if (enemy.point.y >= this.targetY - enemy.size) {\n                isEnd = true;\n            }\n        });\n\n        ctx.beginPath();\n        ctx.moveTo(...this.targetLineLeft.toNumber());\n        ctx.lineTo(...this.targetLineRight.toNumber());\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        this.bullets.forEach(bullet => {\n            bullet.render(ctx);\n        });\n        ctx.closePath();\n\n        if (this.mouseSelectItem) {\n            this.mouseSelectItem.render(ctx, [\n                this.mouseSelectItemPosition[0] + this.mouseSelectItemOffset[0],\n                this.mouseSelectItemPosition[1] + this.mouseSelectItemOffset[1],\n            ]);\n            if (isMobile) {\n                ctx.putImageData(ctx.getImageData(\n                    0, this.targetY, this.width, 150\n                ), 0, this.targetY - 150);\n\n                ctx.rect(0, this.targetY - 150, this.width, 150);\n                ctx.stroke();\n            }\n        }\n\n        ctx.beginPath();\n        ctx.font = 'bold 24px Arial';\n        ctx.fillStyle = 'red';\n        ctx.textAlign = 'right';\n        ctx.fillText(`$:${this.$}`, 440, 30);\n        ctx.font = '12px Arial';\n        ctx.fillStyle = 'black';\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.font = 'bold 24px Arial';\n        ctx.fillStyle = 'red';\n        ctx.textAlign = 'left';\n        ctx.fillText(`score:${this.score}`, 20, 30);\n        ctx.font = '12px Arial';\n        ctx.fillStyle = 'black';\n        ctx.closePath();\n\n        if (isEnd) {\n            this.setEnd && this.setEnd(true);\n            return;\n        }\n\n        requestAnimationFrame(() => {\n            this.render(canvas);\n        });\n    }\n\n    addOffStageHero(hero: Hero | null, position?: 0|1|2|3|4|5|6|7|8) {\n        if (position === undefined) {\n            this.offStageHeros.some((hero, index) => {\n                if (hero === null) {\n                    position = index as 0|1|2|3|4|5|6|7|8;\n                    return true;\n                }\n                return false;\n            });\n        }\n        if (position === undefined) return;\n        this.offStageHeros[position] = hero;\n        if (hero) {\n            hero.point.y = this.offStageHeroY;\n            hero.point.x = 55 + position * 40;\n            hero.addToOffStage(position);\n\n            if (hero.level >= 3) return;\n\n            let list: (0|1|2|3|4|5|6|7|8)[] = [];\n            this.offStageHeros.forEach((_hero, i) => {\n                if (_hero?.type === hero.type && hero.level === _hero.level) {\n                    list.push(i as 0);\n                }\n            });\n\n            if (list.length >= 3) {\n                this.addOffStageHero(null, list[0]);\n                this.addOffStageHero(null, list[1]);\n                (this.offStageHeros[list[2]] as Hero).level += 1;\n                this.addOffStageHero(this.offStageHeros[list[2]], list[2]);\n            }\n        }\n    }\n\n    addOnStageHero(hero: Hero | null, position?: 0|1|2|3|4|5|6|7|8) {\n        if (position === undefined) {\n            this.onStageHeros.some((hero, index) => {\n                if (hero === null) {\n                    position = index as 0|1|2|3|4|5|6|7|8;\n                    return true;\n                }\n                return false;\n            });\n        }\n        if (position === undefined) return;\n        this.onStageHeros[position] = hero;\n        if (hero) {\n            hero.point.y = this.onStageHeroY;\n            hero.point.x = 55 + position * 40;\n\n            if (hero.level >= 3) return;\n\n            let list: (0|1|2|3|4|5|6|7|8)[] = [];\n            this.onStageHeros.forEach((_hero, i) => {\n                if (_hero?.type === hero.type && hero.level === _hero.level) {\n                    list.push(i as 0);\n                }\n            });\n\n            if (list.length >= 3) {\n                this.addOnStageHero(null, list[0]);\n                this.addOnStageHero(null, list[1]);\n                (this.onStageHeros[list[2]] as Hero).level += 1;\n                this.addOnStageHero(this.onStageHeros[list[2]], list[2]);\n            }\n        }\n    }\n\n    handleCanvasMouseDown(e: React.MouseEvent<HTMLCanvasElement>) {\n        this.isMouseDown = true;\n\n        let isFindOffStage = this.findHero(this.offStageHeros, e.clientX, e.clientY, 'off');\n        let isFindOnStage = this.findHero(this.onStageHeros, e.clientX, e.clientY, 'on');\n\n        if (isFindOffStage || isFindOnStage) {\n            window.addEventListener('mousemove', this.handleMouseMove);\n        };\n    }\n\n    handleTouchStart(e: React.TouchEvent<HTMLCanvasElement>) {\n        e.stopPropagation();\n        e.preventDefault();\n        this.isMouseDown = true;\n\n        let isFindOffStage = this.findHero(this.offStageHeros, e.touches[0].clientX, e.touches[0].clientY, 'off');\n        if (isFindOffStage) {\n            window.addEventListener('touchmove', this.handleTouchMove, { passive: false });\n            return;\n        }\n        let isFindOnStage = this.findHero(this.onStageHeros, e.touches[0].clientX, e.touches[0].clientY, 'on');\n        if (isFindOnStage) {\n            window.addEventListener('touchmove', this.handleTouchMove, { passive: false });\n            return;\n        }\n    }\n\n    findHero(heros: (Hero|null)[], clientX: number, clientY: number, type: 'off'|'on'): boolean {\n        let heroIndex = heros.findIndex(hero => {\n            if (!hero) return false;\n\n            let isTrue = hero.isPointIn(clientX * this.sizeRate, clientY * this.sizeRate);\n            if (isTrue) {\n                let o = hero.point.toNumber();\n                this.mouseSelectItemOffset = [\n                    o[0] - clientX * this.sizeRate,\n                    o[1] - clientY * this.sizeRate\n                ];\n            }\n            return isTrue;\n        });\n\n        if (heroIndex !== -1) {\n            this.mouseSelectItem = heros[heroIndex];\n            this.mouseSelectItemType = type;\n            this.mouseSelectItemIndex = heroIndex as 0;\n            this.mouseSelectItemPosition = [clientX * this.sizeRate, clientY * this.sizeRate];\n            return true;\n        }\n        return false;\n    }\n\n    handleMouseUp(e: MouseEvent) {\n        window.removeEventListener('mousemove', this.handleMouseMove);\n        this.handleEventEnd(e.clientX, e.clientY);\n    }\n\n    handleTouchEnd(e: TouchEvent) {\n        window.removeEventListener('touchmove', this.handleTouchMove);\n        this.handleEventEnd(e.changedTouches[0].clientX, e.changedTouches[0].clientY);\n    }\n\n    handleEventEnd(clientX: number, clientY: number) {\n        let leftUp = [clientX * this.sizeRate + this.mouseSelectItemOffset[0], clientY * this.sizeRate + this.mouseSelectItemOffset[1]];\n        let rightDown = [leftUp[0] + 30, leftUp[1] + 30];\n\n        let pos = this.heroPosList.findIndex(pos => {\n            let p = pos.toNumber();\n\n            return leftUp[0] > p[0] - 18 && leftUp[1] > p[1] - 18\n                && rightDown[0] < p[0] + 48 && rightDown[1] < p[1] + 48;\n        });\n\n        if (pos !== -1 && this.mouseSelectItem) {\n            if (Math.floor(pos / 9) === 0) { // offStage\n                let targetI = pos % 9;\n                let temp = this.offStageHeros[targetI];\n                this.offStageHeros[targetI] = null;\n                if (this.mouseSelectItemType === 'on') {\n                    this.onStageHeros[this.mouseSelectItemIndex] = null;\n                } else {\n                    this.offStageHeros[this.mouseSelectItemIndex] = null;\n                }\n                this.addOffStageHero(this.mouseSelectItem, targetI as 0);\n                if (this.mouseSelectItemType === 'on') {\n                    this.addOnStageHero(temp, this.mouseSelectItemIndex);\n                } else {\n                    this.addOffStageHero(temp, this.mouseSelectItemIndex);\n                }\n            } else { // onStage\n                let targetI = pos % 9;\n                let temp = this.onStageHeros[targetI];\n                this.onStageHeros[targetI] = null;\n                if (this.mouseSelectItemType === 'on') {\n                    this.onStageHeros[this.mouseSelectItemIndex] = null;\n                } else {\n                    this.offStageHeros[this.mouseSelectItemIndex] = null;\n                }\n                this.addOnStageHero(this.mouseSelectItem, targetI as 0);\n                if (this.mouseSelectItemType === 'on') {\n                    this.addOnStageHero(temp, this.mouseSelectItemIndex);\n                } else {\n                    this.addOffStageHero(temp, this.mouseSelectItemIndex);\n                }\n            }\n        }\n\n        this.isMouseDown = false;\n        this.mouseSelectItem = null;\n    }\n\n    handleMouseMove(e: MouseEvent) {\n        this.handleMove(e.clientX, e.clientY);\n    }\n\n    handleTouchMove(e: TouchEvent) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.handleMove(e.changedTouches[0].clientX, e.changedTouches[0].clientY);\n    }\n\n    handleMove(clientX: number, clientY: number) {\n        this.mouseSelectItemPosition = [clientX * this.sizeRate, clientY * this.sizeRate];\n    }\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { Game } from './core';\nimport s from './App.module.css';\n\nconst game = new Game();\n\nconst grapeshot = {\n    type: 'grapeshot-hero',\n    name: '霰弹',\n    price: 300\n}\n\nconst lightning = {\n    type: 'lightning-hero',\n    name: '闪电',\n    price: 300\n}\n\nconst sniper = {\n    type: 'sniper-hero',\n    name: '狙击手',\n    price: 500\n}\n\nconst createProduct = () => {\n    let r = Math.random();\n\n    if (r < 0.33) {\n        return grapeshot;\n    } else if (r < 0.66) {\n        return lightning;\n    } else {\n        return sniper;\n    }\n}\n\nconst createProductList = () => {\n    return [\n        createProduct(),\n        createProduct(),\n        createProduct(),\n        createProduct(),\n        createProduct()\n    ];\n}\n\nconst App = () => {\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n    const [end, setEnd] = useState(false);\n    const [isShopOpen, setIsShopOpen] = useState(false);\n    const [productList, setProductList] = useState(createProductList());\n    const [showShopError, setShowShopError] = useState(false);\n\n    useEffect(() => {\n        if (!canvasRef.current) return;\n        canvasRef.current.width = game.width;\n        canvasRef.current.height = game.height;\n    }, [canvasRef]);\n\n    useEffect(() => {\n        game.setEnd = setEnd;\n    }, [end]);\n\n    useEffect(() => {\n        game.render(canvasRef.current);\n    }, [canvasRef]);\n\n    useEffect(() => {\n        const handler = game.handleMouseUp.bind(game);\n        const touchEndHandler = game.handleTouchEnd.bind(game);\n        window.addEventListener('mouseup', handler);\n        window.addEventListener('touchend', touchEndHandler)\n        return () => {\n            window.removeEventListener('mouseup', handler);\n            window.removeEventListener('touchend', touchEndHandler);\n        }\n    }, []);\n\n    function restart() {\n        game.restart();\n        setEnd(false);\n        game.render(canvasRef.current);\n    }\n\n    return <>\n        <canvas ref={canvasRef} className={s.canvas}\n            onClick={() => {\n                setIsShopOpen(false);\n                setShowShopError(false);\n            }}\n            onTouchStart={game.handleTouchStart.bind(game)}\n            onMouseDown={game.handleCanvasMouseDown.bind(game)} />\n        <div className={s.info}>\n            <div>\n                <button className={s.shopBtn} onClick={() => {\n                    setIsShopOpen(!isShopOpen);\n                    setShowShopError(false);\n                }}>商店</button>\n                {isShopOpen && <div className={s.shopBox}>\n                    <ul className={s.shopList}>\n                        {productList.map((p, i) => <li className={s.shopItem} key={i} onClick={() => {\n                            let buySuccess = false;\n                            switch (p.type) {\n                                case 'grapeshot-hero':\n                                    buySuccess = game.buyHero('grapeshot');\n                                    break;\n                                case 'sniper-hero':\n                                    buySuccess = game.buyHero('sniper');\n                                    break;\n                                case 'lightning-hero':\n                                default:\n                                    buySuccess = game.buyHero('lightning');\n                                    break;\n                            }\n                            if (!buySuccess) {\n                                setShowShopError(true);\n                                return;\n                            }\n                            setIsShopOpen(false);\n                            setProductList(createProductList());\n                            setShowShopError(false);\n                        }}>\n                            {p.name}\n                            <div className={s.shopItemPrice}>\n                                ${p.price}\n                            </div>\n                        </li>)}\n                    </ul>\n                    {showShopError && <div className={s.shopError}>\n                        钱不够！！！！！！\n                    </div>}\n                </div>}\n            </div>\n            <div className={[s.gameEndBox, end ? s.end : ''].join(' ')}>\n                END\n                <button onClick={restart} className={s.restartBtn}>restart</button>\n            </div>\n        </div>\n    </>\n}\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas\":\"App_canvas__1KgDx\",\"info\":\"App_info__3tKmE\",\"gameEndBox\":\"App_gameEndBox__e2Cnq\",\"end\":\"App_end__3t3U7\",\"restartBtn\":\"App_restartBtn__2M1an\",\"shopBtn\":\"App_shopBtn__1GjVz\",\"shopBox\":\"App_shopBox__ApMbX\",\"shopList\":\"App_shopList__2OMys\",\"shopItem\":\"App_shopItem__2UEyj\",\"shopItemPrice\":\"App_shopItemPrice__19Ocx\",\"shopError\":\"App_shopError__12I5k\"};"],"sourceRoot":""}