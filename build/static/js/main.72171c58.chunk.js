(this["webpackJsonpd-game"]=this["webpackJsonpd-game"]||[]).push([[0],{19:function(e,t,i){},21:function(e,t,i){"use strict";i.r(t);var s=i(5),n=i.n(s),o=i(14),a=i.n(o),h=(i(19),i(4)),r=i(2),l=i(0),c=i(1),u=function(){function e(t,i,s){Object(l.a)(this,e),this.x=0,this.y=0,this.coordinate=void 0,this.x=t,this.y=i,this.coordinate=s}return Object(c.a)(e,[{key:"toNumber",value:function(){return[this.x+this.coordinate.origin[0],this.y+this.coordinate.origin[1]]}},{key:"plus",value:function(t,i){return new e(this.x+t,this.y+i,this.coordinate)}},{key:"lengthTo",value:function(e){var t=this.toNumber(),i=e.toNumber();return Math.pow(Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),.5)}}]),e}(),d=function(){function e(t,i){Object(l.a)(this,e),this.origin=[0,0],this.origin=[t,i]}return Object(c.a)(e,[{key:"resetOrigin",value:function(e){this.origin=e.toNumber()}},{key:"point",value:function(e,t){return new u(e,t,this)}},{key:"toPoint",value:function(e,t){return new u(e-this.origin[0],t-this.origin[1],this)}}]),e}(),g=function(e,t,i,s,n,o){i<2*n&&(n=i/2),s<2*n&&(n=s/2),o.beginPath(),o.moveTo(e+n,t),o.arcTo(e+i,t,e+i,t+s,n),o.arcTo(e+i,t+s,e,t+s,n),o.arcTo(e,t+s,e,t,n),o.arcTo(e,t,e+i,t,n),o.closePath(),o.stroke()},f=function(e,t,i,s,n){var o=e.toNumber(),a=Object(h.a)(o,2),l=a[0],c=a[1],u=t.toNumber(),d=Object(h.a)(u,2),g=d[0]-l,f=d[1]-c,p=e.lengthTo(t),m=g/p,v=f/p;i.strokeStyle=s||"white",i.shadowColor=n||"blue",i.shadowBlur=14,i.shadowOffsetX=0,i.shadowOffsetY=0,i.beginPath(),i.lineWidth=1,i.moveTo.apply(i,Object(r.a)(e.toNumber()));for(var y=1;y<5;y++){var b=e.plus(g/5*y,f/5*y),S=60*(Math.random()-.5);b=b.plus(S*v,S*m),i.lineTo.apply(i,Object(r.a)(b.toNumber()))}i.lineTo.apply(i,Object(r.a)(t.toNumber())),i.stroke(),i.closePath(),i.beginPath(),i.lineWidth=2,i.moveTo.apply(i,Object(r.a)(e.toNumber()));for(var O=1;O<5;O++){var w=e.plus(g/5*O,f/5*O),j=60*(Math.random()-.5);w=w.plus(j*v,j*m),i.lineTo.apply(i,Object(r.a)(w.toNumber()))}i.lineTo.apply(i,Object(r.a)(t.toNumber())),i.stroke(),i.closePath(),i.shadowBlur=0,i.lineWidth=1,i.strokeStyle="black"},p=function(){function e(t,i,s){Object(l.a)(this,e),this.value=0,this.size=20,this.point=void 0,this.game=void 0,this.value=t,this.game=s,this.point=new u(i,-this.size,s.coordinate)}return Object(c.a)(e,[{key:"go",value:function(){this.point.y+=.5}},{key:"hited",value:function(e){return e?(this.game.score+=this.value<e?this.value:e,this.value-=e):(this.value--,this.game.score++),this.value<=0&&(this.game.removeEnemy(this),!0)}},{key:"render",value:function(e){var t=this.point.toNumber(),i=Object(h.a)(t,2),s=i[0],n=i[1];g(s,n,this.size,this.size,5,e),e.textAlign="center",e.fillText("".concat(this.value),s+this.size/2,n+13)}}]),e}(),m=i(7),v=i(6),y=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"go",value:function(){}},{key:"render",value:function(e){}}]),e}(),b=function(e){Object(m.a)(i,e);var t=Object(v.a)(i);function i(e,s,n,o,a){var h,r=a.speed,c=a.color;return Object(l.a)(this,i),(h=t.call(this)).point=void 0,h.game=void 0,h.size=2,h.direction=0,h.speed=30,h.color="black",h.isEnd=!1,h.hero=void 0,h.point=e,h.direction=s,h.game=n,h.hero=o,r&&(h.speed=r),c&&(h.color=c),h}return Object(c.a)(i,[{key:"go",value:function(){for(var e=this,t=0;t<5*this.speed;t++){if(this.point.y-=Math.cos(this.direction),this.point.x+=Math.sin(this.direction),this.game.enemys.some((function(t){return e.point.x>=t.point.x-2&&e.point.y>=t.point.y-2&&e.point.x<=t.point.x+t.size+2&&e.point.y<=t.point.y+t.size+2&&(t.hited()&&e.hero.addKillNumber(),e.game.removeBullet(e),e.isEnd=!0,!0)})))return}(this.point.y<0||this.point.y>this.game.height||this.point.x<0||this.point.x>this.game.width)&&this.game.removeBullet(this)}},{key:"render",value:function(e){var t=this.point.toNumber(),i=Object(h.a)(t,2),s=i[0],n=i[1];e.beginPath(),e.moveTo(s,n),e.lineTo(s-Math.sin(this.direction)*this.speed,n+Math.cos(this.direction)*this.speed);var o=e.createLinearGradient(s,n,s-Math.sin(this.direction)*this.speed,n+Math.cos(this.direction)*this.speed);o.addColorStop(0,this.color),o.addColorStop(1,"white"),e.strokeStyle=o,e.stroke(),e.closePath(),e.strokeStyle="black"}}]),i}(y),S=function(){function e(t){Object(l.a)(this,e),this.point=void 0,this.level=1,this.color="blue",this.type="hero",this.step=0,this.killNumber=0,this.game=void 0,this.game=t,this.point=new u(0,0,t.coordinate)}return Object(c.a)(e,[{key:"size",get:function(){switch(this.level){case 1:case 2:return 30;default:case 3:return 30}}},{key:"addKillNumber",value:function(){this.killNumber++,this.killNumber>=100&&(this.killNumber=0,this.startSpecialMove())}},{key:"startSpecialMove",value:function(){}},{key:"go",value:function(){this.step++}},{key:"render",value:function(e,t){var i=t||this.point.toNumber(),s=Object(h.a)(i,2),n=s[0],o=s[1];e.strokeStyle=this.color,g(n,o,this.size,this.size,5,e),e.strokeStyle="black",e.fillStyle="white",e.fill(),e.fillStyle=this.color,e.textAlign="center",e.fillText("".concat(this.level),n+this.size/2,o+18),e.fillStyle="green",e.strokeStyle="green",g(n+1,o+this.size+3,this.killNumber/100*(this.size-2),2,1,e),e.fill(),e.strokeStyle="black",e.fillStyle="white",e.fillStyle="black"}},{key:"isPointIn",value:function(e,t){var i=this.point.toNumber(),s=Object(h.a)(i,2),n=s[0],o=s[1];return e>=n-10&&e<=n+this.size+10&&t>=o-10&&t<=o+this.size+10}},{key:"addToOffStage",value:function(e){}}]),e}(),O=function(e){Object(m.a)(i,e);var t=Object(v.a)(i);function i(){var e;Object(l.a)(this,i);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).type="grapeshot-hero",e.color="black",e.specialLength=0,e.nullHero=new S(e.game),e}return Object(c.a)(i,[{key:"cycle",get:function(){switch(this.level){case 1:return 5;case 2:return 3;default:case 3:return 1}}},{key:"go",value:function(){if(this.step%this.cycle===0)for(var e=0;e<5;e++)this.game.bullets.push(new b(this.point.plus(this.size/2,0),.4*Math.PI*(Math.random()-.5),this.game,this,{speed:30+Math.floor(30*Math.random())}));if(0!==this.specialLength){if(this.specialLength%3===0)for(var t=0;t<15;t++)this.game.bullets.push(new b(new u(30*t+10,this.game.targetY,this.game.coordinate),0,this.game,this.nullHero,{speed:30+Math.floor(30*Math.random()),color:"red"}));this.specialLength--}this.step++}},{key:"startSpecialMove",value:function(){this.specialLength=200}}]),i}(S),w=i(10),j=i(8),k=function(e){Object(m.a)(i,e);var t=Object(v.a)(i);function i(e,s){var n;return Object(l.a)(this,i),(n=t.call(this)).game=void 0,n.hero=void 0,n.y=0,n.game=e,n.hero=s,n.y=n.game.targetY,n}return Object(c.a)(i,[{key:"speed",get:function(){switch(this.hero.level){case 1:return 5;case 2:return 3;case 3:default:return 1}}},{key:"go",value:function(){var e=this;this.y-=this.speed,this.game.enemys.forEach((function(t){t.point.y<=e.y&&t.point.y+t.size>=e.y&&t.hited()})),this.y<=0&&this.game.removeBullet(this)}},{key:"render",value:function(e){f(new u(0,this.y,this.game.coordinate),new u(this.game.width,this.y,this.game.coordinate),e,this.hero._color,this.hero._lightColor)}}]),i}(y),x=function(e){Object(m.a)(i,e);var t=Object(v.a)(i);function i(){var e;Object(l.a)(this,i);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).type="lightning-hero",e.targets={length:0,chain:null,end:null},e}return Object(c.a)(i,[{key:"cycle",get:function(){switch(this.level){case 1:return 3;case 2:return 2;default:case 3:return 1}}},{key:"_color",get:function(){switch(this.level){case 1:case 2:return"white";default:case 3:return"black"}}},{key:"_lightColor",get:function(){switch(this.level){case 1:return"blue";case 2:return"red";default:case 3:return"red"}}},{key:"targetMaxLength",get:function(){switch(this.level){case 1:return 2;case 2:return 3;default:case 3:return 5}}},{key:"go",value:function(){if(this.targets.length<this.targetMaxLength&&this.game.enemys.length>=this.targetMaxLength){for(var e=this.targetMaxLength-this.targets.length;0!==e;){var t=this.game.enemys.length,i=Math.floor(t*Math.random());if(this.targets.chain)this.addTarget({value:this.game.enemys[i],next:null})&&e--;else this.addTarget({value:this.game.enemys[i],next:null}),e--}this.targets.length=this.targetMaxLength}if(this.step%this.cycle===0){for(var s=this.targets.chain;s;){s.value.hited()&&this.addKillNumber(),s=s.next}if(!(s=this.targets.chain))return;if(s.value.value<=0)this.targets.length=0,this.targets.chain=null,this.targets.end=null;else{var n=s;s=s.next;for(var o=1;s;){if(s.value.value<=0){n.next=null,this.targets.length=o,this.targets.end=n;break}n=s,s=s.next,o++}}}this.step++}},{key:"render",value:function(e,t){if(Object(w.a)(Object(j.a)(i.prototype),"render",this).call(this,e,t),this.targets.chain)for(var s=this.targets.chain,n=this.point.plus(this.size/2,0);s;){var o=s.value.point.plus(s.value.size/2,s.value.size/2);f(n,o,e,this._color,this._lightColor),n=s.value.point.plus(s.value.size/2,s.value.size/2),s=s.next}}},{key:"startSpecialMove",value:function(){this.game.bullets.push(new k(this.game,this))}},{key:"addTarget",value:function(e){if(null===this.targets.end)this.targets.chain=e,this.targets.end=e,this.targets.length++;else{for(var t=this.targets.chain;t;){if(e===t)return!1;t=t.next}this.targets.end.next=e,this.targets.end=this.targets.end.next,this.targets.length++}return!0}},{key:"addToOffStage",value:function(e){Object(w.a)(Object(j.a)(i.prototype),"addToOffStage",this).call(this,e),this.targets={length:0,chain:null,end:null}}}]),i}(S),H=function(e){Object(m.a)(i,e);var t=Object(v.a)(i);function i(e,s,n,o,a){var h,r=a.speed,c=a.color,u=a.damage;Object(l.a)(this,i),(h=t.call(this)).point=void 0,h.startPoint=void 0,h.targetPoint=void 0,h.game=void 0,h.hero=void 0,h.damage=0,h.sin=0,h.cos=0,h.speed=30,h.color="black",h.game=e,h.hero=s,h.startPoint=n,h.point=n.plus(0,0),h.targetPoint=o,r&&(h.speed=r),c&&(h.color=c),h.damage=u;var d=h.targetPoint.y-h.startPoint.y,g=h.targetPoint.x-h.startPoint.x,f=Math.pow(Math.pow(d,2)+Math.pow(g,2),.5);return h.sin=g/f,h.cos=-d/f,h}return Object(c.a)(i,[{key:"go",value:function(){for(var e=this,t=0;t<5*this.speed;t++)this.point.y+=-this.cos,this.point.x+=this.sin,this.game.enemys.forEach((function(t){return e.point.x>=t.point.x-2&&e.point.y>=t.point.y-2&&e.point.x<=t.point.x+t.size+2&&e.point.y<=t.point.y+t.size+2&&(t.hited(e.damage)&&e.hero.addKillNumber(),!0)}));(this.point.y<0||this.point.y>this.game.height||this.point.x<0||this.point.x>this.game.width)&&this.game.removeBullet(this)}},{key:"render",value:function(e){var t=this.point.toNumber(),i=Object(h.a)(t,2),s=i[0],n=i[1];e.beginPath(),e.moveTo(s,n),e.lineTo(s-150*this.sin,n+150*this.cos);var o=e.createLinearGradient(s,n,s-150*this.sin,n+150*this.cos);o.addColorStop(0,this.color),o.addColorStop(1,"white"),e.strokeStyle=o,e.lineWidth=2,e.stroke(),e.closePath(),e.strokeStyle="black",e.lineWidth=1}}]),i}(y),M=function(e){Object(m.a)(i,e);var t=Object(v.a)(i);function i(){var e;Object(l.a)(this,i);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).type="sniper-hero",e.target=null,e.damage=0,e.color="green",e.nullHero=new S(e.game),e.specialTargets=[],e.specialDamage=-1,e.specialDamageMax=30,e}return Object(c.a)(i,[{key:"cycle",get:function(){switch(this.level){case 1:return 5;case 2:return 3;default:case 3:return 2}}},{key:"go",value:function(){var e=this;if(!this.target){var t=this.game.enemys[0];this.game.enemys.forEach((function(e){e.value>t.value&&(t=e)})),this.target=t}if(this.step%this.cycle!==0)return Object(w.a)(Object(j.a)(i.prototype),"go",this).call(this);this.damage<this.target.value?this.damage+=1:(this.game.bullets.push(new H(this.game,this,this.point.plus(this.size/2,0),this.target.point.plus(this.target.size/2,this.target.size/2),{damage:this.damage})),this.damage=0,this.target=null),this.specialDamage>0&&(this.specialDamage++,this.specialTargets=this.specialTargets.filter((function(e){return e.value>0})),this.specialDamage>=this.specialDamageMax&&(this.specialTargets.forEach((function(t){e.game.bullets.push(new H(e.game,e.nullHero,e.point.plus(e.size/2,0),t.point.plus(t.size/2,t.size/2),{damage:e.specialDamage}))})),this.specialDamage=-1,this.specialTargets=[])),Object(w.a)(Object(j.a)(i.prototype),"go",this).call(this)}},{key:"startSpecialMove",value:function(){for(var e=this,t=new Set;t.size<12;)t.add(Math.floor(Math.random()*this.game.enemys.length));t.forEach((function(t){e.specialTargets.push(e.game.enemys[t])})),console.log("special",this.specialTargets),this.specialDamage=1}},{key:"render",value:function(e,t){var s=this;Object(w.a)(Object(j.a)(i.prototype),"render",this).call(this,e,t),this.target&&this.renderTarget(e,this.target,5+(this.target.value-this.damage>0?this.target.value-this.damage:0)),this.specialTargets.forEach((function(t){s.renderTarget(e,t,5+s.specialDamageMax-s.specialDamage)}))}},{key:"renderTarget",value:function(e,t,i){e.strokeStyle="red",e.lineWidth=3,e.beginPath(),e.arc.apply(e,Object(r.a)(t.point.plus(t.size/2,t.size/2).toNumber()).concat([i,0,2*Math.PI])),e.moveTo.apply(e,Object(r.a)(t.point.plus(t.size/2,t.size/2+i+5).toNumber())),e.lineTo.apply(e,Object(r.a)(t.point.plus(t.size/2,t.size/2+i-5).toNumber())),e.moveTo.apply(e,Object(r.a)(t.point.plus(t.size/2,t.size/2-i+5).toNumber())),e.lineTo.apply(e,Object(r.a)(t.point.plus(t.size/2,t.size/2-i-5).toNumber())),e.moveTo.apply(e,Object(r.a)(t.point.plus(t.size/2+i+5,t.size/2).toNumber())),e.lineTo.apply(e,Object(r.a)(t.point.plus(t.size/2+i-5,t.size/2).toNumber())),e.moveTo.apply(e,Object(r.a)(t.point.plus(t.size/2-i+5,t.size/2).toNumber())),e.lineTo.apply(e,Object(r.a)(t.point.plus(t.size/2-i-5,t.size/2).toNumber())),e.stroke(),e.closePath(),e.strokeStyle="black",e.lineWidth=1}}]),i}(S),T=/Android|webOS|iPhone|iPod|BlackBerry/i.test(window.navigator.userAgent),z=function(){function e(){Object(l.a)(this,e),this.coordinate=new d(0,0),this.enemys=[],this.offStageHeros=[null,null,null,null,null,null,null,null,null],this.onStageHeros=[null,null,null,null,null,null,null,null,null],this.bullets=[],this.width=460,this.height=460*window.innerHeight/window.innerWidth,this.sizeRate=460/window.innerWidth,this.targetY=this.height-150,this.targetLineLeft=this.coordinate.point(0,this.targetY),this.targetLineRight=this.coordinate.point(this.width,this.targetY),this.offStageHeroY=this.height-70,this.onStageHeroY=this.height-120,this.heroPosList=[new u(55,this.offStageHeroY,this.coordinate),new u(95,this.offStageHeroY,this.coordinate),new u(135,this.offStageHeroY,this.coordinate),new u(175,this.offStageHeroY,this.coordinate),new u(215,this.offStageHeroY,this.coordinate),new u(255,this.offStageHeroY,this.coordinate),new u(295,this.offStageHeroY,this.coordinate),new u(335,this.offStageHeroY,this.coordinate),new u(375,this.offStageHeroY,this.coordinate),new u(55,this.onStageHeroY,this.coordinate),new u(95,this.onStageHeroY,this.coordinate),new u(135,this.onStageHeroY,this.coordinate),new u(175,this.onStageHeroY,this.coordinate),new u(215,this.onStageHeroY,this.coordinate),new u(255,this.onStageHeroY,this.coordinate),new u(295,this.onStageHeroY,this.coordinate),new u(335,this.onStageHeroY,this.coordinate),new u(375,this.onStageHeroY,this.coordinate)],this.cycle=60,this.step=0,this.setEnd=null,this.$=300,this.score=0,this.isMouseDown=!1,this.mouseSelectItem=null,this.mouseSelectItemType="off",this.mouseSelectItemIndex=0,this.mouseSelectItemPosition=[0,0],this.mouseSelectItemOffset=[0,0],this.go(),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this)}return Object(c.a)(e,[{key:"restart",value:function(){this.enemys=[],this.offStageHeros=[null,null,null,null,null,null,null,null,null],this.onStageHeros=[null,null,null,null,null,null,null,null,null],this.bullets=[],this.step=0,this.$=300,this.score=0,this.go()}},{key:"addEnemy",value:function(){for(var e=0;e<15;e++)this.enemys.push(new p(Math.ceil(this.step/150*Math.random()+1),30*e+10,this))}},{key:"removeBullet",value:function(e){this.bullets=this.bullets.filter((function(t){return t!==e}))}},{key:"removeEnemy",value:function(e){this.enemys=this.enemys.filter((function(t){return t!==e})),this.$++}},{key:"buyHero",value:function(e){switch(e){case"lightning":if(this.$<300)return!1;this.$-=300,this.addOffStageHero(new x(this));break;case"sniper":if(this.$<500)return!1;this.$-=500,this.addOffStageHero(new M(this));break;case"grapeshot":default:if(this.$<300)return!1;this.$-=300,this.addOffStageHero(new O(this))}return!0}},{key:"go",value:function(){this.step%this.cycle===0&&this.addEnemy(),this.enemys.forEach((function(e){e.go()})),this.onStageHeros.forEach((function(e){null===e||void 0===e||e.go()})),this.bullets.forEach((function(e){e.go()})),this.step++}},{key:"render",value:function(e){var t=this;if(e){var i=e.getContext("2d");if(i){this.go(),i.clearRect(0,0,e.width,e.height),i.strokeRect.apply(i,Object(r.a)(this.coordinate.origin).concat([this.width,this.height])),i.beginPath(),i.strokeStyle="grey",this.heroPosList.forEach((function(e){g.apply(void 0,Object(r.a)(e.plus(8,8).toNumber()).concat([14,14,5,i]))})),i.strokeStyle="black",i.closePath(),i.beginPath(),this.offStageHeros.forEach((function(e){null===e||void 0===e||e.render(i)})),this.onStageHeros.forEach((function(e){null===e||void 0===e||e.render(i)})),i.closePath();var s=!1;this.enemys.forEach((function(e){e.render(i),e.point.y>=t.targetY-e.size&&(s=!0)})),i.beginPath(),i.moveTo.apply(i,Object(r.a)(this.targetLineLeft.toNumber())),i.lineTo.apply(i,Object(r.a)(this.targetLineRight.toNumber())),i.stroke(),i.closePath(),i.beginPath(),this.bullets.forEach((function(e){e.render(i)})),i.closePath(),this.mouseSelectItem&&(this.mouseSelectItem.render(i,[this.mouseSelectItemPosition[0]+this.mouseSelectItemOffset[0],this.mouseSelectItemPosition[1]+this.mouseSelectItemOffset[1]]),T&&(i.putImageData(i.getImageData(0,this.targetY,this.width,150),0,this.targetY-150),i.rect(0,this.targetY-150,this.width,150),i.stroke())),i.beginPath(),i.font="bold 24px Arial",i.fillStyle="red",i.textAlign="right",i.fillText("$:".concat(this.$),440,30),i.font="12px Arial",i.fillStyle="black",i.closePath(),i.beginPath(),i.font="bold 24px Arial",i.fillStyle="red",i.textAlign="left",i.fillText("score:".concat(this.score),20,30),i.font="12px Arial",i.fillStyle="black",i.closePath(),s?this.setEnd&&this.setEnd(!0):requestAnimationFrame((function(){t.render(e)}))}}}},{key:"addOffStageHero",value:function(e,t){if(void 0===t&&this.offStageHeros.some((function(e,i){return null===e&&(t=i,!0)})),void 0!==t&&(this.offStageHeros[t]=e,e)){if(e.point.y=this.offStageHeroY,e.point.x=55+40*t,e.addToOffStage(t),e.level>=3)return;var i=[];this.offStageHeros.forEach((function(t,s){(null===t||void 0===t?void 0:t.type)===e.type&&e.level===t.level&&i.push(s)})),i.length>=3&&(this.addOffStageHero(null,i[0]),this.addOffStageHero(null,i[1]),this.offStageHeros[i[2]].level+=1,this.addOffStageHero(this.offStageHeros[i[2]],i[2]))}}},{key:"addOnStageHero",value:function(e,t){if(void 0===t&&this.onStageHeros.some((function(e,i){return null===e&&(t=i,!0)})),void 0!==t&&(this.onStageHeros[t]=e,e)){if(e.point.y=this.onStageHeroY,e.point.x=55+40*t,e.level>=3)return;var i=[];this.onStageHeros.forEach((function(t,s){(null===t||void 0===t?void 0:t.type)===e.type&&e.level===t.level&&i.push(s)})),i.length>=3&&(this.addOnStageHero(null,i[0]),this.addOnStageHero(null,i[1]),this.onStageHeros[i[2]].level+=1,this.addOnStageHero(this.onStageHeros[i[2]],i[2]))}}},{key:"handleCanvasMouseDown",value:function(e){this.isMouseDown=!0;var t=this.findHero(this.offStageHeros,e.clientX,e.clientY,"off"),i=this.findHero(this.onStageHeros,e.clientX,e.clientY,"on");(t||i)&&window.addEventListener("mousemove",this.handleMouseMove)}},{key:"handleTouchStart",value:function(e){(e.stopPropagation(),e.preventDefault(),this.isMouseDown=!0,this.findHero(this.offStageHeros,e.touches[0].clientX,e.touches[0].clientY,"off"))?window.addEventListener("touchmove",this.handleTouchMove,{passive:!1}):this.findHero(this.onStageHeros,e.touches[0].clientX,e.touches[0].clientY,"on")&&window.addEventListener("touchmove",this.handleTouchMove,{passive:!1})}},{key:"findHero",value:function(e,t,i,s){var n=this,o=e.findIndex((function(e){if(!e)return!1;var s=e.isPointIn(t*n.sizeRate,i*n.sizeRate);if(s){var o=e.point.toNumber();n.mouseSelectItemOffset=[o[0]-t*n.sizeRate,o[1]-i*n.sizeRate]}return s}));return-1!==o&&(this.mouseSelectItem=e[o],this.mouseSelectItemType=s,this.mouseSelectItemIndex=o,this.mouseSelectItemPosition=[t*this.sizeRate,i*this.sizeRate],!0)}},{key:"handleMouseUp",value:function(e){window.removeEventListener("mousemove",this.handleMouseMove),this.handleEventEnd(e.clientX,e.clientY)}},{key:"handleTouchEnd",value:function(e){window.removeEventListener("touchmove",this.handleTouchMove),this.handleEventEnd(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}},{key:"handleEventEnd",value:function(e,t){var i=[e*this.sizeRate+this.mouseSelectItemOffset[0],t*this.sizeRate+this.mouseSelectItemOffset[1]],s=[i[0]+30,i[1]+30],n=this.heroPosList.findIndex((function(e){var t=e.toNumber();return i[0]>t[0]-18&&i[1]>t[1]-18&&s[0]<t[0]+48&&s[1]<t[1]+48}));if(-1!==n&&this.mouseSelectItem)if(0===Math.floor(n/9)){var o=n%9,a=this.offStageHeros[o];this.offStageHeros[o]=null,"on"===this.mouseSelectItemType?this.onStageHeros[this.mouseSelectItemIndex]=null:this.offStageHeros[this.mouseSelectItemIndex]=null,this.addOffStageHero(this.mouseSelectItem,o),"on"===this.mouseSelectItemType?this.addOnStageHero(a,this.mouseSelectItemIndex):this.addOffStageHero(a,this.mouseSelectItemIndex)}else{var h=n%9,r=this.onStageHeros[h];this.onStageHeros[h]=null,"on"===this.mouseSelectItemType?this.onStageHeros[this.mouseSelectItemIndex]=null:this.offStageHeros[this.mouseSelectItemIndex]=null,this.addOnStageHero(this.mouseSelectItem,h),"on"===this.mouseSelectItemType?this.addOnStageHero(r,this.mouseSelectItemIndex):this.addOffStageHero(r,this.mouseSelectItemIndex)}this.isMouseDown=!1,this.mouseSelectItem=null}},{key:"handleMouseMove",value:function(e){this.handleMove(e.clientX,e.clientY)}},{key:"handleTouchMove",value:function(e){e.preventDefault(),e.stopPropagation(),this.handleMove(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}},{key:"handleMove",value:function(e,t){this.mouseSelectItemPosition=[e*this.sizeRate,t*this.sizeRate]}}]),e}(),I=i(9),E=i.n(I),P=i(3),N=new z,Y={type:"grapeshot-hero",name:"\u9730\u5f39",price:300},_={type:"lightning-hero",name:"\u95ea\u7535",price:300},L={type:"sniper-hero",name:"\u72d9\u51fb\u624b",price:500},A=function(){var e=Math.random();return e<.33?Y:e<.66?_:L},D=function(){return[A(),A(),A(),A(),A()]},B=function(){var e=Object(s.useRef)(null),t=Object(s.useState)(!1),i=Object(h.a)(t,2),n=i[0],o=i[1],a=Object(s.useState)(!1),r=Object(h.a)(a,2),l=r[0],c=r[1],u=Object(s.useState)(D()),d=Object(h.a)(u,2),g=d[0],f=d[1],p=Object(s.useState)(!1),m=Object(h.a)(p,2),v=m[0],y=m[1];return Object(s.useEffect)((function(){e.current&&(e.current.width=N.width,e.current.height=N.height)}),[e]),Object(s.useEffect)((function(){N.setEnd=o}),[n]),Object(s.useEffect)((function(){N.render(e.current)}),[e]),Object(s.useEffect)((function(){var e=N.handleMouseUp.bind(N),t=N.handleTouchEnd.bind(N);return window.addEventListener("mouseup",e),window.addEventListener("touchend",t),function(){window.removeEventListener("mouseup",e),window.removeEventListener("touchend",t)}}),[]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("canvas",{ref:e,className:E.a.canvas,onClick:function(){c(!1),y(!1)},onTouchStart:N.handleTouchStart.bind(N),onMouseDown:N.handleCanvasMouseDown.bind(N)}),Object(P.jsxs)("div",{className:E.a.info,children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("button",{className:E.a.shopBtn,onClick:function(){c(!l),y(!1)},children:"\u5546\u5e97"}),l&&Object(P.jsxs)("div",{className:E.a.shopBox,children:[Object(P.jsx)("ul",{className:E.a.shopList,children:g.map((function(e,t){return Object(P.jsxs)("li",{className:E.a.shopItem,onClick:function(){var t=!1;switch(e.type){case"grapeshot-hero":t=N.buyHero("grapeshot");break;case"sniper-hero":t=N.buyHero("sniper");break;case"lightning-hero":default:t=N.buyHero("lightning")}t?(c(!1),f(D()),y(!1)):y(!0)},children:[e.name,Object(P.jsxs)("div",{className:E.a.shopItemPrice,children:["$",e.price]})]},t)}))}),v&&Object(P.jsx)("div",{className:E.a.shopError,children:"\u94b1\u4e0d\u591f\uff01\uff01\uff01\uff01\uff01\uff01"})]})]}),Object(P.jsxs)("div",{className:[E.a.gameEndBox,n?E.a.end:""].join(" "),children:["END",Object(P.jsx)("button",{onClick:function(){N.restart(),o(!1),N.render(e.current)},className:E.a.restartBtn,children:"restart"})]})]})]})},C=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,22)).then((function(t){var i=t.getCLS,s=t.getFID,n=t.getFCP,o=t.getLCP,a=t.getTTFB;i(e),s(e),n(e),o(e),a(e)}))};a.a.render(Object(P.jsx)(n.a.StrictMode,{children:Object(P.jsx)(B,{})}),document.getElementById("root")),C()},9:function(e,t,i){e.exports={canvas:"App_canvas__1KgDx",info:"App_info__3tKmE",gameEndBox:"App_gameEndBox__e2Cnq",end:"App_end__3t3U7",restartBtn:"App_restartBtn__2M1an",shopBtn:"App_shopBtn__1GjVz",shopBox:"App_shopBox__ApMbX",shopList:"App_shopList__2OMys",shopItem:"App_shopItem__2UEyj",shopItemPrice:"App_shopItemPrice__19Ocx",shopError:"App_shopError__12I5k"}}},[[21,1,2]]]);
//# sourceMappingURL=main.72171c58.chunk.js.map