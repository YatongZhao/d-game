{"version":3,"sources":["core/Point.ts","core/Coordinate.ts","core/Enemy/EnemySet.ts","core/Bullet/Bullet.ts","core/tool/index.ts","core/Hero/Hero.ts","core/Hero/GrapeshotHero.ts","core/Bullet/SpecialLightningBullet.ts","core/Hero/LightningHero.ts","core/Bullet/SniperBullet.ts","core/Hero/SniperHero.ts","core/Enemy/Enemy.ts","core/Round/Round1.ts","core/index.ts","App.tsx","reportWebVitals.ts","index.tsx","App.module.css"],"names":["Point","x","y","coordinate","this","origin","p","p1","toNumber","p2","Coordinate","EnemySet","array","matrix","set","Set","enemy","delete","map","_enemy","row","callbackfn","forEach","predicate","some","items","item","add","push","size","i","random","Math","floor","length","k","keys","result","next","value","point","res","Bullet","ctx","DefaultBullet","direction","game","hero","speed","color","ATK","isEnd","cos","sin","enemySet","findEnemyByPoint","hited","addKillNumber","removeBullet","height","width","beginPath","moveTo","lineTo","gnt1","createLinearGradient","addColorStop","lineWidth","strokeStyle","stroke","closePath","drawRoundRect","w","h","r","arcTo","drawLightning","lightColor","pn1x","pn1y","dx","dy","l","lengthTo","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","o","plus","randomR","Hero","level","type","step","killNumber","startSpecialMove","position","fillStyle","fill","textAlign","fillText","_x","_y","GrapeshotHero","specialLength","nullHero","cycle","bulletNumber","bullets","PI","bulletColor","bulletSize","targetY","SpecialLightningBullet","findEnemyByY","_color","_lightColor","LightningHero","targets","chain","end","targetMaxLength","smallNum","addTarget","getRandomEnemy","parent","_chain","SniperBullet","damage","startPoint","targetPoint","len","SniperHero","target","specialTargets","specialDamage","specialDamageMax","maxEnemy","get","isPicked","filter","renderTarget","radius","arc","Enemy","n","score","removeEnemy","Round1","waveNumber","symbolLife","ceil","createEnemy","font","stageNumber","isMobile","test","window","navigator","userAgent","createStages","Game","offStageHeros","onStageHeros","innerHeight","innerWidth","sizeRate","targetLineLeft","targetLineRight","offStageHeroY","onStageHeroY","heroPosList","setEnd","setRound","$","HP","renderHP","_round","stage","isRenderStrategy","isMouseDown","mouseSelectItem","mouseSelectItemType","mouseSelectItemIndex","mouseSelectItemPosition","mouseSelectItemOffset","canvas","handleMouseMove","bind","handleTouchMove","newRound","goFighting","reset","round","render","bullet","_bullet","addOffStageHero","go","setResult","award","requestAnimationFrame","loopRender","getContext","clearRect","strokeRect","renderSymbol","pos","fillRect","renderHpWidth","hpWidth","putImageData","getImageData","rect","isWin","undefined","index","addToOffStage","list","_hero","addOnStageHero","e","findHero","clientX","clientY","addEventListener","stopPropagation","preventDefault","touches","passive","heros","heroIndex","findIndex","isTrue","isPointIn","removeEventListener","handleEventEnd","changedTouches","leftUp","rightDown","targetI","temp","handleMove","grapeshot","name","price","lightning","sniper","createProduct","createProductList","App","canvasRef","useRef","useState","isShopOpen","setIsShopOpen","productList","setProductList","showShopError","setShowShopError","useEffect","current","handler","handleMouseUp","touchEndHandler","handleTouchEnd","ref","className","s","onClick","onTouchStart","handleTouchStart","onMouseDown","handleCanvasMouseDown","info","shopBtn","shopBox","shopList","shopItem","buySuccess","buyHero","shopItemPrice","shopError","gameEndBox","join","restart","restartBtn","startFighting","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById","module","exports"],"mappings":"4MAEaA,EAAb,WAKI,WAAYC,EAAWC,EAAWC,GAAyB,yBAJ3DF,EAAI,EAIsD,KAH1DC,EAAI,EAGsD,KAF1DC,gBAE0D,EACtDC,KAAKH,EAAIA,EACTG,KAAKF,EAAIA,EACTE,KAAKD,WAAaA,EAR1B,4CAWI,WACI,MAAO,CAACC,KAAKH,EAAIG,KAAKD,WAAWE,OAAO,GAAID,KAAKF,EAAIE,KAAKD,WAAWE,OAAO,MAZpF,kBAeI,SAAKJ,EAAWC,GACZ,OAAO,IAAIF,EAAMI,KAAKH,EAAIA,EAAGG,KAAKF,EAAIA,EAAGE,KAAKD,cAhBtD,sBAmBI,SAASG,GACL,IAAIC,EAAKH,KAAKI,WACVC,EAAKH,EAAEE,WAEX,OAAO,KAAP,IAAQ,SAACD,EAAG,GAAKE,EAAG,GAAK,GAAjB,SAAsBF,EAAG,GAAKE,EAAG,GAAK,GAAI,QAvB1D,KCAaC,EAAb,WAGI,WAAYT,EAAWC,GAAY,yBAFnCG,OAA2B,CAAC,EAAG,GAG3BD,KAAKC,OAAS,CAACJ,EAAGC,GAJ1B,+CAOI,SAAYG,GACRD,KAAKC,OAASA,EAAOG,aAR7B,mBAWI,SAAMP,EAAWC,GACb,OAAO,IAAIF,EAAMC,EAAGC,EAAGE,QAZ/B,qBAeI,SAAQH,EAAWC,GACf,OAAO,IAAIF,EAAMC,EAAIG,KAAKC,OAAO,GAAIH,EAAIE,KAAKC,OAAO,GAAID,UAhBjE,KCCaO,EAAb,iDACIC,MAAwB,GAD5B,KAEIC,OAA2B,GAF/B,KAGIC,IAAkB,IAAIC,IAH1B,yCAKI,WACIX,KAAKQ,MAAQ,GACbR,KAAKS,OAAS,GACdT,KAAKU,IAAM,IAAIC,MARvB,yBAWI,SAAYC,GACRZ,KAAKU,IAAIG,OAAOD,GAChBZ,KAAKQ,MAAQR,KAAKQ,MAAMM,KAAI,SAAAC,GACxB,OAAIA,IAAWH,EAAc,KACtBG,KAEXf,KAAKS,OAAST,KAAKS,OAAOK,KAAI,SAAAE,GAC1B,OAAOA,EAAIF,KAAI,SAAAC,GACX,OAAIA,IAAWH,EAAc,KACtBG,UApBvB,qBAyBI,SAAQE,GACJjB,KAAKU,IAAIQ,QAAQD,KA1BzB,kBA6BI,SAAKE,GACD,OAAOnB,KAAKQ,MAAMY,KAAKD,KA9B/B,kBAiCI,WAAwB,IAAC,IAAD,4BAAhBE,EAAgB,yBAAhBA,EAAgB,gBAGpB,OAFAA,EAAMH,SAAQ,SAAAI,GAAI,OAAI,EAAKZ,IAAIa,IAAID,MACnCtB,KAAKS,OAAOe,KAAKH,IACV,EAAArB,KAAKQ,OAAMgB,KAAX,QAAmBH,KApClC,kBAuCI,WACI,OAAOrB,KAAKU,IAAIe,OAxCxB,iBA2CI,SAAIC,GACA,OAAO1B,KAAKQ,MAAMkB,KA5C1B,4BA+CI,WAKI,IAJA,IAAIA,EAAI,EACJC,EAASC,KAAKC,MAAMD,KAAKD,SAAW3B,KAAK8B,QACzCC,EAAI/B,KAAKU,IAAIsB,OACbC,EAAgBF,EAAEG,OAAOC,MACtBT,IAAMC,GACTM,EAASF,EAAEG,OAAOC,MAClBT,IAEJ,OAAOO,IAxDf,8BA2DI,SAAiBG,GAIb,IAAKA,EAAMvC,EAAI,GAAK,GAAK,GAAI,OAAO,KACpC,IAAI6B,EAAIE,KAAKC,OAAOO,EAAMvC,EAAI,IAAM,IACpC,GAAI6B,EAAI,GAAKA,EAAI,GAAI,OAAO,KAC5B,IAAIO,EAAuB,KAY3B,OAXAjC,KAAKS,OAAOW,MAAK,SAAAJ,GACb,IAAIJ,EAAQI,EAAIU,GAChB,QAAKd,IACDA,EAAMwB,MAAMtC,EAAIc,EAAMa,KAAO,EAAIW,EAAMtC,GAEhCc,EAAMwB,MAAMtC,EAAI,GAAKsC,EAAMtC,IAClCmC,EAASrB,GACF,OAIRqB,IA9Ef,0BAiFI,SAAanC,GACT,IAAImC,EAAkB,GAiBtB,OAhBAjC,KAAKS,OAAOW,MAAK,SAAAJ,GACb,IAAIqB,GAAM,EAYV,OAXArB,EAAII,MAAK,SAAAR,GACL,QAAKA,IACDA,EAAMwB,MAAMtC,EAAIc,EAAMa,KAAO3B,MAEtBc,EAAMwB,MAAMtC,GAAKA,KACxBmC,EAAOT,KAAKZ,GACZyB,GAAM,GACC,QAIRA,KAGJJ,MAnGf,K,cCCaK,EAAb,kFACI,cADJ,oBAKI,SAAOC,QALX,KAUaC,EAAb,kDAaI,WAAYJ,EAAcK,EAAmBC,EAAYC,EAAzD,GAOI,IAAD,EANCC,EAMD,EANCA,MAAOC,EAMR,EANQA,MAAOC,EAMf,EANeA,IAAKrB,EAMpB,EANoBA,KAMpB,4BACC,gBApBJW,WAmBG,IAlBHM,UAkBG,IAjBHjB,KAAO,EAiBJ,EAhBHgB,UAAY,EAgBT,EAfHG,MAAQ,GAeL,EAdHC,MAAQ,QAcL,EAbHC,IAAM,EAaH,EAXHC,OAAQ,EAWL,EATHJ,UASG,EAEC,EAAKP,MAAQA,EACb,EAAKK,UAAYA,EACjB,EAAKC,KAAOA,EACZ,EAAKC,KAAOA,EACZC,IAAU,EAAKA,MAAQA,GACvBC,IAAU,EAAKA,MAAQA,GACvBC,IAAQ,EAAKA,IAAMA,GACnBrB,IAAS,EAAKA,KAAOA,GATtB,EApBP,sCAgCI,WACI,IAAK,IAAIC,EAAI,EAAGA,EAAiB,EAAb1B,KAAK4C,MAAWlB,IAAK,CACrC1B,KAAKoC,MAAMtC,GAAK8B,KAAKoB,IAAIhD,KAAKyC,WAC9BzC,KAAKoC,MAAMvC,GAAK+B,KAAKqB,IAAIjD,KAAKyC,WAE9B,IAAI7B,EAAQZ,KAAK0C,KAAKQ,SAASC,iBAAiBnD,KAAKoC,OACrD,GAAIxB,EAOA,OANeA,EAAMwC,MAAMpD,KAAK8C,MAE5B9C,KAAK2C,KAAKU,gBAEdrD,KAAK0C,KAAKY,aAAatD,WACvBA,KAAK+C,OAAQ,IAIjB/C,KAAKoC,MAAMtC,EAAI,GACZE,KAAKoC,MAAMtC,EAAIE,KAAK0C,KAAKa,QACzBvD,KAAKoC,MAAMvC,EAAI,GACfG,KAAKoC,MAAMvC,EAAIG,KAAK0C,KAAKc,QAC5BxD,KAAK0C,KAAKY,aAAatD,QApDnC,oBAwDI,SAAOuC,GAAgC,IAAD,EACrBvC,KAAKoC,MAAMhC,WADU,mBAC7BP,EAD6B,KAC1BC,EAD0B,KAsBlCyC,EAAIkB,YACJlB,EAAImB,OAAO7D,EAAGC,GACdyC,EAAIoB,OAAO9D,EAAI+B,KAAKqB,IAAIjD,KAAKyC,WAAazC,KAAK4C,MAAO9C,EAAI8B,KAAKoB,IAAIhD,KAAKyC,WAAazC,KAAK4C,OAC1F,IAAIgB,EAAOrB,EAAIsB,qBAAqBhE,EAAGC,EAAGD,EAAI+B,KAAKqB,IAAIjD,KAAKyC,WAAazC,KAAK4C,MAAO9C,EAAI8B,KAAKoB,IAAIhD,KAAKyC,WAAazC,KAAK4C,OACzHgB,EAAKE,aAAa,EAAE9D,KAAK6C,OACzBe,EAAKE,aAAa,EAAE,SACpBvB,EAAIwB,UAAY/D,KAAKyB,KACrBc,EAAIyB,YAAcJ,EAClBrB,EAAI0B,SACJ1B,EAAI2B,YACJ3B,EAAIyB,YAAc,QAClBzB,EAAIwB,UAAY,MAzFxB,GAAmCzB,GCZtB6B,EAAgB,SAACtE,EAAWC,EAAWsE,EAAWC,EAAWC,EAAW/B,GAC7E6B,EAAI,EAAIE,IAAGA,EAAIF,EAAI,GACnBC,EAAI,EAAIC,IAAGA,EAAID,EAAI,GACvB9B,EAAIkB,YACJlB,EAAImB,OAAO7D,EAAEyE,EAAGxE,GAChByC,EAAIgC,MAAM1E,EAAEuE,EAAGtE,EAAGD,EAAEuE,EAAGtE,EAAEuE,EAAGC,GAC5B/B,EAAIgC,MAAM1E,EAAEuE,EAAGtE,EAAEuE,EAAGxE,EAAGC,EAAEuE,EAAGC,GAC5B/B,EAAIgC,MAAM1E,EAAGC,EAAEuE,EAAGxE,EAAGC,EAAGwE,GACxB/B,EAAIgC,MAAM1E,EAAGC,EAAGD,EAAEuE,EAAGtE,EAAGwE,GACxB/B,EAAI2B,YACJ3B,EAAI0B,UAGKO,EAAgB,SAACrE,EAAWE,EAAWkC,EAA+BM,EAAgB4B,GAAyB,IAAD,EAClGtE,EAAGC,WAD+F,mBAChHsE,EADgH,KAC1GC,EAD0G,OAElGtE,EAAGD,WAF+F,mBAIjHwE,EAJiH,KAIrGF,EACZG,EALiH,KAKrGF,EACZG,EAAI3E,EAAG4E,SAAS1E,GAEhB2C,EAAM4B,EAAKE,EACX7B,EAAM4B,EAAKC,EAEjBvC,EAAIyB,YAAcnB,GAAS,QAE3BN,EAAIyC,YAAcP,GAAc,OAChClC,EAAI0C,WAAa,GACjB1C,EAAI2C,cAAgB,EACpB3C,EAAI4C,cAAgB,EAGpB5C,EAAIkB,YACJlB,EAAIwB,UAAY,EAChBxB,EAAImB,OAAJ,MAAAnB,EAAG,YAAWpC,EAAGC,aACjB,IAAK,IAAIsB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAI0D,EAAIjF,EAAGkF,KAAKT,EAAK,EAAIlD,EAAGmD,EAAK,EAAInD,GAEjC4D,EAAkC,IAAvB1D,KAAKD,SAAW,IAC/ByD,EAAIA,EAAEC,KAAKC,EAAUrC,EAAKqC,EAAUtC,GAEpCT,EAAIoB,OAAJ,MAAApB,EAAG,YAAW6C,EAAEhF,aAEpBmC,EAAIoB,OAAJ,MAAApB,EAAG,YAAWlC,EAAGD,aACjBmC,EAAI0B,SACJ1B,EAAI2B,YAEJ3B,EAAIkB,YACJlB,EAAIwB,UAAY,EAChBxB,EAAImB,OAAJ,MAAAnB,EAAG,YAAWpC,EAAGC,aACjB,IAAK,IAAIsB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAI0D,EAAIjF,EAAGkF,KAAKT,EAAK,EAAIlD,EAAGmD,EAAK,EAAInD,GAEjC4D,EAAkC,IAAvB1D,KAAKD,SAAW,IAC/ByD,EAAIA,EAAEC,KAAKC,EAAUrC,EAAKqC,EAAUtC,GAEpCT,EAAIoB,OAAJ,MAAApB,EAAG,YAAW6C,EAAEhF,aAEpBmC,EAAIoB,OAAJ,MAAApB,EAAG,YAAWlC,EAAGD,aACjBmC,EAAI0B,SACJ1B,EAAI2B,YAEJ3B,EAAI0C,WAAa,EACjB1C,EAAIwB,UAAY,EAChBxB,EAAIyB,YAAc,SC9DTuB,EAAb,WAuBI,WAAY7C,GAAa,yBAtBzBN,WAsBwB,OArBxBoD,MAAe,EAqBS,KATxB3C,MAAQ,OASgB,KARxB4C,KAAO,OAQiB,KANxBC,KAAO,EAMiB,KAJxBC,WAAa,EAIW,KAFxBjD,UAEwB,EACpB1C,KAAK0C,KAAOA,EACZ1C,KAAKoC,MAAQ,IAAIxC,EAAM,EAAG,EAAG8C,EAAK3C,YAzB1C,sCAGI,WACI,OAAQC,KAAKwF,OACT,KAAK,EAEL,KAAK,EACD,OAAO,GACX,QACA,KAAK,EACD,OAAO,MAXvB,2BA4BI,WACIxF,KAAK2F,aACD3F,KAAK2F,YAAc,MACnB3F,KAAK2F,WAAa,EAClB3F,KAAK4F,sBAhCjB,8BAoCI,cApCJ,gBAwCI,WACI5F,KAAK0F,SAzCb,oBA4CI,SAAOnD,EAA+BsD,GAA8B,IAAD,EAClDA,GAAY7F,KAAKoC,MAAMhC,WAD2B,mBAC1DP,EAD0D,KACvDC,EADuD,KAE/DyC,EAAIyB,YAAchE,KAAK6C,MACvBsB,EAActE,EAAGC,EAAGE,KAAKyB,KAAMzB,KAAKyB,KAAM,EAAGc,GAC7CA,EAAIyB,YAAc,QAClBzB,EAAIuD,UAAY,QAChBvD,EAAIwD,OACJxD,EAAIuD,UAAY9F,KAAK6C,MACrBN,EAAIyD,UAAY,SAChBzD,EAAI0D,SAAJ,UAAgBjG,KAAKwF,OAAS3F,EAAIG,KAAKyB,KAAO,EAAG3B,EAAI,IACrDyC,EAAIuD,UAAY,QAChBvD,EAAIyB,YAAc,QAClBG,EAActE,EAAI,EAAGC,EAAIE,KAAKyB,KAAO,EAAGzB,KAAK2F,WAAa,KAAO3F,KAAKyB,KAAO,GAAI,EAAG,EAAGc,GACvFA,EAAIwD,OACJxD,EAAIyB,YAAc,QAClBzB,EAAIuD,UAAY,QAChBvD,EAAIuD,UAAY,UA5DxB,uBA+DI,SAAUjG,EAAWC,GAAY,IAAD,EACbE,KAAKoC,MAAMhC,WADE,mBACvB8F,EADuB,KACnBC,EADmB,KAE5B,OAAOtG,GAAKqG,EAAK,IAAMrG,GAAKqG,EAAKlG,KAAKyB,KAAO,IACtC3B,GAAKqG,EAAK,IAAMrG,GAAKqG,EAAKnG,KAAKyB,KAAO,KAlErD,2BAqEI,SAAcoE,QArElB,KCAaO,EAAb,4MACIX,KAAO,iBADX,EAyDI5C,MAAQ,QAzDZ,EA0DIwD,cAAgB,EA1DpB,EA4DIC,SAAW,IAAIf,EAAK,EAAK7C,MA5D7B,yCAEI,WACI,OAAQ1C,KAAKwF,OACT,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,QACA,KAAK,EACD,OAAO,KAVvB,wBAaI,WACI,OAAQxF,KAAKwF,OACT,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,QACA,KAAK,EACD,OAAO,KArBvB,eAwBI,WACI,OAAQxF,KAAKwF,OACT,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,QACA,KAAK,EACD,OAAO,KAhCvB,sBAmCI,WACI,OAAQxF,KAAKwF,OACT,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,QACA,KAAK,EACD,OAAO,KA3CvB,uBA8CI,WACI,OAAQxF,KAAKwF,OACT,KAAK,EACD,MAAO,QACX,KAAK,EACD,MAAO,OACX,QACA,KAAK,EACD,MAAO,SAtDvB,gBA8DI,WACI,GAAIxF,KAAK0F,KAAO1F,KAAKuG,QAAU,GAAKvG,KAAK0C,KAAKQ,SAASpB,OAAS,EAC5D,IAAK,IAAIJ,EAAI,EAAGA,EAAI1B,KAAKwG,aAAc9E,IACnC1B,KAAK0C,KAAK+D,QAAQjF,KACd,IAAIgB,EACAxC,KAAKoC,MAAMiD,KAAKrF,KAAKyB,KAAK,EAAG,GACrB,GAARG,KAAK8E,IAAQ9E,KAAKD,SAAW,IAC7B3B,KAAK0C,KACL1C,KACA,CACI4C,MAAO,GAAKhB,KAAKC,MAAsB,GAAhBD,KAAKD,UAC5BkB,MAAO7C,KAAK2G,YACZ7D,IAAK9C,KAAK8C,IACVrB,KAAMzB,KAAK4G,cAM/B,GAA2B,IAAvB5G,KAAKqG,cAAqB,CAC1B,GAAIrG,KAAKqG,cAAgB,IAAM,EAC3B,IAAK,IAAI3E,EAAI,EAAGA,EAAI,GAAIA,IACpB1B,KAAK0C,KAAK+D,QAAQjF,KACd,IAAIgB,EACA,IAAI5C,EAAM,GAAK8B,EAAI,GAAI1B,KAAK0C,KAAKmE,QAAS7G,KAAK0C,KAAK3C,YACpD,EACAC,KAAK0C,KACL1C,KAAKsG,SACL,CACI1D,MAAO,GAAKhB,KAAKC,MAAsB,GAAhBD,KAAKD,UAC5BkB,MAAO7C,KAAK2G,YACZ7D,IAAK9C,KAAK8C,IACVrB,KAAMzB,KAAK4G,cAM/B5G,KAAKqG,gBAETrG,KAAK0F,SAtGb,8BAyGI,WACI1F,KAAKqG,cAAgB,QA1G7B,GAAmCd,G,eCEtBuB,EAAb,kDA2BI,WAAYpE,EAAYC,GAAsB,IAAD,8BACzC,gBA3BJD,UA0B6C,IAzB7CC,UAyB6C,IAxB7C7C,EAAI,EA0BA,EAAK4C,KAAOA,EACZ,EAAKC,KAAOA,EACZ,EAAK7C,EAAI,EAAK4C,KAAKmE,QAJsB,EA3BjD,uCAII,WACI,OAAQ7G,KAAK2C,KAAK6C,OACd,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,KAAK,EACL,QACI,OAAO,KAZvB,eAeI,WACI,OAAQxF,KAAK2C,KAAK6C,OACd,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,KAAK,EACL,QACI,OAAO,KAvBvB,gBAiCI,WAAM,IAAD,OACDxF,KAAKF,GAAKE,KAAK4C,MACf5C,KAAK0C,KAAKQ,SAAS6D,aAAa/G,KAAKF,GAAGoB,SAAQ,SAAAN,GAC5CA,EAAMwC,MAAM,EAAKN,QAGjB9C,KAAKF,GAAK,GACVE,KAAK0C,KAAKY,aAAatD,QAxCnC,oBA4CI,SAAOuC,GACHiC,EACI,IAAI5E,EAAM,EAAGI,KAAKF,EAAGE,KAAK0C,KAAK3C,YAC/B,IAAIH,EAAMI,KAAK0C,KAAKc,MAAOxD,KAAKF,EAAGE,KAAK0C,KAAK3C,YAC7CwC,EACAvC,KAAK2C,KAAKqE,OACVhH,KAAK2C,KAAKsE,iBAlDtB,GAA4C3E,GCI/B4E,EAAb,4MACIzB,KAAO,iBADX,EAGI0B,QAII,CACArF,OAAQ,EACRsF,MAAO,KACPC,IAAK,MAVb,yCAYI,WACI,OAAQrH,KAAKwF,OACT,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,QACA,KAAK,EACD,OAAO,KApBvB,kBAuBI,WACI,OAAQxF,KAAKwF,OACT,KAAK,EAEL,KAAK,EACD,MAAO,QACX,QACA,KAAK,EACD,MAAO,WA/BvB,uBAkCI,WACI,OAAQxF,KAAKwF,OACT,KAAK,EACD,MAAO,OACX,KAAK,EACD,MAAO,MACX,QACA,KAAK,EACD,MAAO,SA1CvB,2BA6CI,WACI,OAAQxF,KAAKwF,OACT,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,QACA,KAAK,EACD,OAAO,KArDvB,eAwDI,WACI,OAAQxF,KAAKwF,OACT,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,QACA,KAAK,EACD,OAAO,KAhEvB,gBAoEI,WACI,GAAIxF,KAAKmH,QAAQrF,OAAS9B,KAAKsH,iBAAmBtH,KAAK0C,KAAKQ,SAASpB,OAAS,EAAG,CAG7E,IAFA,IAAIyF,EAAWvH,KAAK0C,KAAKQ,SAASpB,QAAU9B,KAAKsH,gBAAkBtH,KAAKsH,gBAAkBtH,KAAK0C,KAAKQ,SAASpB,OACzGJ,EAAI6F,EAAWvH,KAAKmH,QAAQrF,OACzBJ,EAAI,GAAG,CAGV,GAFY1B,KAAKmH,QAAQC,MAWVpH,KAAKwH,UAAU,CAC1BrF,MAAOnC,KAAK0C,KAAKQ,SAASuE,iBAC1BvF,KAAM,QAGNR,SAbA1B,KAAKwH,UAAU,CACXrF,MAAOnC,KAAK0C,KAAKQ,SAASuE,iBAC1BvF,KAAM,OAEVR,IAYR1B,KAAKmH,QAAQrF,OAASyF,EAG1B,GAAIvH,KAAK0F,KAAO1F,KAAKuG,QAAU,EAAG,CAE9B,IADA,IAAIa,EAAQpH,KAAKmH,QAAQC,MAClBA,GAAO,CACV,GAAIA,EAAMjF,MAAMA,MAAQ,EACLiF,EAAMjF,MAAMiB,MAAMpD,KAAK8C,MAElC9C,KAAKqD,gBAGb+D,EAAQA,EAAMlF,KAGlB,KADAkF,EAAQpH,KAAKmH,QAAQC,OACT,OACZ,GAAIA,EAAMjF,MAAMA,OAAS,EACrBnC,KAAKmH,QAAQrF,OAAS,EACtB9B,KAAKmH,QAAQC,MAAQ,KACrBpH,KAAKmH,QAAQE,IAAM,SAChB,CACH,IAAIK,EAASN,EACbA,EAAQA,EAAMlF,KAGd,IAFA,IAAIJ,EAAS,EAENsF,GAAO,CACV,GAAIA,EAAMjF,MAAMA,OAAS,EAAG,CACxBuF,EAAOxF,KAAO,KACdlC,KAAKmH,QAAQrF,OAASA,EACtB9B,KAAKmH,QAAQE,IAAMK,EACnB,MAEAA,EAASN,EACTA,EAAQA,EAAMlF,KACdJ,MAMhB9B,KAAK0F,SApIb,oBAuII,SAAOnD,EAA+BsD,GAGlC,GAFA,8DAAatD,EAAKsD,GAEb7F,KAAKmH,QAAQC,MAIlB,IAHA,IAAIA,EAA6BpH,KAAKmH,QAAQC,MAC1CjH,EAAKH,KAAKoC,MAAMiD,KAAKrF,KAAKyB,KAAO,EAAG,GAEjC2F,GAAO,CACV,IAAI/G,EAAK+G,EAAMjF,MAAMC,MAAMiD,KAAK+B,EAAMjF,MAAMV,KAAO,EAAG2F,EAAMjF,MAAMV,KAAO,GACzE+C,EAAcrE,EAAIE,EAAIkC,EAAKvC,KAAKgH,OAAQhH,KAAKiH,aAE7C9G,EAAKiH,EAAMjF,MAAMC,MAAMiD,KAAK+B,EAAMjF,MAAMV,KAAO,EAAG2F,EAAMjF,MAAMV,KAAO,GACrE2F,EAAQA,EAAMlF,QAnJ1B,8BAuJI,WACIlC,KAAK0C,KAAK+D,QAAQjF,KAAK,IAAIsF,EAAuB9G,KAAK0C,KAAM1C,SAxJrE,uBA2JI,SAAUoH,GACN,GAAyB,OAArBpH,KAAKmH,QAAQE,IACbrH,KAAKmH,QAAQC,MAAQA,EACrBpH,KAAKmH,QAAQE,IAAMD,EACnBpH,KAAKmH,QAAQrF,aACV,CAGH,IAFA,IAAI6F,EAAS3H,KAAKmH,QAAQC,MAEnBO,GAAQ,CAEX,GAAIP,EAAMjF,QAAUwF,EAAOxF,MACvB,OAAO,EAEXwF,EAASA,EAAOzF,KAEpBlC,KAAKmH,QAAQE,IAAInF,KAAOkF,EACxBpH,KAAKmH,QAAQE,IAAMrH,KAAKmH,QAAQE,IAAInF,KACpClC,KAAKmH,QAAQrF,SAGjB,OAAO,IA/Kf,2BAkLI,SAAc+D,GACV,qEAAoBA,GACpB7F,KAAKmH,QAAU,CACXrF,OAAQ,EACRsF,MAAO,KACPC,IAAK,UAvLjB,GAAmC9B,GCLtBqC,EAAb,kDAeI,WAAYlF,EAAYC,EAAYxC,EAAWE,EAA/C,GAMI,IAAD,EALCuC,EAKD,EALCA,MAAOC,EAKR,EALQA,MAAOgF,EAKf,EALeA,OAKf,qBACC,gBArBJzF,WAoBG,IAnBH0F,gBAmBG,IAlBHC,iBAkBG,IAjBHrF,UAiBG,IAhBHC,UAgBG,IAfHkF,OAAS,EAeN,EAbH5E,IAAM,EAaH,EAZHD,IAAM,EAYH,EAVHJ,MAAQ,GAUL,EATHC,MAAQ,QASL,EARHpB,KAAO,EAWH,EAAKiB,KAAOA,EACZ,EAAKC,KAAOA,EACZ,EAAKmF,WAAa3H,EAClB,EAAKiC,MAAQjC,EAAGkF,KAAK,EAAG,GACxB,EAAK0C,YAAc1H,EACnBuC,IAAU,EAAKA,MAAQA,GACvBC,IAAU,EAAKA,MAAQA,GACvB,EAAKgF,OAASA,EACd,IAAIhD,EAAK,EAAKkD,YAAYjI,EAAI,EAAKgI,WAAWhI,EAC1C8E,EAAK,EAAKmD,YAAYlI,EAAI,EAAKiI,WAAWjI,EAC1CmI,EAAG,SAAI,SAAAnD,EAAI,GAAJ,SAAQD,EAAI,GAAI,IAb5B,OAcC,EAAK3B,IAAM2B,EAAKoD,EAChB,EAAKhF,KAAO6B,EAAKmD,EAflB,EArBP,sCAuCI,WACI,IAAK,IAAItG,EAAI,EAAGA,EAAiB,EAAb1B,KAAK4C,MAAWlB,IAAK,CACrC1B,KAAKoC,MAAMtC,IAAME,KAAKgD,IACtBhD,KAAKoC,MAAMvC,GAAKG,KAAKiD,IAgBrB,IAAIrC,EAAQZ,KAAK0C,KAAKQ,SAASC,iBAAiBnD,KAAKoC,OACrD,GAAIxB,EACeA,EAAMwC,MAAMpD,KAAK6H,SAE5B7H,KAAK2C,KAAKU,iBAIlBrD,KAAKoC,MAAMtC,EAAI,GACZE,KAAKoC,MAAMtC,EAAIE,KAAK0C,KAAKa,QACzBvD,KAAKoC,MAAMvC,EAAI,GACfG,KAAKoC,MAAMvC,EAAIG,KAAK0C,KAAKc,QAC5BxD,KAAK0C,KAAKY,aAAatD,QAtEnC,oBA0EI,SAAOuC,GAAgC,IAAD,EACrBvC,KAAKoC,MAAMhC,WADU,mBAC7BP,EAD6B,KAC1BC,EAD0B,KAElCyC,EAAIkB,YACJlB,EAAImB,OAAO7D,EAAGC,GACdyC,EAAIoB,OAAO9D,EAAe,IAAXG,KAAKiD,IAAWnD,EAAe,IAAXE,KAAKgD,KACxC,IAAIY,EAAOrB,EAAIsB,qBAAqBhE,EAAGC,EAAGD,EAAe,IAAXG,KAAKiD,IAAWnD,EAAe,IAAXE,KAAKgD,KACvEY,EAAKE,aAAa,EAAE9D,KAAK6C,OACzBe,EAAKE,aAAa,EAAE,SACpBvB,EAAIyB,YAAcJ,EAClBrB,EAAIwB,UAAY/D,KAAKyB,KACrBc,EAAI0B,SACJ1B,EAAI2B,YACJ3B,EAAIyB,YAAc,QAClBzB,EAAIwB,UAAY,MAvFxB,GAAkCzB,GCDrB2F,EAAb,4MACIxC,KAAO,cADX,EAEIyC,OAAqB,KAFzB,EAGIL,OAAS,EAHb,EAIIhF,MAAQ,QAJZ,EAKIyD,SAAW,IAAIf,EAAK,EAAK7C,MAL7B,EAOIyF,eAA0B,GAP9B,EAQIC,eAAiB,EARrB,EASIC,iBAAmB,GATvB,yCAWI,WACI,OAAQrI,KAAKwF,OACT,KAAK,EACD,OAAO,EACX,KAAK,EACD,OAAO,EACX,QACA,KAAK,EACD,OAAO,KAnBvB,gBAuBI,WAAM,IAAD,OACD,IAAKxF,KAAKkI,OAAQ,CACd,IAAII,EAAyBtI,KAAK0C,KAAKQ,SAASqF,IAAI,GAOpD,GANAvI,KAAK0C,KAAKQ,SAAShC,SAAQ,SAAAN,KAClB0H,IAAc1H,EAAM4H,UAAY5H,EAAMuB,MAAQmG,EAASnG,SACxDmG,EAAW1H,OAId0H,EACD,OAAO,2DAGXtI,KAAKkI,OAASI,EACdtI,KAAKkI,OAAOM,UAAW,EAE3B,GAAIxI,KAAK0F,KAAO1F,KAAKuG,QAAU,EAAG,OAAO,2DAErCvG,KAAK6H,OAAS7H,KAAKkI,OAAO/F,MAC1BnC,KAAK6H,QAAU,GAEf7H,KAAK0C,KAAK+D,QAAQjF,KAAK,IAAIoG,EACvB5H,KAAK0C,KACL1C,KACAA,KAAKoC,MAAMiD,KAAKrF,KAAKyB,KAAO,EAAG,GAC/BzB,KAAKkI,OAAO9F,MAAMiD,KAAKrF,KAAKkI,OAAOzG,KAAO,EAAGzB,KAAKkI,OAAOzG,KAAO,GAChE,CACIoG,OAAQ7H,KAAK6H,UAGrB7H,KAAK6H,OAAS,EACd7H,KAAKkI,OAAOM,UAAW,EACvBxI,KAAKkI,OAAS,MAGdlI,KAAKoI,cAAgB,IACrBpI,KAAKoI,gBACLpI,KAAKmI,eAAiBnI,KAAKmI,eAAeM,QAAO,SAAAP,GAC7C,OAAOA,EAAO/F,MAAQ,KAGtBnC,KAAKoI,eAAiBpI,KAAKqI,mBAC3BrI,KAAKmI,eAAejH,SAAQ,SAAAgH,GACxB,EAAKxF,KAAK+D,QAAQjF,KAAK,IAAIoG,EACvB,EAAKlF,KACL,EAAK4D,SACL,EAAKlE,MAAMiD,KAAK,EAAK5D,KAAO,EAAG,GAC/ByG,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAGyG,EAAOzG,KAAO,GACjD,CACIoG,OAAQ,EAAKO,oBAIzBpI,KAAKoI,eAAiB,EACtBpI,KAAKmI,eAAiB,KAI9B,6DAjFR,8BAoFI,WAGI,IAHgB,IAAD,OACXzH,EAAM,IAAIC,IACVmB,EAAS9B,KAAK0C,KAAKQ,SAASpB,OACzBpB,EAAIe,MAAQK,EAAS,GAAKA,EAAS,KACtCpB,EAAIa,IAAIvB,KAAK0C,KAAKQ,SAASuE,kBAG/B/G,EAAIQ,SAAQ,SAAAN,GACR,EAAKuH,eAAe3G,KAAKZ,MAG7BZ,KAAKoI,cAAgB,IA/F7B,oBAkGI,SAAO7F,EAA+BsD,GAA8B,IAAD,OAC/D,8DAAatD,EAAKsD,GACd7F,KAAKkI,QACLlI,KAAK0I,aAAanG,EAAKvC,KAAKkI,OAAQ,GAAKlI,KAAKkI,OAAO/F,MAAQnC,KAAK6H,OAAS,EAAI7H,KAAKkI,OAAO/F,MAAQnC,KAAK6H,OAAS,IAErH7H,KAAKmI,eAAejH,SAAQ,SAAAgH,GACxB,EAAKQ,aAAanG,EAAK2F,EAAQ,EAAI,EAAKG,iBAAmB,EAAKD,oBAxG5E,0BA4GI,SAAa7F,EAA+B2F,EAAeS,GACnDT,EAAO/F,OAAS,IACpBI,EAAIyB,YAAc,MAClBzB,EAAIwB,UAAY,EAChBxB,EAAIkB,YACJlB,EAAIqG,IAAJ,MAAArG,EAAG,YACI2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAGyG,EAAOzG,KAAO,GAAGrB,YADxD,QAECuI,EAAQ,EAAG,EAAE/G,KAAK8E,MACtBnE,EAAImB,OAAJ,MAAAnB,EAAG,YAAW2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAGyG,EAAOzG,KAAO,EAAIkH,EAAS,GAAGvI,aAC/EmC,EAAIoB,OAAJ,MAAApB,EAAG,YAAW2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAGyG,EAAOzG,KAAO,EAAIkH,EAAS,GAAGvI,aAC/EmC,EAAImB,OAAJ,MAAAnB,EAAG,YAAW2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAGyG,EAAOzG,KAAO,EAAIkH,EAAS,GAAGvI,aAC/EmC,EAAIoB,OAAJ,MAAApB,EAAG,YAAW2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAGyG,EAAOzG,KAAO,EAAIkH,EAAS,GAAGvI,aAC/EmC,EAAImB,OAAJ,MAAAnB,EAAG,YAAW2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAIkH,EAAS,EAAGT,EAAOzG,KAAO,GAAGrB,aAC/EmC,EAAIoB,OAAJ,MAAApB,EAAG,YAAW2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAIkH,EAAS,EAAGT,EAAOzG,KAAO,GAAGrB,aAC/EmC,EAAImB,OAAJ,MAAAnB,EAAG,YAAW2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAIkH,EAAS,EAAGT,EAAOzG,KAAO,GAAGrB,aAC/EmC,EAAIoB,OAAJ,MAAApB,EAAG,YAAW2F,EAAO9F,MAAMiD,KAAK6C,EAAOzG,KAAO,EAAIkH,EAAS,EAAGT,EAAOzG,KAAO,GAAGrB,aAC/EmC,EAAI0B,SACJ1B,EAAI2B,YACJ3B,EAAIyB,YAAc,QAClBzB,EAAIwB,UAAY,OA/HxB,GAAgCwB,GCAnBsD,EAAb,WAQI,WAAY1G,EAAetC,EAAW6C,GAAa,yBAPnDP,MAAQ,EAO0C,KANlDV,KAAO,GAM2C,KALlDW,WAKkD,OAJlDM,UAIkD,OAFlD8F,UAAW,EAGPxI,KAAKmC,MAAQA,EACbnC,KAAK0C,KAAOA,EACZ1C,KAAKoC,MAAQ,IAAIxC,EAAMC,GAAIG,KAAKyB,KAAMiB,EAAK3C,YAXnD,sCAcI,WACIC,KAAKoC,MAAMtC,GAAK,KAfxB,mBAkBI,SAAMgJ,GASF,OARIA,GACA9I,KAAK0C,KAAKqG,OAAS/I,KAAKmC,MAAQ2G,EAAI9I,KAAKmC,MAAQ2G,EACjD9I,KAAKmC,OAAS2G,IAEd9I,KAAKmC,QACLnC,KAAK0C,KAAKqG,SAGV/I,KAAKmC,OAAS,IACdnC,KAAK0C,KAAKsG,YAAYhJ,OACf,KA7BnB,oBAkCI,SAAOuC,GAAgC,IAAD,EACrBvC,KAAKoC,MAAMhC,WADU,mBAC7BP,EAD6B,KAC1BC,EAD0B,KAElCqE,EAActE,EAAGC,EAAGE,KAAKyB,KAAMzB,KAAKyB,KAAM,EAAGc,GAC7CA,EAAIyD,UAAY,SAChBzD,EAAI0D,SAAJ,UAAgBjG,KAAKmC,OAAStC,EAAIG,KAAKyB,KAAO,EAAG3B,EAAI,QAtC7D,KCAamJ,EAAb,WAQI,WAAYvG,GAAa,yBAPzBA,UAOwB,OANxBwG,WAAa,GAMW,KAJxBC,WAAa,IAIW,KAFxBpG,OAAQ,EAGJ/C,KAAK0C,KAAOA,EATpB,+CAYI,WAEI,IAFW,IAAD,EACN1B,EAAe,GACVU,EAAI,EAAGA,EAAI,GAAIA,IACpBV,EAAIQ,KAAK,IAAIqH,EAAMjH,KAAKwH,KAAKpJ,KAAK0C,KAAKgD,KAAK,IAAI9D,KAAKD,SAAW,GAAI,GAAKD,EAAI,GAAI1B,KAAK0C,QAE1F,EAAA1C,KAAK0C,KAAKQ,UAAS1B,KAAnB,QAA2BR,KAjBnC,gBAoBI,WAC4B,IAApBhB,KAAKkJ,WAILlJ,KAAK0C,KAAKgD,KAAO1F,KAAK0C,KAAK6D,QAAU,IACrCvG,KAAKqJ,cACLrJ,KAAKkJ,cALLlJ,KAAK+C,OAAQ,IAtBzB,mBA+BI,cA/BJ,0BAmCI,SAAaR,GACTA,EAAIkB,YACJlB,EAAI+G,KAAO,2BACX/G,EAAIuD,UAAY,OAChBvD,EAAIyD,UAAY,SAChBzD,EAAI0D,SAAJ,gBAAsBjG,KAAK0C,KAAK6G,YAAc,GAAKvJ,KAAK0C,KAAKc,MAAQ,EAAGxD,KAAK0C,KAAKa,OAAS,KAC3FhB,EAAI+G,KAAO,aACX/G,EAAIuD,UAAY,QAChBvD,EAAI2B,gBA3CZ,KCQMsF,EAAW,wCAAwCC,KAAKC,OAAOC,UAAUC,WACzEC,EAAe,SAACnH,GAClB,MAAO,CACH,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,GACX,IAAIuG,EAAOvG,KAINoH,EAAb,WAwFI,aAAe,yBAvFf/J,WAAa,IAAIO,EAAW,EAAG,GAuFjB,KApFd4C,SAAW,IAAI3C,EAoFD,KAlFdwJ,cAII,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MA8EvC,KA7EdC,aAII,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAyEvC,KAvEdvD,QAAoB,GAuEN,KArEdjD,MAAQ,IAqEM,KApEdD,OAA8B,IAArBmG,OAAOO,YAAoBP,OAAOQ,WAoE7B,KAnEdC,SAAW,IAAMT,OAAOQ,WAmEV,KAjEdrD,QAAU7G,KAAKuD,OAAS,IAiEV,KAhEd6G,eAAiBpK,KAAKD,WAAWqC,MAAM,EAAGpC,KAAK6G,SAgEjC,KA/DdwD,gBAAkBrK,KAAKD,WAAWqC,MAAMpC,KAAKwD,MAAOxD,KAAK6G,SA+D3C,KA7DdyD,cAAgBtK,KAAKuD,OAAS,GA6DhB,KA5DdgH,aAAevK,KAAKuD,OAAS,IA4Df,KA1DdiH,YAAc,CACV,IAAI5K,EAAM,GAAII,KAAKsK,cAAetK,KAAKD,YACvC,IAAIH,EAAM,GAAII,KAAKsK,cAAetK,KAAKD,YACvC,IAAIH,EAAM,IAAKI,KAAKsK,cAAetK,KAAKD,YACxC,IAAIH,EAAM,IAAKI,KAAKsK,cAAetK,KAAKD,YACxC,IAAIH,EAAM,IAAKI,KAAKsK,cAAetK,KAAKD,YACxC,IAAIH,EAAM,IAAKI,KAAKsK,cAAetK,KAAKD,YACxC,IAAIH,EAAM,IAAKI,KAAKsK,cAAetK,KAAKD,YACxC,IAAIH,EAAM,IAAKI,KAAKsK,cAAetK,KAAKD,YACxC,IAAIH,EAAM,IAAKI,KAAKsK,cAAetK,KAAKD,YAExC,IAAIH,EAAM,GAAII,KAAKuK,aAAcvK,KAAKD,YACtC,IAAIH,EAAM,GAAII,KAAKuK,aAAcvK,KAAKD,YACtC,IAAIH,EAAM,IAAKI,KAAKuK,aAAcvK,KAAKD,YACvC,IAAIH,EAAM,IAAKI,KAAKuK,aAAcvK,KAAKD,YACvC,IAAIH,EAAM,IAAKI,KAAKuK,aAAcvK,KAAKD,YACvC,IAAIH,EAAM,IAAKI,KAAKuK,aAAcvK,KAAKD,YACvC,IAAIH,EAAM,IAAKI,KAAKuK,aAAcvK,KAAKD,YACvC,IAAIH,EAAM,IAAKI,KAAKuK,aAAcvK,KAAKD,YACvC,IAAIH,EAAM,IAAKI,KAAKuK,aAAcvK,KAAKD,aAuC7B,KApCdwG,MAAQ,GAoCM,KAnCdb,KAAO,EAmCO,KAlCd+E,OAA+D,KAkCjD,KAjCdC,SAAiF,KAiCnE,KA/BdC,EAAI,IA+BU,KA9Bd5B,MAAQ,EA8BM,KA5Bd6B,GAAK,IA4BS,KA3BdC,SAAW,IA2BG,KA1Bd5I,OAA0B,MA0BZ,KAzBN6I,OAAkC,WAyB5B,KAddvB,YAAc,EAcA,KAbdwB,MAAQlB,EAAa7J,MAaP,KAXdgL,kBAAmB,EAWL,KATdC,aAAc,EASA,KARdC,gBAA+B,KAQjB,KAPdC,oBAAoC,MAOtB,KANdC,qBAA0C,EAM5B,KALdC,wBAA4C,CAAC,EAAG,GAKlC,KAJdC,sBAA0C,CAAC,EAAG,GAIhC,KAFdC,OAAmC,KAG/BvL,KAAKwL,gBAAkBxL,KAAKwL,gBAAgBC,KAAKzL,MACjDA,KAAK0L,gBAAkB1L,KAAK0L,gBAAgBD,KAAKzL,MA1FzD,uCAgEI,WACI,OAAOA,KAAK8K,QAjEpB,IAmEI,SAAUa,GACN3L,KAAK8K,OAASa,EACV3L,KAAK0K,UAAU1K,KAAK0K,SAASiB,GAChB,aAAbA,GACA3L,KAAK4L,eAvEjB,qBA6FI,WAEI5L,KAAKkD,SAAS2I,QACd7L,KAAK+J,cAAgB,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MACtE/J,KAAKgK,aAAe,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MACrEhK,KAAKyG,QAAU,GACfzG,KAAK0F,KAAO,EACZ1F,KAAK2K,EAAI,IACT3K,KAAK+I,MAAQ,EACb/I,KAAK4K,GAAK,IAEV5K,KAAKuJ,YAAc,EACnBvJ,KAAK8L,MAAQ,WACb9L,KAAK+K,MAAQlB,EAAa7J,MAC1BA,KAAK+L,WA3Gb,0BA8GI,SAAaC,GACThM,KAAKyG,QAAUzG,KAAKyG,QAAQgC,QAAO,SAAAwD,GAC/B,OAAOA,IAAYD,OAhH/B,yBAoHI,SAAYpL,GACRZ,KAAKkD,SAAS8F,YAAYpI,GAC1BZ,KAAK2K,MAtHb,qBAyHI,SAAQlF,GACJ,OAAQA,GACJ,IAAK,YACD,GAAIzF,KAAK2K,EAAI,IAAK,OAAO,EACzB3K,KAAK2K,GAAK,IACV3K,KAAKkM,gBAAgB,IAAIhF,EAAclH,OACvC,MACJ,IAAK,SACD,GAAIA,KAAK2K,EAAI,IAAK,OAAO,EACzB3K,KAAK2K,GAAK,IACV3K,KAAKkM,gBAAgB,IAAIjE,EAAWjI,OACpC,MACJ,IAAK,YACL,QACI,GAAIA,KAAK2K,EAAI,IAAK,OAAO,EACzB3K,KAAK2K,GAAK,IACV3K,KAAKkM,gBAAgB,IAAI9F,EAAcpG,OAI/C,OADAA,KAAK+L,UACE,IA7If,gBAgJI,WAAe,IAAD,OA0BV,OAzBA/L,KAAK+K,MAAM/K,KAAKuJ,aAAa4C,KAE7BnM,KAAKkD,SAAShC,SAAQ,SAAAN,GAClBA,EAAMuL,KACFvL,EAAMwB,MAAMtC,GAAK,EAAK+G,QAAUjG,EAAMa,OACtC,EAAKuH,YAAYpI,GACjB,EAAKgK,IAAMhK,EAAMuB,MAAQ,EAAKyI,GAAK,EAAKA,GAAKhK,EAAMuB,UAI3DnC,KAAKgK,aAAa9I,SAAQ,SAAAyB,GAClB,OAAJA,QAAI,IAAJA,KAAMwJ,QAGVnM,KAAKyG,QAAQvF,SAAQ,SAAA8K,GACjBA,EAAOG,QAGPnM,KAAK6K,SAAW7K,KAAK4K,GACrB5K,KAAK6K,WACE7K,KAAK6K,SAAW7K,KAAK4K,IAC5B5K,KAAK6K,WAGT7K,KAAK0F,OACE1F,KAAK4K,IAAM,IA1K1B,wBA6KI,WAAc,IAAD,OACL7H,EAAQ/C,KAAKmM,KAGjB,OADAnM,KAAK+L,SACDhJ,GACA/C,KAAKoM,UAAU,cACfpM,KAAK+L,UAIL/L,KAAK+K,MAAM/K,KAAKuJ,aAAaxG,OACF,IAAxB/C,KAAKyG,QAAQ3E,QACY,IAAzB9B,KAAKkD,SAASpB,QACd9B,KAAK6K,WAAa7K,KAAK4K,IAC1B5K,KAAK8L,MAAQ,WACb9L,KAAKuJ,cAEDvJ,KAAKuJ,cAAgBvJ,KAAK+K,MAAMjJ,QAChC9B,KAAKoM,UAAU,YACfpM,KAAK+L,WAIT/L,KAAK+K,MAAM/K,KAAKuJ,aAAa8C,aAC7BrM,KAAK+L,gBAGTO,uBAAsB,WAClB,EAAKV,kBAzMjB,wBA6MI,WACQ5L,KAAKgL,kBACThL,KAAKuM,eA/Mb,wBAkNI,WAAc,IAAD,OACTvM,KAAK+L,SAEA/L,KAAKgL,kBAGVsB,uBAAsB,WAClB,EAAKC,kBAzNjB,oBA6NI,WAAU,IAAD,EACL,GAAKvM,KAAKuL,OAAV,CACA,IAAMhJ,EAAMvC,KAAKuL,OAAOiB,WAAW,MAEnC,GAAKjK,EAAL,CAEAA,EAAIkK,UAAU,EAAG,EAAGzM,KAAKuL,OAAO/H,MAAOxD,KAAKuL,OAAOhI,QACnDhB,EAAImK,WAAJ,MAAAnK,EAAG,YAAevC,KAAKD,WAAWE,QAA/B,QAAuCD,KAAKwD,MAAOxD,KAAKuD,UAE3D,UAAAvD,KAAK+K,MAAM/K,KAAKuJ,oBAAhB,SAA8BoD,aAAapK,GAE3CA,EAAIkB,YACJlB,EAAIyB,YAAc,OAClBhE,KAAKwK,YAAYtJ,SAAQ,SAAA0L,GACrBzI,EAAa,WAAb,cAAiByI,EAAIvH,KAAK,EAAG,GAAGjF,YAAhC,QAA4C,GAAI,GAAI,EAAGmC,QAE3DA,EAAIyB,YAAc,QAClBzB,EAAI2B,YAEJlE,KAAKkD,SAAShC,SAAQ,SAAAN,GAClBA,EAAMmL,OAAOxJ,MAIjBA,EAAIkB,YACJlB,EAAIuD,UAAY,QAChBvD,EAAIsK,SAAS,EAAG7M,KAAK6G,QAAU,GAAI7G,KAAKwD,MAAQ,EAAG,IACnDjB,EAAIuD,UAAY,YAChBvD,EAAIsK,SAAS,EAAG7M,KAAK6G,QAAU,GAAI7G,KAAKwD,MAAQ,EAAG,IACnDjB,EAAIuD,UAAY,aAChBvD,EAAIyB,YAAc,QAClB,IAAM8I,EAAgB9M,KAAK6K,SAAW,KAAQ7K,KAAKwD,MAAQ,GAC3DjB,EAAIsK,SAAS7M,KAAKwD,MAAQsJ,EAAgB,EAAG9M,KAAK6G,QAAU,GAAIiG,EAAe,IAC/EvK,EAAIuD,UAAY,UAChB,IAAMiH,EAAU/M,KAAK4K,GAAK,KAAQ5K,KAAKwD,MAAQ,GAC/CjB,EAAIsK,SAAS7M,KAAKwD,MAAQuJ,EAAU,EAAG/M,KAAK6G,QAAU,GAAIkG,EAAS,IACnExK,EAAI2B,YACJ3B,EAAIuD,UAAY,QAChBvD,EAAIyB,YAAc,QAElBzB,EAAIkB,YACJzD,KAAK+J,cAAc7I,SAAQ,SAAAyB,GACnB,OAAJA,QAAI,IAAJA,KAAMoJ,OAAOxJ,MAGjBvC,KAAKgK,aAAa9I,SAAQ,SAAAyB,GAClB,OAAJA,QAAI,IAAJA,KAAMoJ,OAAOxJ,MAEjBA,EAAI2B,YAEJ3B,EAAIkB,YACJlB,EAAImB,OAAJ,MAAAnB,EAAG,YAAWvC,KAAKoK,eAAe/E,KAAK,GAAI,IAAIjF,aAC/CmC,EAAIoB,OAAJ,MAAApB,EAAG,YAAWvC,KAAKqK,gBAAgBhF,KAAK,GAAI,IAAIjF,aAChDmC,EAAI0B,SACJ1B,EAAI2B,YAEJ3B,EAAIkB,YACJzD,KAAKyG,QAAQvF,SAAQ,SAAA8K,GACjBA,EAAOD,OAAOxJ,MAElBA,EAAI2B,YAEAlE,KAAKkL,kBACLlL,KAAKkL,gBAAgBa,OAAOxJ,EAAK,CAC7BvC,KAAKqL,wBAAwB,GAAKrL,KAAKsL,sBAAsB,GAC7DtL,KAAKqL,wBAAwB,GAAKrL,KAAKsL,sBAAsB,KAE7D9B,IACAjH,EAAIyK,aAAazK,EAAI0K,aACjB,EAAGjN,KAAK6G,QAAS7G,KAAKwD,MAAO,KAC9B,EAAGxD,KAAK6G,QAAU,KAErBtE,EAAI2K,KAAK,EAAGlN,KAAK6G,QAAU,IAAK7G,KAAKwD,MAAO,KAC5CjB,EAAI0B,WAIZ1B,EAAIkB,YACJlB,EAAI+G,KAAO,kBACX/G,EAAIuD,UAAY,MAChBvD,EAAIyD,UAAY,QAChBzD,EAAI0D,SAAJ,YAAkBjG,KAAK2K,GAAK,IAAK,IACjCpI,EAAI+G,KAAO,aACX/G,EAAIuD,UAAY,QAChBvD,EAAI2B,YAEJ3B,EAAIkB,YACJlB,EAAI+G,KAAO,kBACX/G,EAAIuD,UAAY,MAChBvD,EAAIyD,UAAY,OAChBzD,EAAI0D,SAAJ,gBAAsBjG,KAAK+I,OAAS,GAAI,IACxCxG,EAAI+G,KAAO,aACX/G,EAAIuD,UAAY,QAChBvD,EAAI2B,YAEJ3B,EAAIkB,YACJlB,EAAI+G,KAAO,aACX/G,EAAIuD,UAAY,QAChBvD,EAAIyD,UAAY,SAChBzD,EAAI0D,SAAJ,gBAAsBjG,KAAKuJ,YAAc,EAAzC,cAAgDvJ,KAAK+K,MAAMjJ,QAAU9B,KAAKwD,MAAQ,EAAG,IACrFjB,EAAI+G,KAAO,aACX/G,EAAIuD,UAAY,QAChBvD,EAAI2B,gBAnUZ,uBAsUI,SAAUiJ,GACNnN,KAAKiC,OAASkL,EACdnN,KAAKyK,QAAUzK,KAAKyK,QAAO,KAxUnC,6BA2UI,SAAgB9H,EAAmBkD,GAU/B,QATiBuH,IAAbvH,GACA7F,KAAK+J,cAAc3I,MAAK,SAACuB,EAAM0K,GAC3B,OAAa,OAAT1K,IACAkD,EAAWwH,GACJ,WAKFD,IAAbvH,IACJ7F,KAAK+J,cAAclE,GAAYlD,EAC3BA,GAAM,CAKN,GAJAA,EAAKP,MAAMtC,EAAIE,KAAKsK,cACpB3H,EAAKP,MAAMvC,EAAI,GAAgB,GAAXgG,EACpBlD,EAAK2K,cAAczH,GAEflD,EAAK6C,OAAS,EAAG,OAErB,IAAI+H,EAA8B,GAClCvN,KAAK+J,cAAc7I,SAAQ,SAACsM,EAAO9L,IACtB,OAAL8L,QAAK,IAALA,OAAA,EAAAA,EAAO/H,QAAS9C,EAAK8C,MAAQ9C,EAAK6C,QAAUgI,EAAMhI,OAClD+H,EAAK/L,KAAKE,MAId6L,EAAKzL,QAAU,IACf9B,KAAKkM,gBAAgB,KAAMqB,EAAK,IAChCvN,KAAKkM,gBAAgB,KAAMqB,EAAK,IAC/BvN,KAAK+J,cAAcwD,EAAK,IAAa/H,OAAS,EAC/CxF,KAAKkM,gBAAgBlM,KAAK+J,cAAcwD,EAAK,IAAKA,EAAK,QAzWvE,4BA8WI,SAAe5K,EAAmBkD,GAU9B,QATiBuH,IAAbvH,GACA7F,KAAKgK,aAAa5I,MAAK,SAACuB,EAAM0K,GAC1B,OAAa,OAAT1K,IACAkD,EAAWwH,GACJ,WAKFD,IAAbvH,IACJ7F,KAAKgK,aAAanE,GAAYlD,EAC1BA,GAAM,CAIN,GAHAA,EAAKP,MAAMtC,EAAIE,KAAKuK,aACpB5H,EAAKP,MAAMvC,EAAI,GAAgB,GAAXgG,EAEhBlD,EAAK6C,OAAS,EAAG,OAErB,IAAI+H,EAA8B,GAClCvN,KAAKgK,aAAa9I,SAAQ,SAACsM,EAAO9L,IACrB,OAAL8L,QAAK,IAALA,OAAA,EAAAA,EAAO/H,QAAS9C,EAAK8C,MAAQ9C,EAAK6C,QAAUgI,EAAMhI,OAClD+H,EAAK/L,KAAKE,MAId6L,EAAKzL,QAAU,IACf9B,KAAKyN,eAAe,KAAMF,EAAK,IAC/BvN,KAAKyN,eAAe,KAAMF,EAAK,IAC9BvN,KAAKgK,aAAauD,EAAK,IAAa/H,OAAS,EAC9CxF,KAAKyN,eAAezN,KAAKgK,aAAauD,EAAK,IAAKA,EAAK,QA3YrE,mCAgZI,SAAsBG,GAClB,GAAmB,aAAf1N,KAAK8L,MAIT,OAHA9L,KAAKiL,aAAc,EAEEjL,KAAK2N,SAAS3N,KAAK+J,cAAe2D,EAAEE,QAASF,EAAEG,QAAS,QAOzD7N,KAAK2N,SAAS3N,KAAKgK,aAAc0D,EAAEE,QAASF,EAAEG,QAAS,OALvEnE,OAAOoE,iBAAiB,YAAa9N,KAAKwL,iBAC1CxL,KAAKgL,kBAAmB,OACxBhL,KAAKuM,mBAIT,IA5ZR,8BAoaI,SAAiBmB,GACb,GAAmB,aAAf1N,KAAK8L,MAMT,OALA4B,EAAEK,kBACFL,EAAEM,iBACFhO,KAAKiL,aAAc,EAEEjL,KAAK2N,SAAS3N,KAAK+J,cAAe2D,EAAEO,QAAQ,GAAGL,QAASF,EAAEO,QAAQ,GAAGJ,QAAS,QAO/E7N,KAAK2N,SAAS3N,KAAKgK,aAAc0D,EAAEO,QAAQ,GAAGL,QAASF,EAAEO,QAAQ,GAAGJ,QAAS,OAL7FnE,OAAOoE,iBAAiB,YAAa9N,KAAK0L,gBAAiB,CAAEwC,SAAS,IACtElO,KAAKgL,kBAAmB,OACxBhL,KAAKuM,mBAIT,IAlbR,sBA0bI,SAAS4B,EAAsBP,EAAiBC,EAAiBpI,GAA4B,IAAD,OACpF2I,EAAYD,EAAME,WAAU,SAAA1L,GAC5B,IAAKA,EAAM,OAAO,EAElB,IAAI2L,EAAS3L,EAAK4L,UAAUX,EAAU,EAAKzD,SAAU0D,EAAU,EAAK1D,UACpE,GAAImE,EAAQ,CACR,IAAIlJ,EAAIzC,EAAKP,MAAMhC,WACnB,EAAKkL,sBAAwB,CACzBlG,EAAE,GAAKwI,EAAU,EAAKzD,SACtB/E,EAAE,GAAKyI,EAAU,EAAK1D,UAG9B,OAAOmE,KAGX,OAAmB,IAAfF,IACApO,KAAKkL,gBAAkBiD,EAAMC,GAC7BpO,KAAKmL,oBAAsB1F,EAC3BzF,KAAKoL,qBAAuBgD,EAC5BpO,KAAKqL,wBAA0B,CAACuC,EAAU5N,KAAKmK,SAAU0D,EAAU7N,KAAKmK,WACjE,KA9cnB,2BAmdI,SAAcuD,GACVhE,OAAO8E,oBAAoB,YAAaxO,KAAKwL,iBAC7CxL,KAAKyO,eAAef,EAAEE,QAASF,EAAEG,WArdzC,4BAwdI,SAAeH,GACXhE,OAAO8E,oBAAoB,YAAaxO,KAAK0L,iBAC7C1L,KAAKyO,eAAef,EAAEgB,eAAe,GAAGd,QAASF,EAAEgB,eAAe,GAAGb,WA1d7E,4BA6dI,SAAeD,EAAiBC,GAC5B,IAAIc,EAAS,CAACf,EAAU5N,KAAKmK,SAAWnK,KAAKsL,sBAAsB,GAAIuC,EAAU7N,KAAKmK,SAAWnK,KAAKsL,sBAAsB,IACxHsD,EAAY,CAACD,EAAO,GAAK,GAAIA,EAAO,GAAK,IAEzC/B,EAAM5M,KAAKwK,YAAY6D,WAAU,SAAAzB,GACjC,IAAI1M,EAAI0M,EAAIxM,WAEZ,OAAOuO,EAAO,GAAKzO,EAAE,GAAK,IAAMyO,EAAO,GAAKzO,EAAE,GAAK,IAC5C0O,EAAU,GAAK1O,EAAE,GAAK,IAAM0O,EAAU,GAAK1O,EAAE,GAAK,MAG7D,IAAa,IAAT0M,GAAc5M,KAAKkL,gBACnB,GAA4B,IAAxBtJ,KAAKC,MAAM+K,EAAM,GAAU,CAC3B,IAAIiC,EAAUjC,EAAM,EAChBkC,EAAO9O,KAAK+J,cAAc8E,GAC9B7O,KAAK+J,cAAc8E,GAAW,KACG,OAA7B7O,KAAKmL,oBACLnL,KAAKgK,aAAahK,KAAKoL,sBAAwB,KAE/CpL,KAAK+J,cAAc/J,KAAKoL,sBAAwB,KAEpDpL,KAAKkM,gBAAgBlM,KAAKkL,gBAAiB2D,GACV,OAA7B7O,KAAKmL,oBACLnL,KAAKyN,eAAeqB,EAAM9O,KAAKoL,sBAE/BpL,KAAKkM,gBAAgB4C,EAAM9O,KAAKoL,0BAEjC,CACH,IAAIyD,EAAUjC,EAAM,EAChBkC,EAAO9O,KAAKgK,aAAa6E,GAC7B7O,KAAKgK,aAAa6E,GAAW,KACI,OAA7B7O,KAAKmL,oBACLnL,KAAKgK,aAAahK,KAAKoL,sBAAwB,KAE/CpL,KAAK+J,cAAc/J,KAAKoL,sBAAwB,KAEpDpL,KAAKyN,eAAezN,KAAKkL,gBAAiB2D,GACT,OAA7B7O,KAAKmL,oBACLnL,KAAKyN,eAAeqB,EAAM9O,KAAKoL,sBAE/BpL,KAAKkM,gBAAgB4C,EAAM9O,KAAKoL,sBAK5CpL,KAAKiL,aAAc,EACnBjL,KAAKkL,gBAAkB,KACvBlL,KAAKgL,kBAAmB,IA5gBhC,6BA+gBI,SAAgB0C,GACZ1N,KAAK+O,WAAWrB,EAAEE,QAASF,EAAEG,WAhhBrC,6BAmhBI,SAAgBH,GACZA,EAAEM,iBACFN,EAAEK,kBACF/N,KAAK+O,WAAWrB,EAAEgB,eAAe,GAAGd,QAASF,EAAEgB,eAAe,GAAGb,WAthBzE,wBAyhBI,SAAWD,EAAiBC,GACxB7N,KAAKqL,wBAA0B,CAACuC,EAAU5N,KAAKmK,SAAU0D,EAAU7N,KAAKmK,cA1hBhF,K,uBC3BMzH,EAAO,IAAIoH,EAEXkF,EAAY,CACdvJ,KAAM,iBACNwJ,KAAM,eACNC,MAAO,KAGLC,EAAY,CACd1J,KAAM,iBACNwJ,KAAM,eACNC,MAAO,KAGLE,EAAS,CACX3J,KAAM,cACNwJ,KAAM,qBACNC,MAAO,KAGLG,EAAgB,WAClB,IAAI/K,EAAI1C,KAAKD,SAEb,OAAI2C,EAAI,IACG0K,EACA1K,EAAI,IACJ6K,EAEAC,GAITE,EAAoB,WACtB,MAAO,CACHD,IACAA,IACAA,IACAA,IACAA,MA8GOE,EA1GH,WACR,IAAMC,EAAYC,iBAA0B,MAD9B,EAEQC,oBAAS,GAFjB,mBAEPrI,EAFO,KAEFoD,EAFE,OAGsBiF,oBAAS,GAH/B,mBAGPC,EAHO,KAGKC,EAHL,OAIwBF,mBAASJ,KAJjC,mBAIPO,EAJO,KAIMC,EAJN,OAK4BJ,oBAAS,GALrC,mBAKPK,EALO,KAKQC,EALR,OAMYN,mBAAkC,YAN9C,mBAMP5D,EANO,KAMApB,EANA,KA6Cd,OArCAuF,qBAAU,WACDT,EAAUU,UACfV,EAAUU,QAAQ1M,MAAQd,EAAKc,MAC/BgM,EAAUU,QAAQ3M,OAASb,EAAKa,UACjC,CAACiM,IAEJS,qBAAU,WACNvN,EAAK+H,OAASA,IACf,CAACpD,IAEJ4I,qBAAU,WACNvN,EAAKgI,SAAWA,IACjB,CAACoB,IAEJmE,qBAAU,WACNvN,EAAK6I,OAASiE,EAAUU,QACxBxN,EAAKqJ,WACN,CAACyD,IAEJS,qBAAU,WACN,IAAME,EAAUzN,EAAK0N,cAAc3E,KAAK/I,GAClC2N,EAAkB3N,EAAK4N,eAAe7E,KAAK/I,GAGjD,OAFAgH,OAAOoE,iBAAiB,UAAWqC,GACnCzG,OAAOoE,iBAAiB,WAAYuC,GAC7B,WACH3G,OAAO8E,oBAAoB,UAAW2B,GACtCzG,OAAO8E,oBAAoB,WAAY6B,MAE5C,IASI,qCACH,wBAAQE,IAAKf,EAAWgB,UAAWC,IAAElF,OACjCmF,QAAS,WACLd,GAAc,GACdI,GAAiB,IAErBW,aAAcjO,EAAKkO,iBAAiBnF,KAAK/I,GACzCmO,YAAanO,EAAKoO,sBAAsBrF,KAAK/I,KACjD,sBAAK8N,UAAWC,IAAEM,KAAlB,UACI,gCACI,wBAAQP,UAAWC,IAAEO,QAASN,QAAS,WACnCd,GAAeD,GACfK,GAAiB,IAFrB,0BAICL,GAAc,sBAAKa,UAAWC,IAAEQ,QAAlB,UACX,oBAAIT,UAAWC,IAAES,SAAjB,SACKrB,EAAY/O,KAAI,SAACZ,EAAGwB,GAAJ,OAAU,qBAAI8O,UAAWC,IAAEU,SAAkBT,QAAS,WACnE,IAAIU,GAAa,EACjB,OAAQlR,EAAEuF,MACN,IAAK,iBACD2L,EAAa1O,EAAK2O,QAAQ,aAC1B,MACJ,IAAK,cACDD,EAAa1O,EAAK2O,QAAQ,UAC1B,MACJ,IAAK,iBACL,QACID,EAAa1O,EAAK2O,QAAQ,aAG7BD,GAILxB,GAAc,GACdE,EAAeR,KACfU,GAAiB,IALbA,GAAiB,IAfE,UAsBtB9P,EAAE+O,KACH,sBAAKuB,UAAWC,IAAEa,cAAlB,cACMpR,EAAEgP,WAxB+CxN,QA4B9DqO,GAAiB,qBAAKS,UAAWC,IAAEc,UAAlB,0EAK1B,sBAAKf,UAAW,CAACC,IAAEe,WAAYnK,EAAMoJ,IAAEpJ,IAAM,IAAIoK,KAAK,KAAtD,UACqB,QAAhB/O,EAAKT,OAAmB,2BAAS,YAClC,wBAAQyO,QA1DpB,WACIhO,EAAKgP,UACLjH,GAAO,GACP/H,EAAK6I,OAASiE,EAAUU,SAuDUM,UAAWC,IAAEkB,WAAvC,wBAEJ,8BACe,aAAV7F,GAAwB,wBAAQ0E,UAAWC,IAAEmB,cAAelB,QAAS,WAClEhO,EAAKoJ,MAAQ,YADQ,+CCnI1B+F,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,6BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCHdQ,IAASvG,OACP,cAAC,IAAMwG,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1BZ,K,kBCfAa,EAAOC,QAAU,CAAC,OAAS,oBAAoB,KAAO,kBAAkB,WAAa,wBAAwB,IAAM,iBAAiB,WAAa,wBAAwB,QAAU,qBAAqB,QAAU,qBAAqB,SAAW,sBAAsB,SAAW,sBAAsB,cAAgB,2BAA2B,UAAY,uBAAuB,cAAgB,8B","file":"static/js/main.a409e5e2.chunk.js","sourcesContent":["import { Coordinate } from \"./Coordinate\";\n\nexport class Point {\n    x = 0;\n    y = 0;\n    coordinate: Coordinate;\n\n    constructor(x: number, y: number, coordinate: Coordinate) {\n        this.x = x;\n        this.y = y;\n        this.coordinate = coordinate;\n    }\n\n    toNumber(): [number, number] {\n        return [this.x + this.coordinate.origin[0], this.y + this.coordinate.origin[1]];\n    }\n\n    plus(x: number, y: number) {\n        return new Point(this.x + x, this.y + y, this.coordinate);\n    }\n\n    lengthTo(p: Point): number {\n        let p1 = this.toNumber();\n        let p2 = p.toNumber();\n\n        return ((p1[0] - p2[0])**2 + (p1[1] - p2[1])**2)**0.5;\n    }\n}\n","import { Point } from \"./Point\";\n\nexport class Coordinate {\n    origin: [number, number] = [0, 0];\n\n    constructor(x: number, y: number) {\n        this.origin = [x, y];\n    }\n\n    resetOrigin(origin: Point) {\n        this.origin = origin.toNumber();\n    }\n\n    point(x: number, y: number): Point {\n        return new Point(x, y, this);\n    }\n\n    toPoint(x: number, y: number): Point {\n        return new Point(x - this.origin[0], y - this.origin[1], this);\n    }\n}","import { Point } from \"../Point\";\nimport { Enemy } from \"./Enemy\";\n\nexport class EnemySet {\n    array: (Enemy|null)[] = [];\n    matrix: (Enemy|null)[][] = [];\n    set: Set<Enemy> = new Set();\n\n    reset() {\n        this.array = [];\n        this.matrix = [];\n        this.set = new Set<Enemy>();\n    }\n\n    removeEnemy(enemy: Enemy) {\n        this.set.delete(enemy);\n        this.array = this.array.map(_enemy => {\n            if (_enemy === enemy) return null;\n            return _enemy;\n        });\n        this.matrix = this.matrix.map(row => {\n            return row.map(_enemy => {\n                if (_enemy === enemy) return null;\n                return _enemy;\n            })\n        });\n    }\n\n    forEach(callbackfn: (value: Enemy, value2: Enemy, set: Set<Enemy>) => void) {\n        this.set.forEach(callbackfn);\n    }\n\n    some(predicate: (value: Enemy | null, index: number, array: (Enemy | null)[]) => unknown): boolean {\n        return this.array.some(predicate);\n    }\n\n    push(...items: Enemy[]) {\n        items.forEach(item => this.set.add(item));\n        this.matrix.push(items);\n        return this.array.push(...items);\n    }\n\n    get length(): number {\n        return this.set.size;\n    }\n\n    get(i: number): Enemy | null {\n        return this.array[i];\n    }\n\n    getRandomEnemy(): Enemy {\n        let i = 0;\n        let random = Math.floor(Math.random() * this.length);\n        let k = this.set.keys();\n        let result: Enemy = k.next().value;\n        while (i !== random) {\n            result = k.next().value;\n            i++;\n        }\n        return result;\n    }\n\n    findEnemyByPoint(point: Point): Enemy | null {\n        // 30 * i + 10 - 2\n        // 30 * i + 10 + enemySize (20) + 2\n        // Math.floor((point.x - 10) / 30)\n        if ((point.x - 8) % 30 > 24) return null;\n        let i = Math.floor((point.x - 10) / 30);\n        if (i < 0 || i > 14) return null;\n        let result: Enemy | null = null;\n        this.matrix.some(row => {\n            let enemy = row[i];\n            if (!enemy) return false;\n            if (enemy.point.y + enemy.size + 2 < point.y) {\n                return true;\n            } else if (enemy.point.y - 2 <= point.y) {\n                result = enemy;\n                return true;\n            }\n            return false;\n        });\n        return result;\n    }\n\n    findEnemyByY(y: number): Enemy[] {\n        let result: Enemy[] = [];\n        this.matrix.some(row => {\n            let res = false;\n            row.some(enemy => {\n                if (!enemy) return false;\n                if (enemy.point.y + enemy.size < y) {\n                    return true;\n                } else if (enemy.point.y <= y) {\n                    result.push(enemy);\n                    res = true;\n                    return false;\n                }\n                return true;\n            });\n            return res;\n        });\n        \n        return result;\n    }\n}\n","import { Game } from \"..\";\nimport { Hero } from \"../Hero/Hero\";\nimport { Point } from \"../Point\";\n\nexport class Bullet {\n    go() {\n\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n\n    }\n}\n\nexport class DefaultBullet extends Bullet {\n    point: Point;\n    game: Game;\n    size = 2;\n    direction = 0;\n    speed = 30;\n    color = 'black';\n    ATK = 1;\n\n    isEnd = false;\n\n    hero: Hero;\n\n    constructor(point: Point, direction: number, game: Game, hero: Hero, {\n        speed, color, ATK, size\n    }: {\n        speed?: number;\n        color?: string;\n        ATK?: number;\n        size?: number;\n    }) {\n        super();\n        this.point = point;\n        this.direction = direction;\n        this.game = game;\n        this.hero = hero;\n        speed && (this.speed = speed);\n        color && (this.color = color);\n        ATK && (this.ATK = ATK);\n        size && (this.size = size);\n    }\n\n    go() {\n        for (let i = 0; i < this.speed * 5; i++) {\n            this.point.y -= Math.cos(this.direction);\n            this.point.x += Math.sin(this.direction);\n\n            let enemy = this.game.enemySet.findEnemyByPoint(this.point);\n            if (enemy) {\n                let isKilled = enemy.hited(this.ATK);\n                if (isKilled) {\n                    this.hero.addKillNumber();\n                }\n                this.game.removeBullet(this);\n                this.isEnd = true;\n                return;\n            }\n        }\n        if (this.point.y < 0\n            || this.point.y > this.game.height\n            || this.point.x < 0\n            || this.point.x > this.game.width) {\n            this.game.removeBullet(this);\n        }\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        let [x, y] = this.point.toNumber();\n\n        // if (this.isEnd) {\n        //     this.game.removeBullet(this);\n        //     let direction = this.direction + ((Math.random() - 0.5) * 0.4 + 1) * Math.PI;\n        //     ctx.beginPath();\n        //     for (let i = 0; i < 4; i++) {\n        //         let random1 = Math.random();\n        //         let random2 = Math.random();\n        //         direction = this.direction + ((Math.random() - 0.5) * 0.4 + 1) * Math.PI;\n        //         ctx.moveTo(x + Math.sin(direction) * this.speed * random1, y - Math.cos(direction) * this.speed * random1);\n        //         ctx.lineTo(x + Math.sin(direction) * this.speed * random2, y - Math.cos(direction) * this.speed * random2);\n        //         let gnt1 = ctx.createLinearGradient(x, y, x + Math.sin(direction) * this.speed, y - Math.cos(direction) * this.speed);\n        //         gnt1.addColorStop(0,this.color);\n        //         gnt1.addColorStop(1,'white');\n        //         ctx.strokeStyle = gnt1;\n        //     }\n        //     ctx.stroke();\n        //     ctx.closePath();\n        //     return;\n        // }\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(x - Math.sin(this.direction) * this.speed, y + Math.cos(this.direction) * this.speed);\n        let gnt1 = ctx.createLinearGradient(x, y, x - Math.sin(this.direction) * this.speed, y + Math.cos(this.direction) * this.speed);\n        gnt1.addColorStop(0,this.color);\n        gnt1.addColorStop(1,'white');\n        ctx.lineWidth = this.size;\n        ctx.strokeStyle = gnt1;\n        ctx.stroke();\n        ctx.closePath();\n        ctx.strokeStyle = 'black';\n        ctx.lineWidth = 1;\n    }\n}\n","import { Point } from \"../Point\";\n\nexport const drawRoundRect = (x: number, y: number, w: number, h: number, r: number, ctx: CanvasRenderingContext2D): void => {\n    if (w < 2 * r) r = w / 2;\n    if (h < 2 * r) r = h / 2;\n    ctx.beginPath();\n    ctx.moveTo(x+r, y);\n    ctx.arcTo(x+w, y, x+w, y+h, r);\n    ctx.arcTo(x+w, y+h, x, y+h, r);\n    ctx.arcTo(x, y+h, x, y, r);\n    ctx.arcTo(x, y, x+w, y, r);\n    ctx.closePath();\n    ctx.stroke();\n}\n\nexport const drawLightning = (p1: Point, p2: Point, ctx: CanvasRenderingContext2D, color?: string, lightColor?: string) => {\n    const [pn1x, pn1y] = p1.toNumber();\n    const [pn2x, pn2y] = p2.toNumber();\n\n    const dx = pn2x - pn1x;\n    const dy = pn2y - pn1y;\n    const l = p1.lengthTo(p2);\n\n    const cos = dx / l;\n    const sin = dy / l;\n\n    ctx.strokeStyle = color || \"white\";\n\n    ctx.shadowColor = lightColor || 'blue';\n    ctx.shadowBlur = 14;\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n\n\n    ctx.beginPath();\n    ctx.lineWidth = 1;\n    ctx.moveTo(...p1.toNumber());\n    for (let i = 1; i < 5; i++) {\n        let o = p1.plus(dx / 5 * i, dy / 5 * i);\n\n        let randomR = (Math.random() - 0.5) * 60;\n        o = o.plus(randomR * sin, randomR * cos);\n\n        ctx.lineTo(...o.toNumber());\n    }\n    ctx.lineTo(...p2.toNumber());\n    ctx.stroke();\n    ctx.closePath();\n\n    ctx.beginPath();\n    ctx.lineWidth = 2;\n    ctx.moveTo(...p1.toNumber());\n    for (let i = 1; i < 5; i++) {\n        let o = p1.plus(dx / 5 * i, dy / 5 * i);\n\n        let randomR = (Math.random() - 0.5) * 60;\n        o = o.plus(randomR * sin, randomR * cos);\n\n        ctx.lineTo(...o.toNumber());\n    }\n    ctx.lineTo(...p2.toNumber());\n    ctx.stroke();\n    ctx.closePath();\n\n    ctx.shadowBlur = 0;\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = \"black\";\n}","import { Game } from \"..\";\nimport { Point } from \"../Point\";\nimport { drawRoundRect } from \"../tool\";\n\nexport class Hero {\n    point: Point;\n    level: 1|2|3 = 1;\n    get size() {\n        switch (this.level) {\n            case 1:\n                return 30;\n            case 2:\n                return 30;\n            default:\n            case 3:\n                return 30;\n        }\n    }\n    color = 'blue';\n    type = 'hero';\n\n    step = 0;\n\n    killNumber = 0;\n\n    game: Game;\n\n    constructor(game: Game) {\n        this.game = game;\n        this.point = new Point(0, 0, game.coordinate);\n    }\n\n    addKillNumber() {\n        this.killNumber++;\n        if (this.killNumber >= 100) {\n            this.killNumber = 0;\n            this.startSpecialMove();\n        }\n    }\n\n    startSpecialMove() {\n\n    }\n\n    go() {\n        this.step++;\n    }\n\n    render(ctx: CanvasRenderingContext2D, position?: [number, number]) {\n        let [x, y] = position || this.point.toNumber();\n        ctx.strokeStyle = this.color;\n        drawRoundRect(x, y, this.size, this.size, 5, ctx);\n        ctx.strokeStyle = 'black';\n        ctx.fillStyle = 'white';\n        ctx.fill();\n        ctx.fillStyle = this.color;\n        ctx.textAlign = 'center';\n        ctx.fillText(`${this.level}`, x + this.size / 2, y + 18);\n        ctx.fillStyle = 'green';\n        ctx.strokeStyle = 'green';\n        drawRoundRect(x + 1, y + this.size + 3, this.killNumber / 100 * (this.size - 2), 2, 1, ctx);\n        ctx.fill();\n        ctx.strokeStyle = 'black';\n        ctx.fillStyle = 'white';\n        ctx.fillStyle = 'black';\n    }\n\n    isPointIn(x: number, y: number) {\n        let [_x, _y] = this.point.toNumber();\n        return x >= _x - 10 && x <= _x + this.size + 10\n            && y >= _y - 10 && y <= _y + this.size + 10;\n    }\n\n    addToOffStage(position: 0|1|2|3|4|5|6|7|8) {\n    }\n}","import { DefaultBullet } from \"../Bullet/Bullet\";\nimport { Point } from \"../Point\";\nimport { Hero } from \"./Hero\";\n\nexport class GrapeshotHero extends Hero {\n    type = 'grapeshot-hero';\n    get cycle() {\n        switch (this.level) {\n            case 1:\n                return 5;\n            case 2:\n                return 3;\n            default:\n            case 3:\n                return 1;\n        }\n    }\n    get bulletNumber() {\n        switch (this.level) {\n            case 1:\n                return 5;\n            case 2:\n                return 6;\n            default:\n            case 3:\n                return 7;\n        }\n    }\n    get ATK() {\n        switch (this.level) {\n            case 1:\n                return 1;\n            case 2:\n                return 2;\n            default:\n            case 3:\n                return 3;\n        }\n    }\n    get bulletSize() {\n        switch (this.level) {\n            case 1:\n                return 1;\n            case 2:\n                return 2;\n            default:\n            case 3:\n                return 3;\n        }\n    }\n    get bulletColor() {\n        switch (this.level) {\n            case 1:\n                return 'black';\n            case 2:\n                return 'blue';\n            default:\n            case 3:\n                return 'red';\n        }\n    }\n    color = 'black';\n    specialLength = 0;\n\n    nullHero = new Hero(this.game);\n\n    go() {\n        if (this.step % this.cycle === 0 && this.game.enemySet.length > 0) {\n            for (let i = 0; i < this.bulletNumber; i++) {\n                this.game.bullets.push(\n                    new DefaultBullet(\n                        this.point.plus(this.size/2, 0),\n                        Math.PI*0.4*(Math.random() - 0.5),\n                        this.game,\n                        this,\n                        {\n                            speed: 30 + Math.floor(Math.random() * 30),\n                            color: this.bulletColor,\n                            ATK: this.ATK,\n                            size: this.bulletSize,\n                        }\n                    )\n                );\n            }\n        }\n        if (this.specialLength !== 0) {\n            if (this.specialLength % 3 === 0) {\n                for (let i = 0; i < 15; i++) {\n                    this.game.bullets.push(\n                        new DefaultBullet(\n                            new Point(30 * i + 10, this.game.targetY, this.game.coordinate),\n                            0,\n                            this.game,\n                            this.nullHero,\n                            {\n                                speed: 30 + Math.floor(Math.random() * 30),\n                                color: this.bulletColor,\n                                ATK: this.ATK,\n                                size: this.bulletSize,\n                            }\n                        )\n                    );\n                }\n            }\n            this.specialLength--;\n        }\n        this.step++;\n    }\n\n    startSpecialMove() {\n        this.specialLength = 200;\n    }\n}\n\n","import { Game } from \"..\";\nimport { LightningHero } from \"../Hero/LightningHero\";\nimport { Point } from \"../Point\";\nimport { drawLightning } from \"../tool\";\nimport { Bullet } from \"./Bullet\";\n\nexport class SpecialLightningBullet extends Bullet {\n    game: Game;\n    hero: LightningHero;\n    y = 0;\n    get speed() {\n        switch (this.hero.level) {\n            case 1:\n                return 5;\n            case 2:\n                return 3;\n            case 3:\n            default:\n                return 1;\n        }\n    }\n    get ATK() {\n        switch (this.hero.level) {\n            case 1:\n                return 1;\n            case 2:\n                return 2;\n            case 3:\n            default:\n                return 3;\n        }\n    }\n\n    constructor(game: Game, hero: LightningHero) {\n        super();\n        this.game = game;\n        this.hero = hero;\n        this.y = this.game.targetY;\n    }\n    go() {\n        this.y -= this.speed;\n        this.game.enemySet.findEnemyByY(this.y).forEach(enemy => {\n            enemy.hited(this.ATK);\n        });\n\n        if (this.y <= 0) {\n            this.game.removeBullet(this);\n        }\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        drawLightning(\n            new Point(0, this.y, this.game.coordinate),\n            new Point(this.game.width, this.y, this.game.coordinate),\n            ctx,\n            this.hero._color,\n            this.hero._lightColor);\n    }\n}","import { SpecialLightningBullet } from '../Bullet/SpecialLightningBullet';\nimport { Enemy } from '../Enemy/Enemy';\nimport { drawLightning } from '../tool';\nimport { Hero } from './Hero';\n\ninterface Chain<T> {\n    value: T;\n    next: Chain<T> | null;\n}\n\nexport class LightningHero extends Hero {\n    type = 'lightning-hero';\n\n    targets: {\n        length: number;\n        chain: Chain<Enemy> | null;\n        end: Chain<Enemy> | null;\n    } = {\n        length: 0,\n        chain: null,\n        end: null\n    };\n    get cycle() {\n        switch (this.level) {\n            case 1:\n                return 3;\n            case 2:\n                return 2;\n            default:\n            case 3:\n                return 1;\n        }\n    }\n    get _color() {\n        switch (this.level) {\n            case 1:\n                return 'white';\n            case 2:\n                return 'white';\n            default:\n            case 3:\n                return 'black';\n        }\n    }\n    get _lightColor() {\n        switch (this.level) {\n            case 1:\n                return 'blue';\n            case 2:\n                return 'red';\n            default:\n            case 3:\n                return 'red';\n        }\n    }\n    get targetMaxLength() {\n        switch (this.level) {\n            case 1:\n                return 2;\n            case 2:\n                return 3;\n            default:\n            case 3:\n                return 5;\n        }\n    }\n    get ATK() {\n        switch (this.level) {\n            case 1:\n                return 1;\n            case 2:\n                return 2;\n            default:\n            case 3:\n                return 3;\n        }\n    }\n\n    go() {\n        if (this.targets.length < this.targetMaxLength && this.game.enemySet.length > 0) {\n            let smallNum = this.game.enemySet.length >= this.targetMaxLength ? this.targetMaxLength : this.game.enemySet.length;\n            let i = smallNum - this.targets.length;\n            while (i > 0) {\n                let chain = this.targets.chain;\n\n                if (!chain) {\n                    this.addTarget({\n                        value: this.game.enemySet.getRandomEnemy(),\n                        next: null\n                    });\n                    i--;\n                    continue;\n                }\n\n                const isTrue = this.addTarget({\n                    value: this.game.enemySet.getRandomEnemy(),\n                    next: null\n                });\n                if (isTrue) {\n                    i--;\n                }\n            }\n            this.targets.length = smallNum;\n        }\n\n        if (this.step % this.cycle === 0) {\n            let chain = this.targets.chain;\n            while (chain) {\n                if (chain.value.value > 0) {\n                    let isKilled = chain.value.hited(this.ATK);\n                    if (isKilled) {\n                        this.addKillNumber();\n                    }\n                }\n                chain = chain.next;\n            }\n            chain = this.targets.chain;\n            if (!chain) return;\n            if (chain.value.value <= 0) {\n                this.targets.length = 0;\n                this.targets.chain = null;\n                this.targets.end = null;\n            } else {\n                let parent = chain;\n                chain = chain.next;\n                let length = 1;\n\n                while (chain) {\n                    if (chain.value.value <= 0) {\n                        parent.next = null;\n                        this.targets.length = length;\n                        this.targets.end = parent;\n                        break;\n                    } else {\n                        parent = chain;\n                        chain = chain.next;\n                        length++;\n                    }\n                }\n            }\n        }\n\n        this.step++;\n    }\n\n    render(ctx: CanvasRenderingContext2D, position?: [number, number]) {\n        super.render(ctx, position);\n\n        if (!this.targets.chain) return;\n        let chain: Chain<Enemy> | null = this.targets.chain;\n        let p1 = this.point.plus(this.size / 2, 0);\n\n        while (chain) {\n            let p2 = chain.value.point.plus(chain.value.size / 2, chain.value.size / 2);\n            drawLightning(p1, p2, ctx, this._color, this._lightColor);\n\n            p1 = chain.value.point.plus(chain.value.size / 2, chain.value.size / 2);\n            chain = chain.next;\n        }\n    }\n\n    startSpecialMove() {\n        this.game.bullets.push(new SpecialLightningBullet(this.game, this));\n    }\n\n    addTarget(chain: Chain<Enemy>): boolean {\n        if (this.targets.end === null) {\n            this.targets.chain = chain;\n            this.targets.end = chain;\n            this.targets.length++;\n        } else {\n            let _chain = this.targets.chain;\n\n            while (_chain) {\n\n                if (chain.value === _chain.value) {\n                    return false;\n                }\n                _chain = _chain.next;\n            }\n            this.targets.end.next = chain;\n            this.targets.end = this.targets.end.next;\n            this.targets.length++;\n        }\n\n        return true;\n    }\n\n    addToOffStage(position: 0|1|2|3|4|5|6|7|8) {\n        super.addToOffStage(position);\n        this.targets = {\n            length: 0,\n            chain: null,\n            end: null\n        }\n    }\n}","import { Game } from \"..\";\nimport { Hero } from \"../Hero/Hero\";\nimport { Point } from \"../Point\";\nimport { Bullet } from \"./Bullet\";\n\nexport class SniperBullet extends Bullet {\n    point: Point;\n    startPoint: Point;\n    targetPoint: Point;\n    game: Game;\n    hero: Hero;\n    damage = 0;\n\n    sin = 0;\n    cos = 0;\n\n    speed = 30;\n    color = 'black';\n    size = 3;\n\n    constructor(game: Game, hero: Hero, p1: Point, p2: Point, {\n        speed, color, damage\n    }: {\n        speed?: number;\n        color?: string;\n        damage: number;\n    }) {\n        super();\n\n        this.game = game;\n        this.hero = hero;\n        this.startPoint = p1;\n        this.point = p1.plus(0, 0);\n        this.targetPoint = p2;\n        speed && (this.speed = speed);\n        color && (this.color = color);\n        this.damage = damage;\n        let dy = this.targetPoint.y - this.startPoint.y;\n        let dx = this.targetPoint.x - this.startPoint.x;\n        let len = (dy**2 + dx**2)**0.5;\n        this.sin = dx / len;\n        this.cos = -dy / len;\n    }\n\n    go() {\n        for (let i = 0; i < this.speed * 5; i++) {\n            this.point.y += -this.cos;\n            this.point.x += this.sin;\n\n            // this.game.enemySet.some(enemy => {\n            //     if (!enemy) return false;\n            //     if (this.point.x >= enemy.point.x - 2\n            //         && this.point.y >= enemy.point.y - 2\n            //         && this.point.x <= enemy.point.x + enemy.size + 2\n            //         && this.point.y <= enemy.point.y + enemy.size + 2) {\n            //             let isKilled = enemy.hited(this.damage);\n            //             if (isKilled) {\n            //                 this.hero.addKillNumber();\n            //             }\n            //             return true;\n            //     }\n            //     return false;\n            // });\n            let enemy = this.game.enemySet.findEnemyByPoint(this.point);\n            if (enemy) {\n                let isKilled = enemy.hited(this.damage);\n                if (isKilled) {\n                    this.hero.addKillNumber();\n                }\n            }\n        }\n        if (this.point.y < 0\n            || this.point.y > this.game.height\n            || this.point.x < 0\n            || this.point.x > this.game.width) {\n            this.game.removeBullet(this);\n        }\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        let [x, y] = this.point.toNumber();\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(x - this.sin * 150, y + this.cos * 150);\n        let gnt1 = ctx.createLinearGradient(x, y, x - this.sin * 150, y + this.cos * 150);\n        gnt1.addColorStop(0,this.color);\n        gnt1.addColorStop(1,'white');\n        ctx.strokeStyle = gnt1;\n        ctx.lineWidth = this.size;\n        ctx.stroke();\n        ctx.closePath();\n        ctx.strokeStyle = 'black';\n        ctx.lineWidth = 1;\n    }\n}","import { SniperBullet } from \"../Bullet/SniperBullet\";\nimport { Enemy } from \"../Enemy/Enemy\";\nimport { Hero } from \"./Hero\";\n\nexport class SniperHero extends Hero {\n    type = 'sniper-hero';\n    target: Enemy|null = null;\n    damage = 0;\n    color = 'green';\n    nullHero = new Hero(this.game);\n\n    specialTargets: Enemy[] = [];\n    specialDamage = -1;\n    specialDamageMax = 30;\n\n    get cycle() {\n        switch (this.level) {\n            case 1:\n                return 5;\n            case 2:\n                return 3;\n            default:\n            case 3:\n                return 2;\n        }\n    }\n\n    go() {\n        if (!this.target) {\n            let maxEnemy: Enemy | null = this.game.enemySet.get(0);\n            this.game.enemySet.forEach(enemy => {\n                if (!maxEnemy || (!enemy.isPicked && enemy.value > maxEnemy.value)) {\n                    maxEnemy = enemy;\n                }\n            });\n\n            if (!maxEnemy) {\n                return super.go();\n            }\n\n            this.target = maxEnemy;\n            this.target.isPicked = true;\n        }\n        if (this.step % this.cycle !== 0) return super.go();\n\n        if (this.damage < this.target.value) {\n            this.damage += 1;\n        } else {\n            this.game.bullets.push(new SniperBullet(\n                this.game,\n                this,\n                this.point.plus(this.size / 2, 0),\n                this.target.point.plus(this.target.size / 2, this.target.size / 2),\n                {\n                    damage: this.damage,\n                }\n            ));\n            this.damage = 0;\n            this.target.isPicked = false;\n            this.target = null;\n        }\n\n        if (this.specialDamage > 0) {\n            this.specialDamage++;\n            this.specialTargets = this.specialTargets.filter(target => {\n                return target.value > 0;\n            });\n\n            if (this.specialDamage >= this.specialDamageMax) {\n                this.specialTargets.forEach(target => {\n                    this.game.bullets.push(new SniperBullet(\n                        this.game,\n                        this.nullHero,\n                        this.point.plus(this.size / 2, 0),\n                        target.point.plus(target.size / 2, target.size / 2),\n                        {\n                            damage: this.specialDamage,\n                        }\n                    ));\n                });\n                this.specialDamage = -1;\n                this.specialTargets = [];\n            }\n        }\n\n        super.go();\n    }\n\n    startSpecialMove() {\n        let set = new Set<Enemy>();\n        let length = this.game.enemySet.length;\n        while (set.size < (length < 12 ? length : 12)) {\n            set.add(this.game.enemySet.getRandomEnemy());\n        }\n\n        set.forEach(enemy => {\n            this.specialTargets.push(enemy);\n        });\n\n        this.specialDamage = 1;\n    }\n\n    render(ctx: CanvasRenderingContext2D, position?: [number, number]) {\n        super.render(ctx, position);\n        if (this.target) {\n            this.renderTarget(ctx, this.target, 5 + (this.target.value - this.damage > 0 ? this.target.value - this.damage : 0));\n        }\n        this.specialTargets.forEach(target => {\n            this.renderTarget(ctx, target, 5 + this.specialDamageMax - this.specialDamage);\n        });\n    }\n\n    renderTarget(ctx: CanvasRenderingContext2D, target: Enemy, radius: number) {\n        if (target.value <= 0) return;\n        ctx.strokeStyle = 'red';\n        ctx.lineWidth = 3;\n        ctx.beginPath();\n        ctx.arc(\n            ...target.point.plus(target.size / 2, target.size / 2).toNumber(),\n            radius, 0, 2*Math.PI);\n        ctx.moveTo(...target.point.plus(target.size / 2, target.size / 2 + radius + 5).toNumber());\n        ctx.lineTo(...target.point.plus(target.size / 2, target.size / 2 + radius - 5).toNumber());\n        ctx.moveTo(...target.point.plus(target.size / 2, target.size / 2 - radius + 5).toNumber());\n        ctx.lineTo(...target.point.plus(target.size / 2, target.size / 2 - radius - 5).toNumber());\n        ctx.moveTo(...target.point.plus(target.size / 2 + radius + 5, target.size / 2).toNumber());\n        ctx.lineTo(...target.point.plus(target.size / 2 + radius - 5, target.size / 2).toNumber());\n        ctx.moveTo(...target.point.plus(target.size / 2 - radius + 5, target.size / 2).toNumber());\n        ctx.lineTo(...target.point.plus(target.size / 2 - radius - 5, target.size / 2).toNumber());\n        ctx.stroke();\n        ctx.closePath();\n        ctx.strokeStyle = 'black';\n        ctx.lineWidth = 1;\n    }\n}","import { Game } from \"..\";\nimport { Point } from \"../Point\";\nimport { drawRoundRect } from \"../tool\";\n\nexport class Enemy {\n    value = 0;\n    size = 20;\n    point: Point;\n    game: Game;\n\n    isPicked = false;\n\n    constructor(value: number, x: number, game: Game) {\n        this.value = value;\n        this.game = game;\n        this.point = new Point(x, -this.size, game.coordinate);\n    }\n\n    go() {\n        this.point.y += 0.5;\n    }\n\n    hited(n?: number): boolean {\n        if (n) {\n            this.game.score += this.value < n ? this.value : n;\n            this.value -= n;\n        } else {\n            this.value--;\n            this.game.score++;\n        }\n\n        if (this.value <= 0) {\n            this.game.removeEnemy(this);\n            return true;\n        }\n        return false;\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        let [x, y] = this.point.toNumber();\n        drawRoundRect(x, y, this.size, this.size, 5, ctx);\n        ctx.textAlign = 'center';\n        ctx.fillText(`${this.value}`, x + this.size / 2, y + 13);\n    }\n}\n","import { Game } from \"..\";\nimport { Enemy } from \"../Enemy/Enemy\";\nimport { Round } from \"./Round\";\n\nexport class Round1 implements Round {\n    game: Game;\n    waveNumber = 30;\n\n    symbolLife = 100;\n\n    isEnd = false;\n\n    constructor(game: Game) {\n        this.game = game;\n    }\n\n    createEnemy() {\n        let row: Enemy[] = [];\n        for (let i = 0; i < 15; i++) {\n            row.push(new Enemy(Math.ceil(this.game.step/120*Math.random() + 1), 30 * i + 10, this.game));\n        }\n        this.game.enemySet.push(...row);\n    }\n\n    go() {\n        if (this.waveNumber === 0) {\n            this.isEnd = true;\n            return;\n        }\n        if (this.game.step % this.game.cycle === 0) {\n            this.createEnemy();\n            this.waveNumber--;\n        }\n    }\n\n    award() {\n\n    }\n\n    renderSymbol(ctx: CanvasRenderingContext2D) {\n        ctx.beginPath();\n        ctx.font = 'italic bolder 60px Arial';\n        ctx.fillStyle = 'grey';\n        ctx.textAlign = 'center';\n        ctx.fillText(`ROUND ${this.game.stageNumber + 1}`, this.game.width / 2, this.game.height - 350);\n        ctx.font = '12px Arial';\n        ctx.fillStyle = 'black';\n        ctx.closePath();\n    }\n}\n","import { Bullet } from \"./Bullet/Bullet\";\nimport { Coordinate } from \"./Coordinate\";\nimport { Enemy } from \"./Enemy/Enemy\";\nimport { EnemySet } from \"./Enemy/EnemySet\";\nimport { GrapeshotHero } from \"./Hero/GrapeshotHero\";\nimport { Hero } from \"./Hero/Hero\";\nimport { LightningHero } from \"./Hero/LightningHero\";\nimport { SniperHero } from \"./Hero/SniperHero\";\nimport { Point } from \"./Point\";\nimport { Round1 } from \"./Round/Round1\";\nimport { drawRoundRect } from \"./tool\";\n\nconst isMobile = /Android|webOS|iPhone|iPod|BlackBerry/i.test(window.navigator.userAgent);\nconst createStages = (game: Game) => {\n    return [\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game),\n        new Round1(game)\n    ];\n}\n\nexport class Game {\n    coordinate = new Coordinate(0, 0);\n\n    // enemys: Enemy[] = [];\n    enemySet = new EnemySet();\n\n    offStageHeros: [\n        Hero|null, Hero|null, Hero|null,\n        Hero|null, Hero|null, Hero|null,\n        Hero|null, Hero|null, Hero|null\n    ] = [null, null, null, null, null, null, null, null, null];\n    onStageHeros: [\n        Hero|null, Hero|null, Hero|null,\n        Hero|null, Hero|null, Hero|null,\n        Hero|null, Hero|null, Hero|null\n    ] = [null, null, null, null, null, null, null, null, null];\n\n    bullets: Bullet[] = [];\n\n    width = 460;\n    height = window.innerHeight * 460 / window.innerWidth;\n    sizeRate = 460 / window.innerWidth;\n\n    targetY = this.height - 150;\n    targetLineLeft = this.coordinate.point(0, this.targetY);\n    targetLineRight = this.coordinate.point(this.width, this.targetY);\n\n    offStageHeroY = this.height - 70;\n    onStageHeroY = this.height - 120;\n    // \n    heroPosList = [\n        new Point(55, this.offStageHeroY, this.coordinate),\n        new Point(95, this.offStageHeroY, this.coordinate),\n        new Point(135, this.offStageHeroY, this.coordinate),\n        new Point(175, this.offStageHeroY, this.coordinate),\n        new Point(215, this.offStageHeroY, this.coordinate),\n        new Point(255, this.offStageHeroY, this.coordinate),\n        new Point(295, this.offStageHeroY, this.coordinate),\n        new Point(335, this.offStageHeroY, this.coordinate),\n        new Point(375, this.offStageHeroY, this.coordinate),\n\n        new Point(55, this.onStageHeroY, this.coordinate),\n        new Point(95, this.onStageHeroY, this.coordinate),\n        new Point(135, this.onStageHeroY, this.coordinate),\n        new Point(175, this.onStageHeroY, this.coordinate),\n        new Point(215, this.onStageHeroY, this.coordinate),\n        new Point(255, this.onStageHeroY, this.coordinate),\n        new Point(295, this.onStageHeroY, this.coordinate),\n        new Point(335, this.onStageHeroY, this.coordinate),\n        new Point(375, this.onStageHeroY, this.coordinate)\n    ];\n\n    cycle = 60;\n    step = 0;\n    setEnd: React.Dispatch<React.SetStateAction<boolean>> | null = null;\n    setRound: React.Dispatch<React.SetStateAction<'strategy' | 'fighting'>> | null = null;\n\n    $ = 300;\n    score = 0;\n\n    HP = 1000;\n    renderHP = 1000;\n    result: 'win' | 'loose' = 'win';\n    private _round: 'strategy' | 'fighting' = 'strategy';\n    get round() {\n        return this._round;\n    }\n    set round(newRound: 'strategy' | 'fighting') {\n        this._round = newRound;\n        if (this.setRound) this.setRound(newRound);\n        if (newRound === 'fighting') {\n            this.goFighting();\n        }\n    }\n    stageNumber = 0;\n    stage = createStages(this);\n\n    isRenderStrategy = false;\n\n    isMouseDown = false;\n    mouseSelectItem: Hero | null = null;\n    mouseSelectItemType: 'off' | 'on' = 'off';\n    mouseSelectItemIndex: 0|1|2|3|4|5|6|7|8 = 0;\n    mouseSelectItemPosition: [number, number] = [0, 0];\n    mouseSelectItemOffset: [number, number] = [0, 0];\n\n    canvas: HTMLCanvasElement | null = null;\n\n    constructor() {\n        this.handleMouseMove = this.handleMouseMove.bind(this);\n        this.handleTouchMove = this.handleTouchMove.bind(this);\n    }\n\n    restart() {\n        // this.enemys = [];\n        this.enemySet.reset();\n        this.offStageHeros = [null, null, null, null, null, null, null, null, null];\n        this.onStageHeros = [null, null, null, null, null, null, null, null, null];\n        this.bullets = [];\n        this.step = 0;\n        this.$ = 300;\n        this.score = 0;\n        this.HP = 1000;\n\n        this.stageNumber = 0;\n        this.round = 'strategy';\n        this.stage = createStages(this);\n        this.render();\n    }\n\n    removeBullet(bullet: Bullet) {\n        this.bullets = this.bullets.filter(_bullet => {\n            return _bullet !== bullet;\n        });\n    }\n\n    removeEnemy(enemy: Enemy) {\n        this.enemySet.removeEnemy(enemy);\n        this.$++;\n    }\n\n    buyHero(type: 'lightning' | 'grapeshot' | 'sniper'): boolean {\n        switch (type) {\n            case 'lightning':\n                if (this.$ < 200) return false;\n                this.$ -= 200;\n                this.addOffStageHero(new LightningHero(this));\n                break;\n            case 'sniper':\n                if (this.$ < 150) return false;\n                this.$ -= 150;\n                this.addOffStageHero(new SniperHero(this));\n                break;\n            case 'grapeshot':\n            default:\n                if (this.$ < 300) return false;\n                this.$ -= 300;\n                this.addOffStageHero(new GrapeshotHero(this));\n                break;\n        }\n        this.render();\n        return true;\n    }\n\n    go(): boolean {\n        this.stage[this.stageNumber].go();\n\n        this.enemySet.forEach(enemy => {\n            enemy.go();\n            if (enemy.point.y >= this.targetY - enemy.size) {\n                this.removeEnemy(enemy);\n                this.HP -= enemy.value > this.HP ? this.HP : enemy.value;\n            }\n        });\n\n        this.onStageHeros.forEach(hero => {\n            hero?.go();\n        });\n\n        this.bullets.forEach(bullet => {\n            bullet.go();\n        });\n\n        if (this.renderHP > this.HP) {\n            this.renderHP--;\n        } else if (this.renderHP < this.HP) {\n            this.renderHP++\n        }\n\n        this.step++;\n        return this.HP <= 0;\n    }\n\n    goFighting() {\n        let isEnd = this.go();\n\n        this.render();\n        if (isEnd) {\n            this.setResult('loose');\n            this.render();\n            return;\n        }\n\n        if (this.stage[this.stageNumber].isEnd\n            && this.bullets.length === 0\n            && this.enemySet.length === 0\n            && this.renderHP === this.HP) {\n            this.round = 'strategy';\n            this.stageNumber++;\n\n            if (this.stageNumber === this.stage.length) {\n                this.setResult('win');\n                this.render();\n                return;\n            }\n\n            this.stage[this.stageNumber].award();\n            this.render();\n            return;\n        }\n        requestAnimationFrame(() => {\n            this.goFighting();\n        });\n    }\n\n    goStrategy() {\n        if (this.isRenderStrategy) return;\n        this.loopRender();\n    }\n\n    loopRender() {\n        this.render();\n\n        if (!this.isRenderStrategy) {\n            return;\n        }\n        requestAnimationFrame(() => {\n            this.loopRender();\n        });\n    }\n\n    render() {\n        if (!this.canvas) return;\n        const ctx = this.canvas.getContext('2d');\n\n        if (!ctx) return;\n\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        ctx.strokeRect(...this.coordinate.origin, this.width, this.height);\n\n        this.stage[this.stageNumber]?.renderSymbol(ctx);\n\n        ctx.beginPath();\n        ctx.strokeStyle = 'grey';\n        this.heroPosList.forEach(pos => {\n            drawRoundRect(...pos.plus(8, 8).toNumber(), 14, 14, 5, ctx);\n        });\n        ctx.strokeStyle = 'black';\n        ctx.closePath();\n\n        this.enemySet.forEach(enemy => {\n            enemy.render(ctx);\n        });\n\n        // HP\n        ctx.beginPath();\n        ctx.fillStyle = 'white';        \n        ctx.fillRect(1, this.targetY - 30, this.width - 2, 32);\n        ctx.fillStyle = 'lightgrey';\n        ctx.fillRect(1, this.targetY - 25, this.width - 2, 10);\n        ctx.fillStyle = 'lightgreen';\n        ctx.strokeStyle = 'green';\n        const renderHpWidth = this.renderHP / 1000 * (this.width - 2);\n        ctx.fillRect(this.width - renderHpWidth - 1, this.targetY - 25, renderHpWidth, 10);\n        ctx.fillStyle = '#00CC33';\n        const hpWidth = this.HP / 1000 * (this.width - 2);\n        ctx.fillRect(this.width - hpWidth - 1, this.targetY - 25, hpWidth, 10);\n        ctx.closePath();\n        ctx.fillStyle = 'black';\n        ctx.strokeStyle = 'black';\n\n        ctx.beginPath();\n        this.offStageHeros.forEach(hero => {\n            hero?.render(ctx);\n        });\n\n        this.onStageHeros.forEach(hero => {\n            hero?.render(ctx);\n        });\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.moveTo(...this.targetLineLeft.plus(0, -30).toNumber());\n        ctx.lineTo(...this.targetLineRight.plus(0, -30).toNumber());\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        this.bullets.forEach(bullet => {\n            bullet.render(ctx);\n        });\n        ctx.closePath();\n\n        if (this.mouseSelectItem) {\n            this.mouseSelectItem.render(ctx, [\n                this.mouseSelectItemPosition[0] + this.mouseSelectItemOffset[0],\n                this.mouseSelectItemPosition[1] + this.mouseSelectItemOffset[1],\n            ]);\n            if (isMobile) {\n                ctx.putImageData(ctx.getImageData(\n                    0, this.targetY, this.width, 150\n                ), 0, this.targetY - 150);\n\n                ctx.rect(0, this.targetY - 150, this.width, 150);\n                ctx.stroke();\n            }\n        }\n\n        ctx.beginPath();\n        ctx.font = 'bold 20px Arial';\n        ctx.fillStyle = 'red';\n        ctx.textAlign = 'right';\n        ctx.fillText(`$:${this.$}`, 440, 29);\n        ctx.font = '12px Arial';\n        ctx.fillStyle = 'black';\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.font = 'bold 18px Arial';\n        ctx.fillStyle = 'red';\n        ctx.textAlign = 'left';\n        ctx.fillText(`SCORE:${this.score}`, 20, 29);\n        ctx.font = '12px Arial';\n        ctx.fillStyle = 'black';\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.font = '14px Arial';\n        ctx.fillStyle = 'black';\n        ctx.textAlign = 'center';\n        ctx.fillText(`round ${this.stageNumber + 1} / ${this.stage.length}`, this.width / 2, 28);\n        ctx.font = '12px Arial';\n        ctx.fillStyle = 'black';\n        ctx.closePath();\n    }\n\n    setResult(isWin: 'win' | 'loose') {\n        this.result = isWin;\n        this.setEnd && this.setEnd(true);\n    }\n\n    addOffStageHero(hero: Hero | null, position?: 0|1|2|3|4|5|6|7|8) {\n        if (position === undefined) {\n            this.offStageHeros.some((hero, index) => {\n                if (hero === null) {\n                    position = index as 0|1|2|3|4|5|6|7|8;\n                    return true;\n                }\n                return false;\n            });\n        }\n        if (position === undefined) return;\n        this.offStageHeros[position] = hero;\n        if (hero) {\n            hero.point.y = this.offStageHeroY;\n            hero.point.x = 55 + position * 40;\n            hero.addToOffStage(position);\n\n            if (hero.level >= 3) return;\n\n            let list: (0|1|2|3|4|5|6|7|8)[] = [];\n            this.offStageHeros.forEach((_hero, i) => {\n                if (_hero?.type === hero.type && hero.level === _hero.level) {\n                    list.push(i as 0);\n                }\n            });\n\n            if (list.length >= 3) {\n                this.addOffStageHero(null, list[0]);\n                this.addOffStageHero(null, list[1]);\n                (this.offStageHeros[list[2]] as Hero).level += 1;\n                this.addOffStageHero(this.offStageHeros[list[2]], list[2]);\n            }\n        }\n    }\n\n    addOnStageHero(hero: Hero | null, position?: 0|1|2|3|4|5|6|7|8) {\n        if (position === undefined) {\n            this.onStageHeros.some((hero, index) => {\n                if (hero === null) {\n                    position = index as 0|1|2|3|4|5|6|7|8;\n                    return true;\n                }\n                return false;\n            });\n        }\n        if (position === undefined) return;\n        this.onStageHeros[position] = hero;\n        if (hero) {\n            hero.point.y = this.onStageHeroY;\n            hero.point.x = 55 + position * 40;\n\n            if (hero.level >= 3) return;\n\n            let list: (0|1|2|3|4|5|6|7|8)[] = [];\n            this.onStageHeros.forEach((_hero, i) => {\n                if (_hero?.type === hero.type && hero.level === _hero.level) {\n                    list.push(i as 0);\n                }\n            });\n\n            if (list.length >= 3) {\n                this.addOnStageHero(null, list[0]);\n                this.addOnStageHero(null, list[1]);\n                (this.onStageHeros[list[2]] as Hero).level += 1;\n                this.addOnStageHero(this.onStageHeros[list[2]], list[2]);\n            }\n        }\n    }\n\n    handleCanvasMouseDown(e: React.MouseEvent<HTMLCanvasElement>) {\n        if (this.round === 'fighting') return;\n        this.isMouseDown = true;\n\n        let isFindOffStage = this.findHero(this.offStageHeros, e.clientX, e.clientY, 'off');\n        if (isFindOffStage) {\n            window.addEventListener('mousemove', this.handleMouseMove);\n            this.isRenderStrategy = true;\n            this.loopRender();\n            return;\n        }\n        let isFindOnStage = this.findHero(this.onStageHeros, e.clientX, e.clientY, 'on');\n        if (isFindOnStage) {\n            window.addEventListener('mousemove', this.handleMouseMove);\n            this.isRenderStrategy = true;\n            this.loopRender();\n            return;\n        }\n    }\n\n    handleTouchStart(e: React.TouchEvent<HTMLCanvasElement>) {\n        if (this.round === 'fighting') return;\n        e.stopPropagation();\n        e.preventDefault();\n        this.isMouseDown = true;\n\n        let isFindOffStage = this.findHero(this.offStageHeros, e.touches[0].clientX, e.touches[0].clientY, 'off');\n        if (isFindOffStage) {\n            window.addEventListener('touchmove', this.handleTouchMove, { passive: false });\n            this.isRenderStrategy = true;\n            this.loopRender();\n            return;\n        }\n        let isFindOnStage = this.findHero(this.onStageHeros, e.touches[0].clientX, e.touches[0].clientY, 'on');\n        if (isFindOnStage) {\n            window.addEventListener('touchmove', this.handleTouchMove, { passive: false });\n            this.isRenderStrategy = true;\n            this.loopRender();\n            return;\n        }\n    }\n\n    findHero(heros: (Hero|null)[], clientX: number, clientY: number, type: 'off'|'on'): boolean {\n        let heroIndex = heros.findIndex(hero => {\n            if (!hero) return false;\n\n            let isTrue = hero.isPointIn(clientX * this.sizeRate, clientY * this.sizeRate);\n            if (isTrue) {\n                let o = hero.point.toNumber();\n                this.mouseSelectItemOffset = [\n                    o[0] - clientX * this.sizeRate,\n                    o[1] - clientY * this.sizeRate\n                ];\n            }\n            return isTrue;\n        });\n\n        if (heroIndex !== -1) {\n            this.mouseSelectItem = heros[heroIndex];\n            this.mouseSelectItemType = type;\n            this.mouseSelectItemIndex = heroIndex as 0;\n            this.mouseSelectItemPosition = [clientX * this.sizeRate, clientY * this.sizeRate];\n            return true;\n        }\n        return false;\n    }\n\n    handleMouseUp(e: MouseEvent) {\n        window.removeEventListener('mousemove', this.handleMouseMove);\n        this.handleEventEnd(e.clientX, e.clientY);\n    }\n\n    handleTouchEnd(e: TouchEvent) {\n        window.removeEventListener('touchmove', this.handleTouchMove);\n        this.handleEventEnd(e.changedTouches[0].clientX, e.changedTouches[0].clientY);\n    }\n\n    handleEventEnd(clientX: number, clientY: number) {\n        let leftUp = [clientX * this.sizeRate + this.mouseSelectItemOffset[0], clientY * this.sizeRate + this.mouseSelectItemOffset[1]];\n        let rightDown = [leftUp[0] + 30, leftUp[1] + 30];\n\n        let pos = this.heroPosList.findIndex(pos => {\n            let p = pos.toNumber();\n\n            return leftUp[0] > p[0] - 18 && leftUp[1] > p[1] - 18\n                && rightDown[0] < p[0] + 48 && rightDown[1] < p[1] + 48;\n        });\n\n        if (pos !== -1 && this.mouseSelectItem) {\n            if (Math.floor(pos / 9) === 0) { // offStage\n                let targetI = pos % 9;\n                let temp = this.offStageHeros[targetI];\n                this.offStageHeros[targetI] = null;\n                if (this.mouseSelectItemType === 'on') {\n                    this.onStageHeros[this.mouseSelectItemIndex] = null;\n                } else {\n                    this.offStageHeros[this.mouseSelectItemIndex] = null;\n                }\n                this.addOffStageHero(this.mouseSelectItem, targetI as 0);\n                if (this.mouseSelectItemType === 'on') {\n                    this.addOnStageHero(temp, this.mouseSelectItemIndex);\n                } else {\n                    this.addOffStageHero(temp, this.mouseSelectItemIndex);\n                }\n            } else { // onStage\n                let targetI = pos % 9;\n                let temp = this.onStageHeros[targetI];\n                this.onStageHeros[targetI] = null;\n                if (this.mouseSelectItemType === 'on') {\n                    this.onStageHeros[this.mouseSelectItemIndex] = null;\n                } else {\n                    this.offStageHeros[this.mouseSelectItemIndex] = null;\n                }\n                this.addOnStageHero(this.mouseSelectItem, targetI as 0);\n                if (this.mouseSelectItemType === 'on') {\n                    this.addOnStageHero(temp, this.mouseSelectItemIndex);\n                } else {\n                    this.addOffStageHero(temp, this.mouseSelectItemIndex);\n                }\n            }\n        }\n\n        this.isMouseDown = false;\n        this.mouseSelectItem = null;\n        this.isRenderStrategy = false;\n    }\n\n    handleMouseMove(e: MouseEvent) {\n        this.handleMove(e.clientX, e.clientY);\n    }\n\n    handleTouchMove(e: TouchEvent) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.handleMove(e.changedTouches[0].clientX, e.changedTouches[0].clientY);\n    }\n\n    handleMove(clientX: number, clientY: number) {\n        this.mouseSelectItemPosition = [clientX * this.sizeRate, clientY * this.sizeRate];\n    }\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { Game } from './core';\nimport s from './App.module.css';\n\nconst game = new Game();\n\nconst grapeshot = {\n    type: 'grapeshot-hero',\n    name: '',\n    price: 300\n}\n\nconst lightning = {\n    type: 'lightning-hero',\n    name: '',\n    price: 200\n}\n\nconst sniper = {\n    type: 'sniper-hero',\n    name: '',\n    price: 150\n}\n\nconst createProduct = () => {\n    let r = Math.random();\n\n    if (r < 0.33) {\n        return grapeshot;\n    } else if (r < 0.66) {\n        return lightning;\n    } else {\n        return sniper;\n    }\n}\n\nconst createProductList = () => {\n    return [\n        createProduct(),\n        createProduct(),\n        createProduct(),\n        createProduct(),\n        createProduct()\n    ];\n}\n\nconst App = () => {\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n    const [end, setEnd] = useState(false);\n    const [isShopOpen, setIsShopOpen] = useState(false);\n    const [productList, setProductList] = useState(createProductList());\n    const [showShopError, setShowShopError] = useState(false);\n    const [round, setRound] = useState<'strategy' | 'fighting'>('strategy');\n\n    useEffect(() => {\n        if (!canvasRef.current) return;\n        canvasRef.current.width = game.width;\n        canvasRef.current.height = game.height;\n    }, [canvasRef]);\n\n    useEffect(() => {\n        game.setEnd = setEnd;\n    }, [end]);\n\n    useEffect(() => {\n        game.setRound = setRound;\n    }, [round]);\n\n    useEffect(() => {\n        game.canvas = canvasRef.current;\n        game.render();\n    }, [canvasRef]);\n\n    useEffect(() => {\n        const handler = game.handleMouseUp.bind(game);\n        const touchEndHandler = game.handleTouchEnd.bind(game);\n        window.addEventListener('mouseup', handler);\n        window.addEventListener('touchend', touchEndHandler)\n        return () => {\n            window.removeEventListener('mouseup', handler);\n            window.removeEventListener('touchend', touchEndHandler);\n        }\n    }, []);\n\n    function restart() {\n        game.restart();\n        setEnd(false);\n        game.canvas = canvasRef.current;\n        // game.goFighting();\n    }\n\n    return <>\n        <canvas ref={canvasRef} className={s.canvas}\n            onClick={() => {\n                setIsShopOpen(false);\n                setShowShopError(false);\n            }}\n            onTouchStart={game.handleTouchStart.bind(game)}\n            onMouseDown={game.handleCanvasMouseDown.bind(game)} />\n        <div className={s.info}>\n            <div>\n                <button className={s.shopBtn} onClick={() => {\n                    setIsShopOpen(!isShopOpen);\n                    setShowShopError(false);\n                }}></button>\n                {isShopOpen && <div className={s.shopBox}>\n                    <ul className={s.shopList}>\n                        {productList.map((p, i) => <li className={s.shopItem} key={i} onClick={() => {\n                            let buySuccess = false;\n                            switch (p.type) {\n                                case 'grapeshot-hero':\n                                    buySuccess = game.buyHero('grapeshot');\n                                    break;\n                                case 'sniper-hero':\n                                    buySuccess = game.buyHero('sniper');\n                                    break;\n                                case 'lightning-hero':\n                                default:\n                                    buySuccess = game.buyHero('lightning');\n                                    break;\n                            }\n                            if (!buySuccess) {\n                                setShowShopError(true);\n                                return;\n                            }\n                            setIsShopOpen(false);\n                            setProductList(createProductList());\n                            setShowShopError(false);\n                        }}>\n                            {p.name}\n                            <div className={s.shopItemPrice}>\n                                ${p.price}\n                            </div>\n                        </li>)}\n                    </ul>\n                    {showShopError && <div className={s.shopError}>\n                        \n                    </div>}\n                </div>}\n            </div>\n            <div className={[s.gameEndBox, end ? s.end : ''].join(' ')}>\n                {game.result === 'win' ? '' : 'game over'}\n                <button onClick={restart} className={s.restartBtn}>restart</button>\n            </div>\n            <div>\n                {round === 'strategy' && <button className={s.startFighting} onClick={() => {\n                    game.round = 'fighting';\n                }}></button>}\n            </div>\n        </div>\n    </>\n}\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas\":\"App_canvas__1KgDx\",\"info\":\"App_info__3tKmE\",\"gameEndBox\":\"App_gameEndBox__e2Cnq\",\"end\":\"App_end__3t3U7\",\"restartBtn\":\"App_restartBtn__2M1an\",\"shopBtn\":\"App_shopBtn__1GjVz\",\"shopBox\":\"App_shopBox__ApMbX\",\"shopList\":\"App_shopList__2OMys\",\"shopItem\":\"App_shopItem__2UEyj\",\"shopItemPrice\":\"App_shopItemPrice__19Ocx\",\"shopError\":\"App_shopError__12I5k\",\"startFighting\":\"App_startFighting__ner9a\"};"],"sourceRoot":""}